2025-05-13 09:09:11,832 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 09:09:11,834 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-13 09:09:11,836 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 09:09:11,837 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-13 09:09:11,844 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-13 09:09:11,844 - qa_analytics - INFO - Found 4 data sources and 8 analytic mappings
2025-05-13 09:09:11,848 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-13 09:09:11,851 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-13 09:09:11,857 - qa_analytics - WARNING - Template metadata file not found: templates\metadata.yaml
2025-05-13 09:09:11,857 - qa_analytics - WARNING - Scheduler configuration not found at configs/scheduler.yaml, using defaults
2025-05-13 09:09:11,878 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-13 09:09:11,878 - qa_analytics - INFO - Found 4 data sources and 8 analytic mappings
2025-05-13 09:09:37,950 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 09:09:37,953 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-13 09:09:37,954 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 09:09:37,955 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 09:09:37,956 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-13 09:09:37,963 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-13 09:09:37,963 - qa_analytics - INFO - Found 4 data sources and 8 analytic mappings
2025-05-13 09:09:37,967 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-13 09:09:37,969 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-13 09:09:37,975 - qa_analytics - WARNING - Template metadata file not found: templates\metadata.yaml
2025-05-13 09:09:37,975 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-13 09:09:37,993 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-13 09:09:37,993 - qa_analytics - INFO - Found 4 data sources and 8 analytic mappings
2025-05-13 09:11:01,711 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 09:11:01,712 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-13 09:11:01,714 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 09:11:01,715 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 09:11:01,716 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-13 09:11:01,723 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-13 09:11:01,723 - qa_analytics - INFO - Found 4 data sources and 8 analytic mappings
2025-05-13 09:11:01,726 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-13 09:11:01,730 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-13 09:11:01,735 - qa_analytics - WARNING - Template metadata file not found: templates\metadata.yaml
2025-05-13 09:11:01,735 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-13 09:11:01,755 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-13 09:11:01,755 - qa_analytics - INFO - Found 4 data sources and 8 analytic mappings
2025-05-13 09:13:27,947 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 09:13:27,949 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-13 09:13:27,950 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 09:13:27,951 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 09:13:27,952 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-13 09:13:27,959 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-13 09:13:27,960 - qa_analytics - INFO - Found 4 data sources and 8 analytic mappings
2025-05-13 09:13:27,963 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-13 09:13:27,966 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-13 09:13:27,971 - qa_analytics - INFO - Loaded template metadata
2025-05-13 09:13:27,971 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-13 09:13:27,990 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-13 09:13:27,990 - qa_analytics - INFO - Found 4 data sources and 8 analytic mappings
2025-05-13 09:17:52,746 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 09:17:52,748 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-13 09:17:52,749 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 09:17:52,750 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 09:17:52,751 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-13 09:17:52,759 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-13 09:17:52,759 - qa_analytics - INFO - Found 4 data sources and 8 analytic mappings
2025-05-13 09:17:52,762 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-13 09:17:52,765 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-13 09:17:52,770 - qa_analytics - INFO - Loaded template metadata
2025-05-13 09:17:52,771 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-13 09:17:52,790 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-13 09:17:52,790 - qa_analytics - INFO - Found 4 data sources and 8 analytic mappings
2025-05-13 09:18:32,518 - qa_analytics - ERROR - Error applying template: 'list' object has no attribute 'startswith'
2025-05-13 09:18:42,265 - qa_analytics - ERROR - Error applying template: 'list' object has no attribute 'startswith'
2025-05-13 09:18:53,331 - qa_analytics - ERROR - Error applying template: 'list' object has no attribute 'startswith'
2025-05-13 09:18:59,422 - qa_analytics - ERROR - Error applying template: 'list' object has no attribute 'startswith'
2025-05-13 09:19:01,112 - qa_analytics - ERROR - Error applying template: 'list' object has no attribute 'startswith'
2025-05-13 09:20:18,837 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 09:20:18,839 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-13 09:20:18,841 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 09:20:18,841 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 09:20:18,843 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-13 09:20:18,850 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-13 09:20:18,850 - qa_analytics - INFO - Found 4 data sources and 8 analytic mappings
2025-05-13 09:20:18,853 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-13 09:20:18,856 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-13 09:20:18,861 - qa_analytics - INFO - Loaded template metadata
2025-05-13 09:20:18,862 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-13 09:20:18,881 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-13 09:20:18,881 - qa_analytics - INFO - Found 4 data sources and 8 analytic mappings
2025-05-13 10:59:22,849 - qa_analytics - INFO - Created directory: test_data
2025-05-13 10:59:22,850 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-13 10:59:22,907 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 10:59:22,910 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-13 10:59:22,911 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 10:59:22,912 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 10:59:22,913 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-13 10:59:22,920 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-13 10:59:22,920 - qa_analytics - INFO - Found 4 data sources and 8 analytic mappings
2025-05-13 10:59:22,924 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-13 10:59:22,927 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-13 10:59:22,932 - qa_analytics - INFO - Loaded template metadata
2025-05-13 10:59:22,933 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-13 10:59:22,952 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-13 10:59:22,952 - qa_analytics - INFO - Found 4 data sources and 8 analytic mappings
2025-05-13 11:00:03,268 - qa_analytics - ERROR - Error applying template: 'int' object has no attribute 'isdigit'
2025-05-13 11:00:25,706 - qa_analytics - ERROR - Error applying template: 'int' object has no attribute 'isdigit'
2025-05-13 11:04:49,912 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-13 11:04:49,957 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:04:49,959 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-13 11:04:49,960 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:04:49,961 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:04:49,962 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-13 11:04:49,970 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-13 11:04:49,970 - qa_analytics - INFO - Found 4 data sources and 8 analytic mappings
2025-05-13 11:04:49,973 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-13 11:04:49,976 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-13 11:04:49,981 - qa_analytics - INFO - Loaded template metadata
2025-05-13 11:04:49,982 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-13 11:04:50,001 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-13 11:04:50,001 - qa_analytics - INFO - Found 4 data sources and 8 analytic mappings
2025-05-13 11:05:23,608 - qa_analytics - INFO - Saved configuration to configs\qa_100.yaml
2025-05-13 11:05:24,643 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:05:24,645 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-13 11:05:24,653 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-13 11:05:24,654 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:05:24,655 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:05:45,092 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-13 11:05:45,136 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:05:45,139 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-13 11:05:45,140 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-13 11:05:45,141 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:05:45,142 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:05:45,143 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-13 11:05:45,150 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-13 11:05:45,150 - qa_analytics - INFO - Found 4 data sources and 8 analytic mappings
2025-05-13 11:05:45,154 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-13 11:05:45,157 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-13 11:05:45,162 - qa_analytics - INFO - Loaded template metadata
2025-05-13 11:05:45,163 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-13 11:05:45,182 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-13 11:05:45,182 - qa_analytics - INFO - Found 4 data sources and 8 analytic mappings
2025-05-13 11:12:18,971 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-13 11:12:19,020 - qa_analytics - ERROR - Error loading config data_sources.yaml: mapping values are not allowed here
  in "configs\data_sources.yaml", line 243, column 18
2025-05-13 11:12:19,022 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-13 11:12:19,023 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-13 11:12:19,025 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:12:19,025 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:12:19,027 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-13 11:12:19,035 - qa_analytics - ERROR - Error loading data source registry: mapping values are not allowed here
  in "configs/data_sources.yaml", line 243, column 18
2025-05-13 11:12:19,038 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-13 11:12:19,041 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-13 11:12:19,047 - qa_analytics - INFO - Loaded template metadata
2025-05-13 11:12:19,047 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-13 11:12:19,067 - qa_analytics - ERROR - Error loading data source registry: mapping values are not allowed here
  in "configs/data_sources.yaml", line 243, column 18
2025-05-13 11:13:04,892 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-13 11:13:04,940 - qa_analytics - ERROR - Error loading config data_sources.yaml: mapping values are not allowed here
  in "configs\data_sources.yaml", line 243, column 18
2025-05-13 11:13:04,942 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-13 11:13:04,943 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-13 11:13:04,944 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:13:04,945 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:13:04,946 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-13 11:13:04,954 - qa_analytics - ERROR - Error loading data source registry: mapping values are not allowed here
  in "configs/data_sources.yaml", line 243, column 18
2025-05-13 11:13:04,958 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-13 11:13:04,961 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-13 11:13:04,966 - qa_analytics - INFO - Loaded template metadata
2025-05-13 11:13:04,967 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-13 11:13:04,986 - qa_analytics - ERROR - Error loading data source registry: mapping values are not allowed here
  in "configs/data_sources.yaml", line 243, column 18
2025-05-13 11:18:10,504 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-13 11:18:10,550 - qa_analytics - ERROR - Error loading config data_sources.yaml: mapping values are not allowed here
  in "configs\data_sources.yaml", line 243, column 18
2025-05-13 11:18:10,552 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-13 11:18:10,553 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-13 11:18:10,555 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:18:10,555 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:18:10,557 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-13 11:18:10,566 - qa_analytics - ERROR - Error loading data source registry: mapping values are not allowed here
  in "configs/data_sources.yaml", line 243, column 18
2025-05-13 11:18:10,569 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-13 11:18:10,572 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-13 11:18:10,577 - qa_analytics - INFO - Loaded template metadata
2025-05-13 11:18:10,578 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-13 11:18:10,599 - qa_analytics - ERROR - Error loading data source registry: mapping values are not allowed here
  in "configs/data_sources.yaml", line 243, column 18
2025-05-13 11:19:53,356 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-13 11:19:53,403 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:19:53,405 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-13 11:19:53,406 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-13 11:19:53,408 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:19:53,408 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:19:53,410 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-13 11:19:53,418 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-13 11:19:53,419 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-13 11:19:53,422 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-13 11:19:53,425 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-13 11:19:53,431 - qa_analytics - INFO - Loaded template metadata
2025-05-13 11:19:53,431 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-13 11:19:53,452 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-13 11:19:53,452 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-13 11:20:33,502 - qa_analytics - INFO - Saved configuration to configs\qa_101.yaml
2025-05-13 11:20:34,762 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:20:34,764 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-13 11:20:34,766 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-13 11:20:34,772 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-13 11:20:34,773 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:20:34,774 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:23:12,374 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-13 11:23:12,421 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:23:12,423 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-13 11:23:12,423 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-13 11:23:12,425 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-13 11:23:12,426 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:23:12,426 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:23:12,428 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-13 11:23:12,438 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-13 11:23:12,438 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-13 11:23:12,442 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-13 11:23:12,445 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-13 11:23:12,451 - qa_analytics - INFO - Loaded template metadata
2025-05-13 11:23:12,451 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-13 11:23:12,472 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-13 11:23:12,472 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-13 11:23:42,116 - qa_analytics - INFO - Saved configuration to configs\qa_102.yaml
2025-05-13 11:23:43,425 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:23:43,427 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-13 11:23:43,428 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-13 11:23:43,429 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-13 11:23:43,436 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-13 11:23:43,437 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:23:43,438 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:30:17,884 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-13 11:30:17,932 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:30:17,934 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-13 11:30:17,935 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-13 11:30:17,937 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-13 11:30:17,938 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-13 11:30:17,939 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:30:17,939 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:30:17,941 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-13 11:30:17,951 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-13 11:30:17,951 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-13 11:30:17,954 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-13 11:30:17,957 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-13 11:30:17,963 - qa_analytics - INFO - Loaded template metadata
2025-05-13 11:30:17,963 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-13 11:30:17,987 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-13 11:30:17,987 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-13 11:30:55,415 - qa_analytics - INFO - Successfully generated configuration for template risk_assessment
2025-05-13 11:30:57,190 - qa_analytics - INFO - Saved configuration to configs\qa_103.yaml
2025-05-13 11:30:58,539 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:30:58,541 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-13 11:30:58,542 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-13 11:30:58,544 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-13 11:30:58,545 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-13 11:30:58,551 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-13 11:30:58,553 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-13 11:30:58,553 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-14 12:37:55,772 - excel_formula_test - INFO - EXCEL FORMULA ENHANCEMENT DEMO
2025-05-14 12:37:55,772 - excel_formula_test - INFO - ============================
2025-05-14 12:37:55,772 - excel_formula_test - INFO - === EXCEL FORMULA PARSER TESTS ===
2025-05-14 12:37:55,772 - qa_analytics - INFO - Parsed formula: Submitter = Approver -> (df['Submitter']==df['Approver'])
2025-05-14 12:37:55,789 - excel_formula_test - INFO -   Expected: (df['Submitter'] == df['Approver'])
2025-05-14 12:37:55,789 - excel_formula_test - INFO -   Fields used: ['Submitter', 'Approver']
2025-05-14 12:37:55,789 - excel_formula_test - INFO - ---
2025-05-14 12:37:55,789 - qa_analytics - INFO - Parsed formula: Submitter <> Approver -> (df['Submitter']!=df['Approver'])
2025-05-14 12:37:55,790 - excel_formula_test - INFO -   Expected: (df['Submitter'] != df['Approver'])
2025-05-14 12:37:55,790 - excel_formula_test - INFO -   Fields used: ['Submitter', 'Approver']
2025-05-14 12:37:55,790 - excel_formula_test - INFO - ---
2025-05-14 12:37:55,791 - excel_formula_test - INFO - ---
2025-05-14 12:37:55,792 - excel_formula_test - INFO - ---
2025-05-14 12:37:55,793 - excel_formula_test - INFO - ---
2025-05-14 12:37:55,794 - excel_formula_test - INFO - ---
2025-05-14 12:37:55,796 - excel_formula_test - INFO - ---
2025-05-14 12:37:55,797 - excel_formula_test - INFO - ---
2025-05-14 12:37:55,797 - qa_analytics - INFO - Parsed formula: NOT Complete -> (~df['Complete'])
2025-05-14 12:37:55,797 - excel_formula_test - INFO -   Expected: (~(df['Complete']))
2025-05-14 12:37:55,797 - excel_formula_test - INFO -   Fields used: ['Complete']
2025-05-14 12:37:55,797 - excel_formula_test - INFO - ---
2025-05-14 12:37:55,798 - excel_formula_test - INFO - ---
2025-05-14 12:37:55,802 - excel_formula_test - INFO - ---
2025-05-14 12:37:55,803 - excel_formula_test - INFO - ---
2025-05-14 12:37:55,803 - qa_analytics - INFO - Parsed formula: ISBLANK(Approver) -> (pd.isnadf['Approver']))
2025-05-14 12:37:55,805 - excel_formula_test - INFO -   Expected: (pd.isna(df['Approver']))
2025-05-14 12:37:55,805 - excel_formula_test - INFO -   Fields used: ['Approver']
2025-05-14 12:37:55,805 - excel_formula_test - INFO - ---
2025-05-14 12:37:55,805 - qa_analytics - INFO - Parsed formula: NOT ISBLANK(Approver) -> (~pd.isnadf['Approver']))
2025-05-14 12:37:55,805 - excel_formula_test - INFO -   Expected: (~pd.isna(df['Approver']))
2025-05-14 12:37:55,805 - excel_formula_test - INFO -   Fields used: ['Approver']
2025-05-14 12:37:55,805 - excel_formula_test - INFO - ---
2025-05-14 12:37:55,806 - qa_analytics - INFO - Parsed formula: Risk Level IN ("High", "Medium") -> (df['Risk']df['Level'].isin("High","Medium"))
2025-05-14 12:37:55,806 - excel_formula_test - INFO -   Expected: (df['Risk Level'].isin(["High", "Medium"]))
2025-05-14 12:37:55,806 - excel_formula_test - INFO -   Fields used: ['Risk', 'Level']
2025-05-14 12:37:55,807 - excel_formula_test - INFO - ---
2025-05-14 12:37:55,807 - excel_formula_test - INFO - 
=== CUSTOM FORMULA VALIDATION TESTS ===
2025-05-14 12:37:55,812 - excel_formula_test - INFO - Test data created with 5 records
2025-05-14 12:37:55,812 - excel_formula_test - INFO - 
Testing formula: Submitter <> Approver
2025-05-14 12:37:55,812 - qa_analytics - INFO - Parsed formula: Submitter <> Approver -> (df['Submitter']!=df['Approver'])
2025-05-14 12:37:55,812 - excel_formula_test - INFO - Parsed: (df['Submitter']!=df['Approver'])
2025-05-14 12:37:55,812 - excel_formula_test - INFO - Fields: ['Submitter', 'Approver']
2025-05-14 12:37:55,813 - excel_formula_test - INFO - Results: 4 of 5 records pass (80.0%)
2025-05-14 12:37:55,815 - excel_formula_test - INFO - 
Passing Examples:
2025-05-14 12:37:55,818 - excel_formula_test - INFO -   Submitter Approver
0      John    Alice
1      Mary     John
2025-05-14 12:37:55,819 - excel_formula_test - INFO - 
Failing Examples:
2025-05-14 12:37:55,819 - excel_formula_test - INFO -   Submitter Approver
2      John     John
2025-05-14 12:37:55,819 - excel_formula_test - INFO - 
Testing formula: `Submit Date` <= `TL Date`
2025-05-14 12:37:55,819 - excel_formula_test - ERROR - Error testing formula: Unknown token in formula: <=
2025-05-14 12:37:55,819 - excel_formula_test - INFO - 
Testing formula: Value > 100
2025-05-14 12:37:55,820 - excel_formula_test - ERROR - Error testing formula: Unknown token in formula: >
2025-05-14 12:37:55,820 - excel_formula_test - INFO - 
Testing formula: Risk Level = "High"
2025-05-14 12:37:55,820 - qa_analytics - INFO - Parsed formula: Risk Level = "High" -> (df['Risk']df['Level']=="High")
2025-05-14 12:37:55,820 - excel_formula_test - INFO - Parsed: (df['Risk']df['Level']=="High")
2025-05-14 12:37:55,820 - excel_formula_test - INFO - Fields: ['Risk', 'Level']
2025-05-14 12:37:55,820 - qa_analytics - ERROR - Custom formula failed: invalid syntax. Perhaps you forgot a comma? (<string>, line 1), Formula: Risk Level = "High"
2025-05-14 12:37:55,820 - excel_formula_test - INFO - Results: 0 of 5 records pass (0.0%)
2025-05-14 12:37:55,821 - excel_formula_test - INFO - 
Failing Examples:
2025-05-14 12:37:55,821 - excel_formula_test - ERROR - Error testing formula: "None of [Index(['Risk', 'Level'], dtype='object')] are in the [columns]"
2025-05-14 12:37:55,821 - excel_formula_test - INFO - 
Testing formula: Submitter <> Approver AND `Submit Date` <= `TL Date`
2025-05-14 12:37:55,821 - excel_formula_test - ERROR - Error testing formula: Unknown token in formula: <=
2025-05-14 12:37:55,821 - excel_formula_test - INFO - 
=== CONFIGURATION EXAMPLE ===
2025-05-14 12:37:55,821 - excel_formula_test - INFO - Sample YAML configuration with Excel formula:
2025-05-14 12:37:55,821 - excel_formula_test - INFO - 
analytic_id: 99
analytic_name: 'Custom Formula Demo'
analytic_description: 'Demonstrates Excel-style formula validation'

# Data source configuration
data_source:
  name: 'approval_workflow'
  required_fields:
    - 'Submitter'
    - 'Approver'
    - 'Submit Date'
    - 'TL Date'
    - 'Risk Level'
    - 'Value'

# Validations with custom formula
validations:
  - rule: custom_formula
    description: 'Submitter cannot approve their own work and approval sequence must be followed'
    parameters:
      original_formula: 'Submitter <> Approver AND `Submit Date` <= `TL Date`'
      formula: "(df['Submitter'] != df['Approver']) & (df['Submit Date'] <= df['TL Date'])"
    metadata:
      fields_used: ['Submitter', 'Approver', 'Submit Date', 'TL Date']
  
  - rule: segregation_of_duties
    description: 'Traditional segregation of duties validation for comparison'
    parameters:
      submitter_field: 'Submitter'
      approver_fields: ['Approver']

thresholds:
  error_percentage: 5.0
  rationale: 'Industry standard allows for up to 5% error rate.'

reporting:
  group_by: 'Approver'
  summary_fields: ['GC', 'PC', 'DNC', 'Total', 'DNC_Percentage']
  detail_required: True

2025-05-14 12:37:55,821 - excel_formula_test - INFO - 
=== TEST UTILITY EXAMPLE ===
2025-05-14 12:37:55,822 - excel_formula_test - INFO - Testing formula: Submitter <> Approver AND `Submit Date` <= `TL Date`
2025-05-14 12:37:55,825 - excel_formula_test - INFO - Parsed formula: (df['Submitter'] != df['Approver']) & (df['Submit Date'] <= df['TL Date'])
2025-05-14 12:37:55,825 - excel_formula_test - INFO - Fields used: Submitter, Approver, Submit Date, TL Date
2025-05-14 12:37:55,825 - excel_formula_test - INFO - Total records: 5
2025-05-14 12:37:55,825 - excel_formula_test - INFO - Passing: 2 (40.0%)
2025-05-14 12:37:55,825 - excel_formula_test - INFO - Failing: 3
2025-05-14 12:37:55,825 - excel_formula_test - INFO - 
Passing Examples:
2025-05-14 12:37:55,826 - excel_formula_test - INFO -   1. {'Submitter': 'John', 'Approver': 'Alice', 'Submit Date': Timestamp('2025-01-01 00:00:00'), 'TL Date': Timestamp('2025-01-05 00:00:00'), 'Risk Level': 'High', 'Value': 100, 'Complete': True}
2025-05-14 12:37:55,826 - excel_formula_test - INFO -   2. {'Submitter': 'Bob', 'Approver': 'Charlie', 'Submit Date': Timestamp('2025-04-01 00:00:00'), 'TL Date': Timestamp('2025-05-01 00:00:00'), 'Risk Level': 'Critical', 'Value': 500, 'Complete': True}
2025-05-14 12:37:55,826 - excel_formula_test - INFO - 
Failing Examples:
2025-05-14 12:37:55,826 - excel_formula_test - INFO -   1. {'Submitter': 'Mary', 'Approver': 'John', 'Submit Date': Timestamp('2025-02-01 00:00:00'), 'TL Date': Timestamp('2025-01-15 00:00:00'), 'Risk Level': 'Medium', 'Value': 200, 'Complete': True}
2025-05-14 12:37:55,826 - excel_formula_test - INFO -   2. {'Submitter': 'John', 'Approver': 'John', 'Submit Date': Timestamp('2025-03-01 00:00:00'), 'TL Date': Timestamp('2025-02-01 00:00:00'), 'Risk Level': 'Low', 'Value': 50, 'Complete': False}
2025-05-14 12:37:55,826 - excel_formula_test - INFO - 
Demo complete. This shows how the Excel Formula Enhancement would work
2025-05-14 12:37:55,826 - excel_formula_test - INFO - in the QA Analytics Framework. The actual parser implementation would
2025-05-14 12:37:55,826 - excel_formula_test - INFO - replace the hardcoded examples used in this demonstration.
2025-05-14 12:48:30,433 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND `Submit Date` <= `TL Date` -> (df['Submitter']!=df['Approver']&df['Submit Date']<=df['TL Date'])
2025-05-14 12:48:30,434 - qa_analytics - ERROR - Custom formula failed: unsupported operand type(s) for &: 'str' and 'int', Formula: Submitter <> Approver AND `Submit Date` <= `TL Date`
2025-05-14 12:59:20,244 - excel_formula_test - INFO - EXCEL FORMULA ENHANCEMENT DEMO
2025-05-14 12:59:20,244 - excel_formula_test - INFO - ============================
2025-05-14 12:59:20,244 - excel_formula_test - INFO - === EXCEL FORMULA PARSER TESTS ===
2025-05-14 12:59:20,245 - qa_analytics - INFO - Parsed formula: Submitter = Approver -> (df['Submitter']==df['Approver'])
2025-05-14 12:59:20,247 - excel_formula_test - INFO -   Parsed: (df['Submitter']==df['Approver'])
2025-05-14 12:59:20,247 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver']
2025-05-14 12:59:20,247 - excel_formula_test - INFO - ---
2025-05-14 12:59:20,247 - qa_analytics - INFO - Parsed formula: Submitter <> Approver -> (df['Submitter']!=df['Approver'])
2025-05-14 12:59:20,248 - excel_formula_test - INFO -   Parsed: (df['Submitter']!=df['Approver'])
2025-05-14 12:59:20,248 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver']
2025-05-14 12:59:20,248 - excel_formula_test - INFO - ---
2025-05-14 12:59:20,248 - qa_analytics - INFO - Parsed formula: Value > 100 -> (df['Value']>100)
2025-05-14 12:59:20,249 - excel_formula_test - INFO -   Parsed: (df['Value']>100)
2025-05-14 12:59:20,249 - excel_formula_test - INFO -   Fields: ['Value']
2025-05-14 12:59:20,249 - excel_formula_test - INFO - ---
2025-05-14 12:59:20,249 - qa_analytics - INFO - Parsed formula: Value >= 100 -> (df['Value']>=100)
2025-05-14 12:59:20,249 - excel_formula_test - INFO -   Parsed: (df['Value']>=100)
2025-05-14 12:59:20,249 - excel_formula_test - INFO -   Fields: ['Value']
2025-05-14 12:59:20,249 - excel_formula_test - INFO - ---
2025-05-14 12:59:20,249 - qa_analytics - INFO - Parsed formula: Value < 200 -> (df['Value']<200)
2025-05-14 12:59:20,251 - excel_formula_test - INFO -   Parsed: (df['Value']<200)
2025-05-14 12:59:20,251 - excel_formula_test - INFO -   Fields: ['Value']
2025-05-14 12:59:20,251 - excel_formula_test - INFO - ---
2025-05-14 12:59:20,251 - qa_analytics - INFO - Parsed formula: Value <= 200 -> (df['Value']<=200)
2025-05-14 12:59:20,252 - excel_formula_test - INFO -   Parsed: (df['Value']<=200)
2025-05-14 12:59:20,252 - excel_formula_test - INFO -   Fields: ['Value']
2025-05-14 12:59:20,252 - excel_formula_test - INFO - ---
2025-05-14 12:59:20,252 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND Value > 100 -> (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 12:59:20,253 - excel_formula_test - INFO -   Parsed: (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 12:59:20,253 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver', 'Value']
2025-05-14 12:59:20,253 - excel_formula_test - INFO - ---
2025-05-14 12:59:20,253 - qa_analytics - INFO - Parsed formula: Submitter = Approver OR Value > 100 -> (df['Submitter']==df['Approver']) | (df['Value']>100)
2025-05-14 12:59:20,254 - excel_formula_test - INFO -   Parsed: (df['Submitter']==df['Approver']) | (df['Value']>100)
2025-05-14 12:59:20,254 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver', 'Value']
2025-05-14 12:59:20,254 - excel_formula_test - INFO - ---
2025-05-14 12:59:20,254 - qa_analytics - INFO - Parsed formula: NOT Complete -> (~df['Complete'])
2025-05-14 12:59:20,255 - excel_formula_test - INFO -   Parsed: (~df['Complete'])
2025-05-14 12:59:20,255 - excel_formula_test - INFO -   Fields: ['Complete']
2025-05-14 12:59:20,255 - excel_formula_test - INFO - ---
2025-05-14 12:59:20,255 - qa_analytics - INFO - Parsed formula: (Submitter <> Approver) AND (Value > 100) -> (df['Submitter']!=df['Approver'])&(df['Value']>100)
2025-05-14 12:59:20,255 - excel_formula_test - INFO -   Parsed: (df['Submitter']!=df['Approver'])&(df['Value']>100)
2025-05-14 12:59:20,256 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver', 'Value']
2025-05-14 12:59:20,256 - excel_formula_test - INFO - ---
2025-05-14 12:59:20,256 - qa_analytics - INFO - Parsed formula: Submit Date <= TL Date -> (df['Submit']df['Date']<=df['TL']df['Date'])
2025-05-14 12:59:20,256 - excel_formula_test - INFO -   Parsed: (df['Submit']df['Date']<=df['TL']df['Date'])
2025-05-14 12:59:20,256 - excel_formula_test - INFO -   Fields: ['TL Date', 'Submit Date', 'Submit', 'Date', 'TL']
2025-05-14 12:59:20,256 - excel_formula_test - INFO - ---
2025-05-14 12:59:20,257 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND Submit Date <= TL Date AND Value > 100 -> ((df['Submitter']!=df['Approver']) & (df['Submit']df['Date']<=df['TL']df['Date'])&df['Value']>100)
2025-05-14 12:59:20,257 - excel_formula_test - INFO -   Parsed: ((df['Submitter']!=df['Approver']) & (df['Submit']df['Date']<=df['TL']df['Date'])&df['Value']>100)
2025-05-14 12:59:20,257 - excel_formula_test - INFO -   Fields: ['TL Date', 'Submit Date', 'Submitter', 'Approver', 'Submit', 'Date', 'TL', 'Value']
2025-05-14 12:59:20,257 - excel_formula_test - INFO - ---
2025-05-14 12:59:20,257 - qa_analytics - INFO - Parsed formula: ISBLANK(Approver) -> (pd.isna)
2025-05-14 12:59:20,258 - excel_formula_test - INFO -   Parsed: (pd.isna)
2025-05-14 12:59:20,258 - excel_formula_test - INFO -   Fields: []
2025-05-14 12:59:20,258 - excel_formula_test - INFO - ---
2025-05-14 12:59:20,258 - qa_analytics - INFO - Parsed formula: NOT ISBLANK(Approver) -> (~pd.isna)
2025-05-14 12:59:20,259 - excel_formula_test - INFO -   Parsed: (~pd.isna)
2025-05-14 12:59:20,259 - excel_formula_test - INFO -   Fields: []
2025-05-14 12:59:20,259 - excel_formula_test - INFO - ---
2025-05-14 12:59:20,259 - qa_analytics - INFO - Parsed formula: Risk Level IN ("High", "Medium") -> (df['Risk']df['Level'].isin("High","Medium"))
2025-05-14 12:59:20,260 - excel_formula_test - INFO -   Parsed: (df['Risk']df['Level'].isin("High","Medium"))
2025-05-14 12:59:20,260 - excel_formula_test - INFO -   Fields: ['Risk', 'Level']
2025-05-14 12:59:20,260 - excel_formula_test - INFO - ---
2025-05-14 12:59:20,260 - excel_formula_test - INFO - 
=== FORMULA VALIDATION TESTS ===
2025-05-14 12:59:20,261 - excel_formula_test - INFO - Test data created with 5 records
2025-05-14 12:59:20,261 - excel_formula_test - INFO - 
Testing formula: Submitter <> Approver
2025-05-14 12:59:20,261 - qa_analytics - INFO - Parsed formula: Submitter <> Approver -> (df['Submitter']!=df['Approver'])
2025-05-14 12:59:20,262 - excel_formula_test - INFO - Parsed: (df['Submitter']!=df['Approver'])
2025-05-14 12:59:20,262 - excel_formula_test - INFO - Fields: ['Submitter', 'Approver']
2025-05-14 12:59:20,262 - excel_formula_test - INFO - Results: 4 of 5 records pass (80.0%)
2025-05-14 12:59:20,262 - excel_formula_test - INFO - Expected: 3 records, Got: 4
2025-05-14 12:59:20,262 - excel_formula_test - INFO - Passing Examples:
2025-05-14 12:59:20,265 - excel_formula_test - INFO -   Submitter Approver
0      John    Alice
1      Mary     John
2025-05-14 12:59:20,265 - excel_formula_test - INFO - Failing Examples:
2025-05-14 12:59:20,266 - excel_formula_test - INFO -   Submitter Approver
2      John     John
2025-05-14 12:59:20,266 - excel_formula_test - INFO - 
Testing formula: Value > 100
2025-05-14 12:59:20,266 - qa_analytics - INFO - Parsed formula: Value > 100 -> (df['Value']>100)
2025-05-14 12:59:20,266 - excel_formula_test - INFO - Parsed: (df['Value']>100)
2025-05-14 12:59:20,266 - excel_formula_test - INFO - Fields: ['Value']
2025-05-14 12:59:20,266 - excel_formula_test - INFO - Results: 2 of 5 records pass (40.0%)
2025-05-14 12:59:20,266 - excel_formula_test - INFO - Expected: 3 records, Got: 2
2025-05-14 12:59:20,266 - excel_formula_test - INFO - Passing Examples:
2025-05-14 12:59:20,267 - excel_formula_test - INFO -    Value
1    200
3    500
2025-05-14 12:59:20,267 - excel_formula_test - INFO - Failing Examples:
2025-05-14 12:59:20,268 - excel_formula_test - INFO -    Value
0    100
2     50
2025-05-14 12:59:20,268 - excel_formula_test - INFO - 
Testing formula: `Submit Date` <= `TL Date`
2025-05-14 12:59:20,268 - qa_analytics - INFO - Parsed formula: Submit Date <= TL Date -> (df['Submit']df['Date']<=df['TL']df['Date'])
2025-05-14 12:59:20,268 - excel_formula_test - INFO - Parsed: (df['Submit']df['Date']<=df['TL']df['Date'])
2025-05-14 12:59:20,268 - excel_formula_test - INFO - Fields: ['TL Date', 'Submit Date', 'Submit', 'Date', 'TL']
2025-05-14 12:59:20,268 - qa_analytics - ERROR - Custom formula failed: invalid syntax. Perhaps you forgot a comma? (<string>, line 1), Formula: `Submit Date` <= `TL Date`
2025-05-14 12:59:20,268 - excel_formula_test - INFO - Results: 0 of 5 records pass (0.0%)
2025-05-14 12:59:20,268 - excel_formula_test - INFO - Expected: 3 records, Got: 0
2025-05-14 12:59:20,268 - excel_formula_test - INFO - Failing Examples:
2025-05-14 12:59:20,269 - excel_formula_test - ERROR - Error testing formula: "['Submit', 'Date', 'TL'] not in index"
2025-05-14 12:59:20,269 - excel_formula_test - INFO - 
Testing formula: Submitter <> Approver AND Value > 100
2025-05-14 12:59:20,269 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND Value > 100 -> (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 12:59:20,269 - excel_formula_test - INFO - Parsed: (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 12:59:20,269 - excel_formula_test - INFO - Fields: ['Submitter', 'Approver', 'Value']
2025-05-14 12:59:20,269 - excel_formula_test - INFO - Results: 2 of 5 records pass (40.0%)
2025-05-14 12:59:20,269 - excel_formula_test - INFO - Expected: 2 records, Got: 2
2025-05-14 12:59:20,269 - excel_formula_test - INFO - Passing Examples:
2025-05-14 12:59:20,269 - excel_formula_test - INFO -   Submitter Approver  Value
1      Mary     John    200
3       Bob  Charlie    500
2025-05-14 12:59:20,271 - excel_formula_test - INFO - Failing Examples:
2025-05-14 12:59:20,272 - excel_formula_test - INFO -   Submitter Approver  Value
0      John    Alice    100
2      John     John     50
2025-05-14 12:59:20,272 - excel_formula_test - INFO - 
Testing formula: Risk Level = "High"
2025-05-14 12:59:20,272 - qa_analytics - INFO - Parsed formula: Risk Level = "High" -> (df['Risk']df['Level']=="High")
2025-05-14 12:59:20,272 - excel_formula_test - INFO - Parsed: (df['Risk']df['Level']=="High")
2025-05-14 12:59:20,272 - excel_formula_test - INFO - Fields: ['Risk', 'Level']
2025-05-14 12:59:20,272 - qa_analytics - ERROR - Custom formula failed: invalid syntax. Perhaps you forgot a comma? (<string>, line 1), Formula: Risk Level = "High"
2025-05-14 12:59:20,272 - excel_formula_test - INFO - Results: 0 of 5 records pass (0.0%)
2025-05-14 12:59:20,272 - excel_formula_test - INFO - Expected: 1 records, Got: 0
2025-05-14 12:59:20,272 - excel_formula_test - INFO - Failing Examples:
2025-05-14 12:59:20,273 - excel_formula_test - ERROR - Error testing formula: "None of [Index(['Risk', 'Level'], dtype='object')] are in the [columns]"
2025-05-14 12:59:20,273 - excel_formula_test - INFO - 
Testing formula: Risk Level IN ("High", "Medium")
2025-05-14 12:59:20,273 - qa_analytics - INFO - Parsed formula: Risk Level IN ("High", "Medium") -> (df['Risk']df['Level'].isin("High","Medium"))
2025-05-14 12:59:20,273 - excel_formula_test - INFO - Parsed: (df['Risk']df['Level'].isin("High","Medium"))
2025-05-14 12:59:20,273 - excel_formula_test - INFO - Fields: ['Risk', 'Level']
2025-05-14 12:59:20,273 - qa_analytics - ERROR - Custom formula failed: invalid syntax. Perhaps you forgot a comma? (<string>, line 1), Formula: Risk Level IN ("High", "Medium")
2025-05-14 12:59:20,273 - excel_formula_test - INFO - Results: 0 of 5 records pass (0.0%)
2025-05-14 12:59:20,273 - excel_formula_test - INFO - Expected: 2 records, Got: 0
2025-05-14 12:59:20,273 - excel_formula_test - INFO - Failing Examples:
2025-05-14 12:59:20,274 - excel_formula_test - ERROR - Error testing formula: "None of [Index(['Risk', 'Level'], dtype='object')] are in the [columns]"
2025-05-14 12:59:20,274 - excel_formula_test - INFO - 
Testing formula: NOT ISBLANK(Value)
2025-05-14 12:59:20,274 - qa_analytics - INFO - Parsed formula: NOT ISBLANK(Value) -> (~pd.isna)
2025-05-14 12:59:20,274 - excel_formula_test - INFO - Parsed: (~pd.isna)
2025-05-14 12:59:20,274 - excel_formula_test - INFO - Fields: []
2025-05-14 12:59:20,274 - qa_analytics - ERROR - Custom formula failed: bad operand type for unary ~: 'function', Formula: NOT ISBLANK(Value)
2025-05-14 12:59:20,274 - excel_formula_test - INFO - Results: 0 of 5 records pass (0.0%)
2025-05-14 12:59:20,274 - excel_formula_test - INFO - Expected: 5 records, Got: 0
2025-05-14 12:59:20,274 - excel_formula_test - INFO - Failing Examples:
2025-05-14 12:59:20,275 - excel_formula_test - INFO - Empty DataFrame
Columns: []
Index: [0, 1]
2025-05-14 12:59:20,276 - excel_formula_test - INFO - 
=== CONFIGURATION EXAMPLE ===
2025-05-14 12:59:20,276 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND Submit Date <= TL Date -> (df['Submitter']!=df['Approver']) & (df['Submit']df['Date']<=df['TL']df['Date'])
2025-05-14 12:59:20,276 - excel_formula_test - INFO - Sample YAML configuration with Excel formula:
2025-05-14 12:59:20,276 - excel_formula_test - INFO - 
analytic_id: 99
analytic_name: 'Custom Formula Demo'
analytic_description: 'Demonstrates Excel-style formula validation'

# Data source configuration
data_source:
  name: 'approval_workflow'
  required_fields:
    - 'Submitter'
    - 'Approver'
    - 'Submit Date'
    - 'TL Date'
    - 'Risk Level'
    - 'Value'

# Validations with custom formula
validations:
  - rule: custom_formula
    description: 'Submitter cannot approve their own work and approval sequence must be followed'
    parameters:
      original_formula: 'Submitter <> Approver AND `Submit Date` <= `TL Date`'
      
  # With the auto-parsing feature you added, just providing the original_formula is enough!
  # The formula will be parsed during validation.
  # For reference, the parser would generate:
  # formula: "(df['Submitter']!=df['Approver']) & (df['Submit']df['Date']<=df['TL']df['Date'])"
  
  - rule: segregation_of_duties
    description: 'Traditional segregation of duties validation for comparison'
    parameters:
      submitter_field: 'Submitter'
      approver_fields: ['Approver']

thresholds:
  error_percentage: 5.0
  rationale: 'Industry standard allows for up to 5% error rate.'

reporting:
  group_by: 'Approver'
  summary_fields: ['GC', 'PC', 'DNC', 'Total', 'DNC_Percentage']
  detail_required: True

2025-05-14 12:59:20,276 - excel_formula_test - INFO - 
Demo complete! The Excel Formula Enhancement is working correctly.
2025-05-14 12:59:20,276 - excel_formula_test - INFO - You can now use Excel-style formulas in your QA Analytics Framework.
2025-05-14 13:06:00,890 - excel_formula_test - INFO - EXCEL FORMULA ENHANCEMENT DEMO
2025-05-14 13:06:00,891 - excel_formula_test - INFO - ============================
2025-05-14 13:06:00,891 - excel_formula_test - INFO - === EXCEL FORMULA PARSER TESTS ===
2025-05-14 13:06:00,891 - qa_analytics - INFO - Parsed formula: Submitter = Approver -> (df['Submitter']==df['Approver'])
2025-05-14 13:06:00,893 - excel_formula_test - INFO -   Parsed: (df['Submitter']==df['Approver'])
2025-05-14 13:06:00,893 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver']
2025-05-14 13:06:00,893 - excel_formula_test - INFO - ---
2025-05-14 13:06:00,894 - qa_analytics - INFO - Parsed formula: Submitter <> Approver -> (df['Submitter']!=df['Approver'])
2025-05-14 13:06:00,894 - excel_formula_test - INFO -   Parsed: (df['Submitter']!=df['Approver'])
2025-05-14 13:06:00,894 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver']
2025-05-14 13:06:00,894 - excel_formula_test - INFO - ---
2025-05-14 13:06:00,894 - qa_analytics - INFO - Parsed formula: Value > 100 -> (df['Value']>100)
2025-05-14 13:06:00,896 - excel_formula_test - INFO -   Parsed: (df['Value']>100)
2025-05-14 13:06:00,896 - excel_formula_test - INFO -   Fields: ['Value']
2025-05-14 13:06:00,896 - excel_formula_test - INFO - ---
2025-05-14 13:06:00,896 - qa_analytics - INFO - Parsed formula: Value >= 100 -> (df['Value']>=100)
2025-05-14 13:06:00,897 - excel_formula_test - INFO -   Parsed: (df['Value']>=100)
2025-05-14 13:06:00,897 - excel_formula_test - INFO -   Fields: ['Value']
2025-05-14 13:06:00,897 - excel_formula_test - INFO - ---
2025-05-14 13:06:00,897 - qa_analytics - INFO - Parsed formula: Value < 200 -> (df['Value']<200)
2025-05-14 13:06:00,898 - excel_formula_test - INFO -   Parsed: (df['Value']<200)
2025-05-14 13:06:00,898 - excel_formula_test - INFO -   Fields: ['Value']
2025-05-14 13:06:00,898 - excel_formula_test - INFO - ---
2025-05-14 13:06:00,899 - qa_analytics - INFO - Parsed formula: Value <= 200 -> (df['Value']<=200)
2025-05-14 13:06:00,899 - excel_formula_test - INFO -   Parsed: (df['Value']<=200)
2025-05-14 13:06:00,899 - excel_formula_test - INFO -   Fields: ['Value']
2025-05-14 13:06:00,899 - excel_formula_test - INFO - ---
2025-05-14 13:06:00,900 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND Value > 100 -> (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 13:06:00,900 - excel_formula_test - INFO -   Parsed: (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 13:06:00,900 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver', 'Value']
2025-05-14 13:06:00,900 - excel_formula_test - INFO - ---
2025-05-14 13:06:00,900 - qa_analytics - INFO - Parsed formula: Submitter = Approver OR Value > 100 -> (df['Submitter']==df['Approver']) | (df['Value']>100)
2025-05-14 13:06:00,901 - excel_formula_test - INFO -   Parsed: (df['Submitter']==df['Approver']) | (df['Value']>100)
2025-05-14 13:06:00,901 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver', 'Value']
2025-05-14 13:06:00,901 - excel_formula_test - INFO - ---
2025-05-14 13:06:00,902 - qa_analytics - INFO - Parsed formula: NOT Complete -> (~df['Complete'])
2025-05-14 13:06:00,902 - excel_formula_test - INFO -   Parsed: (~df['Complete'])
2025-05-14 13:06:00,902 - excel_formula_test - INFO -   Fields: ['Complete']
2025-05-14 13:06:00,902 - excel_formula_test - INFO - ---
2025-05-14 13:06:00,902 - qa_analytics - INFO - Parsed formula: (Submitter <> Approver) AND (Value > 100) -> (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 13:06:00,903 - excel_formula_test - INFO -   Parsed: (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 13:06:00,903 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver', 'Value']
2025-05-14 13:06:00,903 - excel_formula_test - INFO - ---
2025-05-14 13:06:00,904 - qa_analytics - INFO - Parsed formula: __FIELD_1__ <= __FIELD_0__ -> (df['Submit Date']<=df['TL Date'])
2025-05-14 13:06:00,904 - excel_formula_test - INFO -   Parsed: (df['Submit Date']<=df['TL Date'])
2025-05-14 13:06:00,904 - excel_formula_test - INFO -   Fields: ['TL Date', 'Submit Date']
2025-05-14 13:06:00,904 - excel_formula_test - INFO - ---
2025-05-14 13:06:00,904 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND __FIELD_1__ <= __FIELD_0__ AND Value > 100 -> (df['Submitter']!=df['Approver']) & (df['Submit Date']<=df['TL Date']) & (df['Value']>100)
2025-05-14 13:06:00,905 - excel_formula_test - INFO -   Parsed: (df['Submitter']!=df['Approver']) & (df['Submit Date']<=df['TL Date']) & (df['Value']>100)
2025-05-14 13:06:00,905 - excel_formula_test - INFO -   Fields: ['TL Date', 'Submit Date', 'Submitter', 'Approver', 'Value']
2025-05-14 13:06:00,905 - excel_formula_test - INFO - ---
2025-05-14 13:06:00,905 - qa_analytics - INFO - Parsed formula: ISBLANK(Approver) -> (pd.isna(df['Approver']))
2025-05-14 13:06:00,906 - excel_formula_test - INFO -   Parsed: (pd.isna(df['Approver']))
2025-05-14 13:06:00,906 - excel_formula_test - INFO -   Fields: ['Approver']
2025-05-14 13:06:00,906 - excel_formula_test - INFO - ---
2025-05-14 13:06:00,906 - qa_analytics - INFO - Parsed formula: NOT ISBLANK(Approver) -> (~pd.isna(df['Approver']))
2025-05-14 13:06:00,906 - excel_formula_test - INFO -   Parsed: (~pd.isna(df['Approver']))
2025-05-14 13:06:00,906 - excel_formula_test - INFO -   Fields: ['Approver']
2025-05-14 13:06:00,906 - excel_formula_test - INFO - ---
2025-05-14 13:06:00,907 - qa_analytics - INFO - Parsed formula: Risk Level IN ("High", "Medium") -> (df['Risk']df['Level']df['Level'].isin(["High", "Medium"]))
2025-05-14 13:06:00,907 - excel_formula_test - INFO -   Parsed: (df['Risk']df['Level']df['Level'].isin(["High", "Medium"]))
2025-05-14 13:06:00,907 - excel_formula_test - INFO -   Fields: ['Risk', 'Level']
2025-05-14 13:06:00,907 - excel_formula_test - INFO - ---
2025-05-14 13:06:00,907 - excel_formula_test - INFO - 
=== FORMULA VALIDATION TESTS ===
2025-05-14 13:06:00,913 - excel_formula_test - INFO - Test data created with 5 records
2025-05-14 13:06:00,913 - excel_formula_test - INFO - 
Testing formula: Submitter <> Approver
2025-05-14 13:06:00,913 - qa_analytics - INFO - Parsed formula: Submitter <> Approver -> (df['Submitter']!=df['Approver'])
2025-05-14 13:06:00,913 - excel_formula_test - INFO - Parsed: (df['Submitter']!=df['Approver'])
2025-05-14 13:06:00,913 - excel_formula_test - INFO - Fields: ['Submitter', 'Approver']
2025-05-14 13:06:00,915 - excel_formula_test - INFO - Results: 4 of 5 records pass (80.0%)
2025-05-14 13:06:00,915 - excel_formula_test - INFO - Expected: 3 records, Got: 4
2025-05-14 13:06:00,915 - excel_formula_test - INFO - Passing Examples:
2025-05-14 13:06:00,920 - excel_formula_test - INFO -   Submitter Approver
0      John    Alice
1      Mary     John
2025-05-14 13:06:00,920 - excel_formula_test - INFO - Failing Examples:
2025-05-14 13:06:00,921 - excel_formula_test - INFO -   Submitter Approver
2      John     John
2025-05-14 13:06:00,921 - excel_formula_test - INFO - 
Testing formula: Value > 100
2025-05-14 13:06:00,921 - qa_analytics - INFO - Parsed formula: Value > 100 -> (df['Value']>100)
2025-05-14 13:06:00,921 - excel_formula_test - INFO - Parsed: (df['Value']>100)
2025-05-14 13:06:00,921 - excel_formula_test - INFO - Fields: ['Value']
2025-05-14 13:06:00,921 - excel_formula_test - INFO - Results: 2 of 5 records pass (40.0%)
2025-05-14 13:06:00,921 - excel_formula_test - INFO - Expected: 3 records, Got: 2
2025-05-14 13:06:00,921 - excel_formula_test - INFO - Passing Examples:
2025-05-14 13:06:00,922 - excel_formula_test - INFO -    Value
1    200
3    500
2025-05-14 13:06:00,922 - excel_formula_test - INFO - Failing Examples:
2025-05-14 13:06:00,923 - excel_formula_test - INFO -    Value
0    100
2     50
2025-05-14 13:06:00,923 - excel_formula_test - INFO - 
Testing formula: `Submit Date` <= `TL Date`
2025-05-14 13:06:00,923 - qa_analytics - INFO - Parsed formula: __FIELD_1__ <= __FIELD_0__ -> (df['Submit Date']<=df['TL Date'])
2025-05-14 13:06:00,923 - excel_formula_test - INFO - Parsed: (df['Submit Date']<=df['TL Date'])
2025-05-14 13:06:00,923 - excel_formula_test - INFO - Fields: ['TL Date', 'Submit Date']
2025-05-14 13:06:00,923 - excel_formula_test - INFO - Results: 2 of 5 records pass (40.0%)
2025-05-14 13:06:00,923 - excel_formula_test - INFO - Expected: 3 records, Got: 2
2025-05-14 13:06:00,923 - excel_formula_test - INFO - Passing Examples:
2025-05-14 13:06:00,925 - excel_formula_test - INFO -      TL Date Submit Date
0 2025-01-05  2025-01-01
3 2025-05-01  2025-04-01
2025-05-14 13:06:00,925 - excel_formula_test - INFO - Failing Examples:
2025-05-14 13:06:00,926 - excel_formula_test - INFO -      TL Date Submit Date
1 2025-01-15  2025-02-01
2 2025-02-01  2025-03-01
2025-05-14 13:06:00,926 - excel_formula_test - INFO - 
Testing formula: Submitter <> Approver AND Value > 100
2025-05-14 13:06:00,926 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND Value > 100 -> (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 13:06:00,926 - excel_formula_test - INFO - Parsed: (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 13:06:00,926 - excel_formula_test - INFO - Fields: ['Submitter', 'Approver', 'Value']
2025-05-14 13:06:00,926 - excel_formula_test - INFO - Results: 2 of 5 records pass (40.0%)
2025-05-14 13:06:00,926 - excel_formula_test - INFO - Expected: 2 records, Got: 2
2025-05-14 13:06:00,926 - excel_formula_test - INFO - Passing Examples:
2025-05-14 13:06:00,927 - excel_formula_test - INFO -   Submitter Approver  Value
1      Mary     John    200
3       Bob  Charlie    500
2025-05-14 13:06:00,927 - excel_formula_test - INFO - Failing Examples:
2025-05-14 13:06:00,928 - excel_formula_test - INFO -   Submitter Approver  Value
0      John    Alice    100
2      John     John     50
2025-05-14 13:06:00,928 - excel_formula_test - INFO - 
Testing formula: Risk Level = "High"
2025-05-14 13:06:00,928 - qa_analytics - INFO - Parsed formula: Risk Level = "High" -> (df['Risk']df['Level']=="High")
2025-05-14 13:06:00,928 - excel_formula_test - INFO - Parsed: (df['Risk']df['Level']=="High")
2025-05-14 13:06:00,928 - excel_formula_test - INFO - Fields: ['Risk', 'Level']
2025-05-14 13:06:00,928 - qa_analytics - ERROR - Custom formula failed: invalid syntax. Perhaps you forgot a comma? (<string>, line 1), Formula: Risk Level = "High"
2025-05-14 13:06:00,929 - excel_formula_test - INFO - Results: 0 of 5 records pass (0.0%)
2025-05-14 13:06:00,929 - excel_formula_test - INFO - Expected: 1 records, Got: 0
2025-05-14 13:06:00,929 - excel_formula_test - INFO - Failing Examples:
2025-05-14 13:06:00,929 - excel_formula_test - ERROR - Error testing formula: "None of [Index(['Risk', 'Level'], dtype='object')] are in the [columns]"
2025-05-14 13:06:00,929 - excel_formula_test - INFO - 
Testing formula: Risk Level IN ("High", "Medium")
2025-05-14 13:06:00,929 - qa_analytics - INFO - Parsed formula: Risk Level IN ("High", "Medium") -> (df['Risk']df['Level']df['Level'].isin(["High", "Medium"]))
2025-05-14 13:06:00,929 - excel_formula_test - INFO - Parsed: (df['Risk']df['Level']df['Level'].isin(["High", "Medium"]))
2025-05-14 13:06:00,929 - excel_formula_test - INFO - Fields: ['Risk', 'Level']
2025-05-14 13:06:00,929 - qa_analytics - ERROR - Custom formula failed: invalid syntax. Perhaps you forgot a comma? (<string>, line 1), Formula: Risk Level IN ("High", "Medium")
2025-05-14 13:06:00,929 - excel_formula_test - INFO - Results: 0 of 5 records pass (0.0%)
2025-05-14 13:06:00,929 - excel_formula_test - INFO - Expected: 2 records, Got: 0
2025-05-14 13:06:00,929 - excel_formula_test - INFO - Failing Examples:
2025-05-14 13:06:00,931 - excel_formula_test - ERROR - Error testing formula: "None of [Index(['Risk', 'Level'], dtype='object')] are in the [columns]"
2025-05-14 13:06:00,931 - excel_formula_test - INFO - 
Testing formula: NOT ISBLANK(Value)
2025-05-14 13:06:00,931 - qa_analytics - INFO - Parsed formula: NOT ISBLANK(Value) -> (~pd.isna(df['Value']))
2025-05-14 13:06:00,931 - excel_formula_test - INFO - Parsed: (~pd.isna(df['Value']))
2025-05-14 13:06:00,931 - excel_formula_test - INFO - Fields: ['Value']
2025-05-14 13:06:00,931 - excel_formula_test - INFO - Results: 5 of 5 records pass (100.0%)
2025-05-14 13:06:00,931 - excel_formula_test - INFO - Expected: 5 records, Got: 5
2025-05-14 13:06:00,931 - excel_formula_test - INFO - Passing Examples:
2025-05-14 13:06:00,932 - excel_formula_test - INFO -    Value
0    100
1    200
2025-05-14 13:06:00,932 - excel_formula_test - INFO - 
=== CONFIGURATION EXAMPLE ===
2025-05-14 13:06:00,932 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND __FIELD_1__ <= __FIELD_0__ -> (df['Submitter']!=df['Approver']) & (df['Submit Date']<=df['TL Date'])
2025-05-14 13:06:00,932 - excel_formula_test - INFO - Sample YAML configuration with Excel formula:
2025-05-14 13:06:00,932 - excel_formula_test - INFO - 
analytic_id: 99
analytic_name: 'Custom Formula Demo'
analytic_description: 'Demonstrates Excel-style formula validation'

# Data source configuration
data_source:
  name: 'approval_workflow'
  required_fields:
    - 'Submitter'
    - 'Approver'
    - 'Submit Date'
    - 'TL Date'
    - 'Risk Level'
    - 'Value'

# Validations with custom formula
validations:
  - rule: custom_formula
    description: 'Submitter cannot approve their own work and approval sequence must be followed'
    parameters:
      original_formula: 'Submitter <> Approver AND `Submit Date` <= `TL Date`'
      
  # With the auto-parsing feature you added, just providing the original_formula is enough!
  # The formula will be parsed during validation.
  # For reference, the parser would generate:
  # formula: "(df['Submitter']!=df['Approver']) & (df['Submit Date']<=df['TL Date'])"
  
  - rule: segregation_of_duties
    description: 'Traditional segregation of duties validation for comparison'
    parameters:
      submitter_field: 'Submitter'
      approver_fields: ['Approver']

thresholds:
  error_percentage: 5.0
  rationale: 'Industry standard allows for up to 5% error rate.'

reporting:
  group_by: 'Approver'
  summary_fields: ['GC', 'PC', 'DNC', 'Total', 'DNC_Percentage']
  detail_required: True

2025-05-14 13:06:00,932 - excel_formula_test - INFO - 
Demo complete! The Excel Formula Enhancement is working correctly.
2025-05-14 13:06:00,932 - excel_formula_test - INFO - You can now use Excel-style formulas in your QA Analytics Framework.
2025-05-14 13:44:02,104 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND __FIELD_1__ <= __FIELD_0__ -> (df['Submitter']!=df['Approver']) & (df['Submit Date']<=df['TL Date'])
2025-05-14 13:46:27,693 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND __FIELD_1__ <= __FIELD_0__ -> (df['Submitter']!=df['Approver']) & (df['Submit Date']<=df['TL Date'])
2025-05-14 14:00:05,693 - excel_formula_test - INFO - EXCEL FORMULA ENHANCEMENT DEMO
2025-05-14 14:00:05,695 - excel_formula_test - INFO - ============================
2025-05-14 14:00:05,695 - excel_formula_test - INFO - === EXCEL FORMULA PARSER TESTS ===
2025-05-14 14:00:05,695 - qa_analytics - INFO - Parsed formula: Submitter = Approver -> (df['Submitter']==df['Approver'])
2025-05-14 14:00:05,697 - excel_formula_test - INFO -   Parsed: (df['Submitter']==df['Approver'])
2025-05-14 14:00:05,697 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver']
2025-05-14 14:00:05,697 - excel_formula_test - INFO - ---
2025-05-14 14:00:05,697 - qa_analytics - INFO - Parsed formula: Submitter <> Approver -> (df['Submitter']!=df['Approver'])
2025-05-14 14:00:05,698 - excel_formula_test - INFO -   Parsed: (df['Submitter']!=df['Approver'])
2025-05-14 14:00:05,698 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver']
2025-05-14 14:00:05,698 - excel_formula_test - INFO - ---
2025-05-14 14:00:05,698 - qa_analytics - INFO - Parsed formula: Value > 100 -> (df['Value']>100)
2025-05-14 14:00:05,699 - excel_formula_test - INFO -   Parsed: (df['Value']>100)
2025-05-14 14:00:05,699 - excel_formula_test - INFO -   Fields: ['Value']
2025-05-14 14:00:05,699 - excel_formula_test - INFO - ---
2025-05-14 14:00:05,699 - qa_analytics - INFO - Parsed formula: Value >= 100 -> (df['Value']>=100)
2025-05-14 14:00:05,699 - excel_formula_test - INFO -   Parsed: (df['Value']>=100)
2025-05-14 14:00:05,699 - excel_formula_test - INFO -   Fields: ['Value']
2025-05-14 14:00:05,699 - excel_formula_test - INFO - ---
2025-05-14 14:00:05,700 - qa_analytics - INFO - Parsed formula: Value < 200 -> (df['Value']<200)
2025-05-14 14:00:05,701 - excel_formula_test - INFO -   Parsed: (df['Value']<200)
2025-05-14 14:00:05,701 - excel_formula_test - INFO -   Fields: ['Value']
2025-05-14 14:00:05,702 - excel_formula_test - INFO - ---
2025-05-14 14:00:05,702 - qa_analytics - INFO - Parsed formula: Value <= 200 -> (df['Value']<=200)
2025-05-14 14:00:05,703 - excel_formula_test - INFO -   Parsed: (df['Value']<=200)
2025-05-14 14:00:05,703 - excel_formula_test - INFO -   Fields: ['Value']
2025-05-14 14:00:05,703 - excel_formula_test - INFO - ---
2025-05-14 14:00:05,703 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND Value > 100 -> (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 14:00:05,703 - excel_formula_test - INFO -   Parsed: (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 14:00:05,704 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver', 'Value']
2025-05-14 14:00:05,704 - excel_formula_test - INFO - ---
2025-05-14 14:00:05,704 - qa_analytics - INFO - Parsed formula: Submitter = Approver OR Value > 100 -> (df['Submitter']==df['Approver']) | (df['Value']>100)
2025-05-14 14:00:05,704 - excel_formula_test - INFO -   Parsed: (df['Submitter']==df['Approver']) | (df['Value']>100)
2025-05-14 14:00:05,704 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver', 'Value']
2025-05-14 14:00:05,704 - excel_formula_test - INFO - ---
2025-05-14 14:00:05,704 - qa_analytics - INFO - Parsed formula: NOT Complete -> (~df['Complete'])
2025-05-14 14:00:05,705 - excel_formula_test - INFO -   Parsed: (~df['Complete'])
2025-05-14 14:00:05,705 - excel_formula_test - INFO -   Fields: ['Complete']
2025-05-14 14:00:05,705 - excel_formula_test - INFO - ---
2025-05-14 14:00:05,705 - qa_analytics - INFO - Parsed formula: (Submitter <> Approver) AND (Value > 100) -> (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 14:00:05,706 - excel_formula_test - INFO -   Parsed: (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 14:00:05,706 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver', 'Value']
2025-05-14 14:00:05,706 - excel_formula_test - INFO - ---
2025-05-14 14:00:05,706 - qa_analytics - INFO - Parsed formula: __FIELD_1__ <= __FIELD_0__ -> (df['Submit Date']<=df['TL Date'])
2025-05-14 14:00:05,707 - excel_formula_test - INFO -   Parsed: (df['Submit Date']<=df['TL Date'])
2025-05-14 14:00:05,707 - excel_formula_test - INFO -   Fields: ['TL Date', 'Submit Date', '__FIELD_1__', '__FIELD_0__']
2025-05-14 14:00:05,707 - excel_formula_test - INFO - ---
2025-05-14 14:00:05,707 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND __FIELD_1__ <= __FIELD_0__ AND Value > 100 -> (df['Submitter']!=df['Approver']) & (df['Submit Date']<=df['TL Date']) & (df['Value']>100)
2025-05-14 14:00:05,707 - excel_formula_test - INFO -   Parsed: (df['Submitter']!=df['Approver']) & (df['Submit Date']<=df['TL Date']) & (df['Value']>100)
2025-05-14 14:00:05,707 - excel_formula_test - INFO -   Fields: ['TL Date', 'Submit Date', 'Submitter', 'Approver', '__FIELD_1__', '__FIELD_0__', 'Value']
2025-05-14 14:00:05,707 - excel_formula_test - INFO - ---
2025-05-14 14:00:05,707 - qa_analytics - INFO - Parsed formula: ISBLANK(Approver) -> (pd.isna(df['Approver']))
2025-05-14 14:00:05,708 - excel_formula_test - INFO -   Parsed: (pd.isna(df['Approver']))
2025-05-14 14:00:05,708 - excel_formula_test - INFO -   Fields: ['Approver']
2025-05-14 14:00:05,708 - excel_formula_test - INFO - ---
2025-05-14 14:00:05,708 - qa_analytics - INFO - Parsed formula: NOT ISBLANK(Approver) -> (~pd.isna(df['Approver']))
2025-05-14 14:00:05,709 - excel_formula_test - INFO -   Parsed: (~pd.isna(df['Approver']))
2025-05-14 14:00:05,709 - excel_formula_test - INFO -   Fields: ['Approver']
2025-05-14 14:00:05,709 - excel_formula_test - INFO - ---
2025-05-14 14:00:05,709 - qa_analytics - INFO - Parsed formula: Risk Level IN ("High", "Medium") -> (df['Risk']df['Level']df['Level'].isin(["High", "Medium"]))
2025-05-14 14:00:05,709 - excel_formula_test - INFO -   Parsed: (df['Risk']df['Level']df['Level'].isin(["High", "Medium"]))
2025-05-14 14:00:05,710 - excel_formula_test - INFO -   Fields: ['Risk', 'Level']
2025-05-14 14:00:05,710 - excel_formula_test - INFO - ---
2025-05-14 14:00:05,710 - excel_formula_test - INFO - 
=== FORMULA VALIDATION TESTS ===
2025-05-14 14:00:05,715 - excel_formula_test - INFO - Test data created with 5 records
2025-05-14 14:00:05,715 - excel_formula_test - INFO - 
Testing formula: Submitter <> Approver
2025-05-14 14:00:05,715 - qa_analytics - INFO - Parsed formula: Submitter <> Approver -> (df['Submitter']!=df['Approver'])
2025-05-14 14:00:05,715 - excel_formula_test - INFO - Parsed: (df['Submitter']!=df['Approver'])
2025-05-14 14:00:05,715 - excel_formula_test - INFO - Fields: ['Submitter', 'Approver']
2025-05-14 14:00:05,717 - excel_formula_test - INFO - Results: 4 of 5 records pass (80.0%)
2025-05-14 14:00:05,717 - excel_formula_test - INFO - Expected: 3 records, Got: 4
2025-05-14 14:00:05,718 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:00:05,723 - excel_formula_test - INFO -   Submitter Approver
0      John    Alice
1      Mary     John
2025-05-14 14:00:05,723 - excel_formula_test - INFO - Failing Examples:
2025-05-14 14:00:05,724 - excel_formula_test - INFO -   Submitter Approver
2      John     John
2025-05-14 14:00:05,724 - excel_formula_test - INFO - 
Testing formula: Value > 100
2025-05-14 14:00:05,724 - qa_analytics - INFO - Parsed formula: Value > 100 -> (df['Value']>100)
2025-05-14 14:00:05,725 - excel_formula_test - INFO - Parsed: (df['Value']>100)
2025-05-14 14:00:05,725 - excel_formula_test - INFO - Fields: ['Value']
2025-05-14 14:00:05,725 - excel_formula_test - INFO - Results: 2 of 5 records pass (40.0%)
2025-05-14 14:00:05,725 - excel_formula_test - INFO - Expected: 3 records, Got: 2
2025-05-14 14:00:05,725 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:00:05,726 - excel_formula_test - INFO -    Value
1    200
3    500
2025-05-14 14:00:05,726 - excel_formula_test - INFO - Failing Examples:
2025-05-14 14:00:05,726 - excel_formula_test - INFO -    Value
0    100
2     50
2025-05-14 14:00:05,727 - excel_formula_test - INFO - 
Testing formula: `Submit Date` <= `TL Date`
2025-05-14 14:00:05,727 - qa_analytics - INFO - Parsed formula: __FIELD_1__ <= __FIELD_0__ -> (df['Submit Date']<=df['TL Date'])
2025-05-14 14:00:05,727 - excel_formula_test - INFO - Parsed: (df['Submit Date']<=df['TL Date'])
2025-05-14 14:00:05,727 - excel_formula_test - INFO - Fields: ['TL Date', 'Submit Date', '__FIELD_1__', '__FIELD_0__']
2025-05-14 14:00:05,727 - excel_formula_test - INFO - Results: 2 of 5 records pass (40.0%)
2025-05-14 14:00:05,727 - excel_formula_test - INFO - Expected: 3 records, Got: 2
2025-05-14 14:00:05,727 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:00:05,727 - excel_formula_test - ERROR - Error testing formula: "['__FIELD_1__', '__FIELD_0__'] not in index"
2025-05-14 14:00:05,727 - excel_formula_test - INFO - 
Testing formula: Submitter <> Approver AND Value > 100
2025-05-14 14:00:05,727 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND Value > 100 -> (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 14:00:05,727 - excel_formula_test - INFO - Parsed: (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 14:00:05,727 - excel_formula_test - INFO - Fields: ['Submitter', 'Approver', 'Value']
2025-05-14 14:00:05,727 - excel_formula_test - INFO - Results: 2 of 5 records pass (40.0%)
2025-05-14 14:00:05,728 - excel_formula_test - INFO - Expected: 2 records, Got: 2
2025-05-14 14:00:05,728 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:00:05,728 - excel_formula_test - INFO -   Submitter Approver  Value
1      Mary     John    200
3       Bob  Charlie    500
2025-05-14 14:00:05,728 - excel_formula_test - INFO - Failing Examples:
2025-05-14 14:00:05,729 - excel_formula_test - INFO -   Submitter Approver  Value
0      John    Alice    100
2      John     John     50
2025-05-14 14:00:05,729 - excel_formula_test - INFO - 
Testing formula: Risk Level = "High"
2025-05-14 14:00:05,729 - qa_analytics - INFO - Parsed formula: Risk Level = "High" -> (df['Risk']df['Level']=="High")
2025-05-14 14:00:05,730 - excel_formula_test - INFO - Parsed: (df['Risk']df['Level']=="High")
2025-05-14 14:00:05,730 - excel_formula_test - INFO - Fields: ['Risk', 'Level']
2025-05-14 14:00:05,730 - qa_analytics - ERROR - Custom formula failed: invalid syntax. Perhaps you forgot a comma? (<string>, line 1), Formula: Risk Level = "High"
2025-05-14 14:00:05,730 - excel_formula_test - INFO - Results: 0 of 5 records pass (0.0%)
2025-05-14 14:00:05,730 - excel_formula_test - INFO - Expected: 1 records, Got: 0
2025-05-14 14:00:05,730 - excel_formula_test - INFO - Failing Examples:
2025-05-14 14:00:05,730 - excel_formula_test - ERROR - Error testing formula: "None of [Index(['Risk', 'Level'], dtype='object')] are in the [columns]"
2025-05-14 14:00:05,730 - excel_formula_test - INFO - 
Testing formula: Risk Level IN ("High", "Medium")
2025-05-14 14:00:05,731 - qa_analytics - INFO - Parsed formula: Risk Level IN ("High", "Medium") -> (df['Risk']df['Level']df['Level'].isin(["High", "Medium"]))
2025-05-14 14:00:05,731 - excel_formula_test - INFO - Parsed: (df['Risk']df['Level']df['Level'].isin(["High", "Medium"]))
2025-05-14 14:00:05,731 - excel_formula_test - INFO - Fields: ['Risk', 'Level']
2025-05-14 14:00:05,731 - qa_analytics - ERROR - Custom formula failed: invalid syntax. Perhaps you forgot a comma? (<string>, line 1), Formula: Risk Level IN ("High", "Medium")
2025-05-14 14:00:05,731 - excel_formula_test - INFO - Results: 0 of 5 records pass (0.0%)
2025-05-14 14:00:05,731 - excel_formula_test - INFO - Expected: 2 records, Got: 0
2025-05-14 14:00:05,731 - excel_formula_test - INFO - Failing Examples:
2025-05-14 14:00:05,732 - excel_formula_test - ERROR - Error testing formula: "None of [Index(['Risk', 'Level'], dtype='object')] are in the [columns]"
2025-05-14 14:00:05,732 - excel_formula_test - INFO - 
Testing formula: NOT ISBLANK(Value)
2025-05-14 14:00:05,732 - qa_analytics - INFO - Parsed formula: NOT ISBLANK(Value) -> (~pd.isna(df['Value']))
2025-05-14 14:00:05,732 - excel_formula_test - INFO - Parsed: (~pd.isna(df['Value']))
2025-05-14 14:00:05,732 - excel_formula_test - INFO - Fields: ['Value']
2025-05-14 14:00:05,732 - excel_formula_test - INFO - Results: 5 of 5 records pass (100.0%)
2025-05-14 14:00:05,732 - excel_formula_test - INFO - Expected: 5 records, Got: 5
2025-05-14 14:00:05,733 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:00:05,733 - excel_formula_test - INFO -    Value
0    100
1    200
2025-05-14 14:00:05,734 - excel_formula_test - INFO - 
=== CONFIGURATION EXAMPLE ===
2025-05-14 14:00:05,734 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND __FIELD_1__ <= __FIELD_0__ -> (df['Submitter']!=df['Approver']) & (df['Submit Date']<=df['TL Date'])
2025-05-14 14:00:05,734 - excel_formula_test - INFO - Sample YAML configuration with Excel formula:
2025-05-14 14:00:05,734 - excel_formula_test - INFO - 
analytic_id: 99
analytic_name: 'Custom Formula Demo'
analytic_description: 'Demonstrates Excel-style formula validation'

# Data source configuration
data_source:
  name: 'approval_workflow'
  required_fields:
    - 'Submitter'
    - 'Approver'
    - 'Submit Date'
    - 'TL Date'
    - 'Risk Level'
    - 'Value'

# Validations with custom formula
validations:
  - rule: custom_formula
    description: 'Submitter cannot approve their own work and approval sequence must be followed'
    parameters:
      original_formula: 'Submitter <> Approver AND `Submit Date` <= `TL Date`'
      
  # With the auto-parsing feature you added, just providing the original_formula is enough!
  # The formula will be parsed during validation.
  # For reference, the parser would generate:
  # formula: "(df['Submitter']!=df['Approver']) & (df['Submit Date']<=df['TL Date'])"
  
  - rule: segregation_of_duties
    description: 'Traditional segregation of duties validation for comparison'
    parameters:
      submitter_field: 'Submitter'
      approver_fields: ['Approver']

thresholds:
  error_percentage: 5.0
  rationale: 'Industry standard allows for up to 5% error rate.'

reporting:
  group_by: 'Approver'
  summary_fields: ['GC', 'PC', 'DNC', 'Total', 'DNC_Percentage']
  detail_required: True

2025-05-14 14:00:05,734 - excel_formula_test - INFO - 
Demo complete! The Excel Formula Enhancement is working correctly.
2025-05-14 14:00:05,734 - excel_formula_test - INFO - You can now use Excel-style formulas in your QA Analytics Framework.
2025-05-14 14:21:22,645 - excel_formula_test - INFO - EXCEL FORMULA ENHANCEMENT DEMO
2025-05-14 14:21:22,645 - excel_formula_test - INFO - ============================
2025-05-14 14:21:22,645 - excel_formula_test - INFO - === EXCEL FORMULA PARSER TESTS ===
2025-05-14 14:21:22,645 - qa_analytics - INFO - Parsed formula: Submitter = Approver -> (df['Submitter']==df['Approver'])
2025-05-14 14:21:22,647 - excel_formula_test - INFO -   Parsed: (df['Submitter']==df['Approver'])
2025-05-14 14:21:22,647 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver']
2025-05-14 14:21:22,647 - excel_formula_test - INFO - ---
2025-05-14 14:21:22,647 - qa_analytics - INFO - Parsed formula: Submitter <> Approver -> (df['Submitter']!=df['Approver'])
2025-05-14 14:21:22,648 - excel_formula_test - INFO -   Parsed: (df['Submitter']!=df['Approver'])
2025-05-14 14:21:22,648 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver']
2025-05-14 14:21:22,648 - excel_formula_test - INFO - ---
2025-05-14 14:21:22,648 - qa_analytics - INFO - Parsed formula: Value > 100 -> (df['Value']>100)
2025-05-14 14:21:22,649 - excel_formula_test - INFO -   Parsed: (df['Value']>100)
2025-05-14 14:21:22,649 - excel_formula_test - INFO -   Fields: ['Value']
2025-05-14 14:21:22,649 - excel_formula_test - INFO - ---
2025-05-14 14:21:22,649 - qa_analytics - INFO - Parsed formula: Value >= 100 -> (df['Value']>=100)
2025-05-14 14:21:22,650 - excel_formula_test - INFO -   Parsed: (df['Value']>=100)
2025-05-14 14:21:22,650 - excel_formula_test - INFO -   Fields: ['Value']
2025-05-14 14:21:22,650 - excel_formula_test - INFO - ---
2025-05-14 14:21:22,650 - qa_analytics - INFO - Parsed formula: Value < 200 -> (df['Value']<200)
2025-05-14 14:21:22,650 - excel_formula_test - INFO -   Parsed: (df['Value']<200)
2025-05-14 14:21:22,650 - excel_formula_test - INFO -   Fields: ['Value']
2025-05-14 14:21:22,651 - excel_formula_test - INFO - ---
2025-05-14 14:21:22,651 - qa_analytics - INFO - Parsed formula: Value <= 200 -> (df['Value']<=200)
2025-05-14 14:21:22,651 - excel_formula_test - INFO -   Parsed: (df['Value']<=200)
2025-05-14 14:21:22,651 - excel_formula_test - INFO -   Fields: ['Value']
2025-05-14 14:21:22,651 - excel_formula_test - INFO - ---
2025-05-14 14:21:22,651 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND Value > 100 -> (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 14:21:22,652 - excel_formula_test - INFO -   Parsed: (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 14:21:22,652 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver', 'Value']
2025-05-14 14:21:22,652 - excel_formula_test - INFO - ---
2025-05-14 14:21:22,652 - qa_analytics - INFO - Parsed formula: Submitter = Approver OR Value > 100 -> (df['Submitter']==df['Approver']) | (df['Value']>100)
2025-05-14 14:21:22,653 - excel_formula_test - INFO -   Parsed: (df['Submitter']==df['Approver']) | (df['Value']>100)
2025-05-14 14:21:22,653 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver', 'Value']
2025-05-14 14:21:22,653 - excel_formula_test - INFO - ---
2025-05-14 14:21:22,653 - qa_analytics - INFO - Parsed formula: NOT Complete -> (~df['Complete'])
2025-05-14 14:21:22,654 - excel_formula_test - INFO -   Parsed: (~df['Complete'])
2025-05-14 14:21:22,654 - excel_formula_test - INFO -   Fields: ['Complete']
2025-05-14 14:21:22,654 - excel_formula_test - INFO - ---
2025-05-14 14:21:22,654 - qa_analytics - INFO - Parsed formula: (Submitter <> Approver) AND (Value > 100) -> (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 14:21:22,655 - excel_formula_test - INFO -   Parsed: (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 14:21:22,655 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver', 'Value']
2025-05-14 14:21:22,655 - excel_formula_test - INFO - ---
2025-05-14 14:21:22,655 - qa_analytics - INFO - Parsed formula: __FIELD_1__ <= __FIELD_0__ -> (df['Submit Date']<=df['TL Date'])
2025-05-14 14:21:22,655 - excel_formula_test - INFO -   Parsed: (df['Submit Date']<=df['TL Date'])
2025-05-14 14:21:22,656 - excel_formula_test - INFO -   Fields: ['TL Date', 'Submit Date', '__FIELD_1__', '__FIELD_0__']
2025-05-14 14:21:22,656 - excel_formula_test - INFO - ---
2025-05-14 14:21:22,656 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND __FIELD_1__ <= __FIELD_0__ AND Value > 100 -> (df['Submitter']!=df['Approver']) & (df['Submit Date']<=df['TL Date']) & (df['Value']>100)
2025-05-14 14:21:22,657 - excel_formula_test - INFO -   Parsed: (df['Submitter']!=df['Approver']) & (df['Submit Date']<=df['TL Date']) & (df['Value']>100)
2025-05-14 14:21:22,657 - excel_formula_test - INFO -   Fields: ['TL Date', 'Submit Date', 'Submitter', 'Approver', '__FIELD_1__', '__FIELD_0__', 'Value']
2025-05-14 14:21:22,657 - excel_formula_test - INFO - ---
2025-05-14 14:21:22,657 - qa_analytics - INFO - Parsed formula: ISBLANK(Approver) -> (pd.isna(df['Approver']))
2025-05-14 14:21:22,658 - excel_formula_test - INFO -   Parsed: (pd.isna(df['Approver']))
2025-05-14 14:21:22,658 - excel_formula_test - INFO -   Fields: ['Approver']
2025-05-14 14:21:22,658 - excel_formula_test - INFO - ---
2025-05-14 14:21:22,658 - qa_analytics - INFO - Parsed formula: NOT ISBLANK(Approver) -> (~pd.isna(df['Approver']))
2025-05-14 14:21:22,658 - excel_formula_test - INFO -   Parsed: (~pd.isna(df['Approver']))
2025-05-14 14:21:22,658 - excel_formula_test - INFO -   Fields: ['Approver']
2025-05-14 14:21:22,658 - excel_formula_test - INFO - ---
2025-05-14 14:21:22,658 - qa_analytics - INFO - Parsed formula: Risk Level IN ("High", "Medium") -> (df['Risk Level']df['Risk Level'].isin(["High", "Medium"]))
2025-05-14 14:21:22,659 - excel_formula_test - INFO -   Parsed: (df['Risk Level']df['Risk Level'].isin(["High", "Medium"]))
2025-05-14 14:21:22,659 - excel_formula_test - INFO -   Fields: ['Risk Level']
2025-05-14 14:21:22,659 - excel_formula_test - INFO - ---
2025-05-14 14:21:22,659 - excel_formula_test - INFO - 
=== FORMULA VALIDATION TESTS ===
2025-05-14 14:21:22,661 - excel_formula_test - INFO - Test data created with 5 records
2025-05-14 14:21:22,661 - excel_formula_test - INFO - 
Testing formula: Submitter <> Approver
2025-05-14 14:21:22,661 - qa_analytics - INFO - Parsed formula: Submitter <> Approver -> (df['Submitter']!=df['Approver'])
2025-05-14 14:21:22,661 - excel_formula_test - INFO - Parsed: (df['Submitter']!=df['Approver'])
2025-05-14 14:21:22,661 - excel_formula_test - INFO - Fields: ['Submitter', 'Approver']
2025-05-14 14:21:22,661 - excel_formula_test - INFO - Results: 4 of 5 records pass (80.0%)
2025-05-14 14:21:22,662 - excel_formula_test - INFO - Expected: 3 records, Got: 4
2025-05-14 14:21:22,662 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:21:22,664 - excel_formula_test - INFO -   Submitter Approver
0      John    Alice
1      Mary     John
2025-05-14 14:21:22,664 - excel_formula_test - INFO - Failing Examples:
2025-05-14 14:21:22,665 - excel_formula_test - INFO -   Submitter Approver
2      John     John
2025-05-14 14:21:22,665 - excel_formula_test - INFO - 
Testing formula: Value > 100
2025-05-14 14:21:22,665 - qa_analytics - INFO - Parsed formula: Value > 100 -> (df['Value']>100)
2025-05-14 14:21:22,665 - excel_formula_test - INFO - Parsed: (df['Value']>100)
2025-05-14 14:21:22,665 - excel_formula_test - INFO - Fields: ['Value']
2025-05-14 14:21:22,665 - excel_formula_test - INFO - Results: 2 of 5 records pass (40.0%)
2025-05-14 14:21:22,665 - excel_formula_test - INFO - Expected: 3 records, Got: 2
2025-05-14 14:21:22,665 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:21:22,666 - excel_formula_test - INFO -    Value
1    200
3    500
2025-05-14 14:21:22,666 - excel_formula_test - INFO - Failing Examples:
2025-05-14 14:21:22,667 - excel_formula_test - INFO -    Value
0    100
2     50
2025-05-14 14:21:22,667 - excel_formula_test - INFO - 
Testing formula: `Submit Date` <= `TL Date`
2025-05-14 14:21:22,667 - qa_analytics - INFO - Parsed formula: __FIELD_1__ <= __FIELD_0__ -> (df['Submit Date']<=df['TL Date'])
2025-05-14 14:21:22,667 - excel_formula_test - INFO - Parsed: (df['Submit Date']<=df['TL Date'])
2025-05-14 14:21:22,667 - excel_formula_test - INFO - Fields: ['TL Date', 'Submit Date', '__FIELD_1__', '__FIELD_0__']
2025-05-14 14:21:22,667 - excel_formula_test - INFO - Results: 2 of 5 records pass (40.0%)
2025-05-14 14:21:22,667 - excel_formula_test - INFO - Expected: 3 records, Got: 2
2025-05-14 14:21:22,667 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:21:22,668 - excel_formula_test - ERROR - Error testing formula: "['__FIELD_1__', '__FIELD_0__'] not in index"
2025-05-14 14:21:22,668 - excel_formula_test - INFO - 
Testing formula: Submitter <> Approver AND Value > 100
2025-05-14 14:21:22,668 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND Value > 100 -> (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 14:21:22,668 - excel_formula_test - INFO - Parsed: (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 14:21:22,668 - excel_formula_test - INFO - Fields: ['Submitter', 'Approver', 'Value']
2025-05-14 14:21:22,668 - excel_formula_test - INFO - Results: 2 of 5 records pass (40.0%)
2025-05-14 14:21:22,668 - excel_formula_test - INFO - Expected: 2 records, Got: 2
2025-05-14 14:21:22,668 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:21:22,669 - excel_formula_test - INFO -   Submitter Approver  Value
1      Mary     John    200
3       Bob  Charlie    500
2025-05-14 14:21:22,669 - excel_formula_test - INFO - Failing Examples:
2025-05-14 14:21:22,670 - excel_formula_test - INFO -   Submitter Approver  Value
0      John    Alice    100
2      John     John     50
2025-05-14 14:21:22,670 - excel_formula_test - INFO - 
Testing formula: Risk Level = "High"
2025-05-14 14:21:22,670 - qa_analytics - INFO - Parsed formula: Risk Level = "High" -> (df['Risk Level']=="High")
2025-05-14 14:21:22,670 - excel_formula_test - INFO - Parsed: (df['Risk Level']=="High")
2025-05-14 14:21:22,670 - excel_formula_test - INFO - Fields: ['Risk Level']
2025-05-14 14:21:22,671 - excel_formula_test - INFO - Results: 1 of 5 records pass (20.0%)
2025-05-14 14:21:22,671 - excel_formula_test - INFO - Expected: 1 records, Got: 1
2025-05-14 14:21:22,671 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:21:22,672 - excel_formula_test - INFO -   Risk Level
0       High
2025-05-14 14:21:22,672 - excel_formula_test - INFO - Failing Examples:
2025-05-14 14:21:22,672 - excel_formula_test - INFO -   Risk Level
1     Medium
2        Low
2025-05-14 14:21:22,673 - excel_formula_test - INFO - 
Testing formula: Risk Level IN ("High", "Medium")
2025-05-14 14:21:22,673 - qa_analytics - INFO - Parsed formula: Risk Level IN ("High", "Medium") -> (df['Risk Level']df['Risk Level'].isin(["High", "Medium"]))
2025-05-14 14:21:22,673 - excel_formula_test - INFO - Parsed: (df['Risk Level']df['Risk Level'].isin(["High", "Medium"]))
2025-05-14 14:21:22,673 - excel_formula_test - INFO - Fields: ['Risk Level']
2025-05-14 14:21:22,673 - qa_analytics - ERROR - Custom formula failed: invalid syntax. Perhaps you forgot a comma? (<string>, line 1), Formula: Risk Level IN ("High", "Medium")
2025-05-14 14:21:22,673 - excel_formula_test - INFO - Results: 0 of 5 records pass (0.0%)
2025-05-14 14:21:22,673 - excel_formula_test - INFO - Expected: 2 records, Got: 0
2025-05-14 14:21:22,673 - excel_formula_test - INFO - Failing Examples:
2025-05-14 14:21:22,674 - excel_formula_test - INFO -   Risk Level
0       High
1     Medium
2025-05-14 14:21:22,674 - excel_formula_test - INFO - 
Testing formula: NOT ISBLANK(Value)
2025-05-14 14:21:22,674 - qa_analytics - INFO - Parsed formula: NOT ISBLANK(Value) -> (~pd.isna(df['Value']))
2025-05-14 14:21:22,674 - excel_formula_test - INFO - Parsed: (~pd.isna(df['Value']))
2025-05-14 14:21:22,674 - excel_formula_test - INFO - Fields: ['Value']
2025-05-14 14:21:22,675 - excel_formula_test - INFO - Results: 5 of 5 records pass (100.0%)
2025-05-14 14:21:22,675 - excel_formula_test - INFO - Expected: 5 records, Got: 5
2025-05-14 14:21:22,675 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:21:22,675 - excel_formula_test - INFO -    Value
0    100
1    200
2025-05-14 14:21:22,675 - excel_formula_test - INFO - 
=== CONFIGURATION EXAMPLE ===
2025-05-14 14:21:22,675 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND __FIELD_1__ <= __FIELD_0__ -> (df['Submitter']!=df['Approver']) & (df['Submit Date']<=df['TL Date'])
2025-05-14 14:21:22,675 - excel_formula_test - INFO - Sample YAML configuration with Excel formula:
2025-05-14 14:21:22,675 - excel_formula_test - INFO - 
analytic_id: 99
analytic_name: 'Custom Formula Demo'
analytic_description: 'Demonstrates Excel-style formula validation'

# Data source configuration
data_source:
  name: 'approval_workflow'
  required_fields:
    - 'Submitter'
    - 'Approver'
    - 'Submit Date'
    - 'TL Date'
    - 'Risk Level'
    - 'Value'

# Validations with custom formula
validations:
  - rule: custom_formula
    description: 'Submitter cannot approve their own work and approval sequence must be followed'
    parameters:
      original_formula: 'Submitter <> Approver AND `Submit Date` <= `TL Date`'
      
  # With the auto-parsing feature you added, just providing the original_formula is enough!
  # The formula will be parsed during validation.
  # For reference, the parser would generate:
  # formula: "(df['Submitter']!=df['Approver']) & (df['Submit Date']<=df['TL Date'])"
  
  - rule: segregation_of_duties
    description: 'Traditional segregation of duties validation for comparison'
    parameters:
      submitter_field: 'Submitter'
      approver_fields: ['Approver']

thresholds:
  error_percentage: 5.0
  rationale: 'Industry standard allows for up to 5% error rate.'

reporting:
  group_by: 'Approver'
  summary_fields: ['GC', 'PC', 'DNC', 'Total', 'DNC_Percentage']
  detail_required: True

2025-05-14 14:21:22,676 - excel_formula_test - INFO - 
Demo complete! The Excel Formula Enhancement is working correctly.
2025-05-14 14:21:22,676 - excel_formula_test - INFO - You can now use Excel-style formulas in your QA Analytics Framework.
2025-05-14 14:27:38,935 - qa_analytics - INFO - Parsed formula: IF(Risk_Level="High", Days_Open<=30, Days_Open<=90) -> (np.where(df['Risk_Level']=="High", df['Days_Open']<=30, df['Days_Open']<=90))
2025-05-14 14:27:38,936 - qa_analytics - INFO - Parsed formula: IF(Risk_Level="High", Days_Open<=30, Days_Open<=90) -> (np.where(df['Risk_Level']=="High", df['Days_Open']<=30, df['Days_Open']<=90))
2025-05-14 14:27:58,729 - excel_formula_test - INFO - EXCEL FORMULA ENHANCEMENT DEMO
2025-05-14 14:27:58,729 - excel_formula_test - INFO - ============================
2025-05-14 14:27:58,729 - excel_formula_test - INFO - === EXCEL FORMULA PARSER TESTS ===
2025-05-14 14:27:58,729 - qa_analytics - INFO - Parsed formula: Submitter = Approver -> (df['Submitter']==df['Approver'])
2025-05-14 14:27:58,731 - excel_formula_test - INFO -   Parsed: (df['Submitter']==df['Approver'])
2025-05-14 14:27:58,731 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver']
2025-05-14 14:27:58,731 - excel_formula_test - INFO - ---
2025-05-14 14:27:58,731 - qa_analytics - INFO - Parsed formula: Submitter <> Approver -> (df['Submitter']!=df['Approver'])
2025-05-14 14:27:58,732 - excel_formula_test - INFO -   Parsed: (df['Submitter']!=df['Approver'])
2025-05-14 14:27:58,732 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver']
2025-05-14 14:27:58,732 - excel_formula_test - INFO - ---
2025-05-14 14:27:58,732 - qa_analytics - INFO - Parsed formula: Value > 100 -> (df['Value']>100)
2025-05-14 14:27:58,733 - excel_formula_test - INFO -   Parsed: (df['Value']>100)
2025-05-14 14:27:58,733 - excel_formula_test - INFO -   Fields: ['Value']
2025-05-14 14:27:58,733 - excel_formula_test - INFO - ---
2025-05-14 14:27:58,734 - qa_analytics - INFO - Parsed formula: Value >= 100 -> (df['Value']>=100)
2025-05-14 14:27:58,734 - excel_formula_test - INFO -   Parsed: (df['Value']>=100)
2025-05-14 14:27:58,734 - excel_formula_test - INFO -   Fields: ['Value']
2025-05-14 14:27:58,735 - excel_formula_test - INFO - ---
2025-05-14 14:27:58,735 - qa_analytics - INFO - Parsed formula: Value < 200 -> (df['Value']<200)
2025-05-14 14:27:58,735 - excel_formula_test - INFO -   Parsed: (df['Value']<200)
2025-05-14 14:27:58,735 - excel_formula_test - INFO -   Fields: ['Value']
2025-05-14 14:27:58,735 - excel_formula_test - INFO - ---
2025-05-14 14:27:58,735 - qa_analytics - INFO - Parsed formula: Value <= 200 -> (df['Value']<=200)
2025-05-14 14:27:58,736 - excel_formula_test - INFO -   Parsed: (df['Value']<=200)
2025-05-14 14:27:58,736 - excel_formula_test - INFO -   Fields: ['Value']
2025-05-14 14:27:58,736 - excel_formula_test - INFO - ---
2025-05-14 14:27:58,736 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND Value > 100 -> (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 14:27:58,737 - excel_formula_test - INFO -   Parsed: (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 14:27:58,737 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver', 'Value']
2025-05-14 14:27:58,737 - excel_formula_test - INFO - ---
2025-05-14 14:27:58,737 - qa_analytics - INFO - Parsed formula: Submitter = Approver OR Value > 100 -> (df['Submitter']==df['Approver']) | (df['Value']>100)
2025-05-14 14:27:58,738 - excel_formula_test - INFO -   Parsed: (df['Submitter']==df['Approver']) | (df['Value']>100)
2025-05-14 14:27:58,738 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver', 'Value']
2025-05-14 14:27:58,738 - excel_formula_test - INFO - ---
2025-05-14 14:27:58,738 - qa_analytics - INFO - Parsed formula: NOT Complete -> (~df['Complete'])
2025-05-14 14:27:58,739 - excel_formula_test - INFO -   Parsed: (~df['Complete'])
2025-05-14 14:27:58,739 - excel_formula_test - INFO -   Fields: ['Complete']
2025-05-14 14:27:58,739 - excel_formula_test - INFO - ---
2025-05-14 14:27:58,739 - qa_analytics - INFO - Parsed formula: (Submitter <> Approver) AND (Value > 100) -> (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 14:27:58,740 - excel_formula_test - INFO -   Parsed: (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 14:27:58,740 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver', 'Value']
2025-05-14 14:27:58,740 - excel_formula_test - INFO - ---
2025-05-14 14:27:58,740 - qa_analytics - INFO - Parsed formula: __FIELD_1__ <= __FIELD_0__ -> (df['Submit Date']<=df['TL Date'])
2025-05-14 14:27:58,741 - excel_formula_test - INFO -   Parsed: (df['Submit Date']<=df['TL Date'])
2025-05-14 14:27:58,741 - excel_formula_test - INFO -   Fields: ['TL Date', 'Submit Date']
2025-05-14 14:27:58,741 - excel_formula_test - INFO - ---
2025-05-14 14:27:58,741 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND __FIELD_1__ <= __FIELD_0__ AND Value > 100 -> (df['Submitter']!=df['Approver']) & (df['Submit Date']<=df['TL Date']) & (df['Value']>100)
2025-05-14 14:27:58,742 - excel_formula_test - INFO -   Parsed: (df['Submitter']!=df['Approver']) & (df['Submit Date']<=df['TL Date']) & (df['Value']>100)
2025-05-14 14:27:58,742 - excel_formula_test - INFO -   Fields: ['TL Date', 'Submit Date', 'Submitter', 'Approver', 'Value']
2025-05-14 14:27:58,742 - excel_formula_test - INFO - ---
2025-05-14 14:27:58,742 - qa_analytics - INFO - Parsed formula: ISBLANK(Approver) -> (pd.isna(df['Approver']))
2025-05-14 14:27:58,743 - excel_formula_test - INFO -   Parsed: (pd.isna(df['Approver']))
2025-05-14 14:27:58,743 - excel_formula_test - INFO -   Fields: ['Approver']
2025-05-14 14:27:58,743 - excel_formula_test - INFO - ---
2025-05-14 14:27:58,743 - qa_analytics - INFO - Parsed formula: NOT ISBLANK(Approver) -> (~pd.isna(df['Approver']))
2025-05-14 14:27:58,744 - excel_formula_test - INFO -   Parsed: (~pd.isna(df['Approver']))
2025-05-14 14:27:58,744 - excel_formula_test - INFO -   Fields: ['Approver']
2025-05-14 14:27:58,744 - excel_formula_test - INFO - ---
2025-05-14 14:27:58,744 - qa_analytics - INFO - Parsed formula: Risk Level IN ("High", "Medium") -> (df['Risk Level']df['Risk Level'].isin(["High", "Medium"]))
2025-05-14 14:27:58,745 - excel_formula_test - INFO -   Parsed: (df['Risk Level']df['Risk Level'].isin(["High", "Medium"]))
2025-05-14 14:27:58,745 - excel_formula_test - INFO -   Fields: ['Risk Level']
2025-05-14 14:27:58,745 - excel_formula_test - INFO - ---
2025-05-14 14:27:58,745 - excel_formula_test - INFO - 
=== FORMULA VALIDATION TESTS ===
2025-05-14 14:27:58,747 - excel_formula_test - INFO - Test data created with 5 records
2025-05-14 14:27:58,747 - excel_formula_test - INFO - 
Testing formula: Submitter <> Approver
2025-05-14 14:27:58,748 - qa_analytics - INFO - Parsed formula: Submitter <> Approver -> (df['Submitter']!=df['Approver'])
2025-05-14 14:27:58,748 - excel_formula_test - INFO - Parsed: (df['Submitter']!=df['Approver'])
2025-05-14 14:27:58,748 - excel_formula_test - INFO - Fields: ['Submitter', 'Approver']
2025-05-14 14:27:58,748 - excel_formula_test - INFO - Results: 4 of 5 records pass (80.0%)
2025-05-14 14:27:58,748 - excel_formula_test - INFO - Expected: 3 records, Got: 4
2025-05-14 14:27:58,748 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:27:58,750 - excel_formula_test - INFO -   Submitter Approver
0      John    Alice
1      Mary     John
2025-05-14 14:27:58,751 - excel_formula_test - INFO - Failing Examples:
2025-05-14 14:27:58,751 - excel_formula_test - INFO -   Submitter Approver
2      John     John
2025-05-14 14:27:58,752 - excel_formula_test - INFO - 
Testing formula: Value > 100
2025-05-14 14:27:58,752 - qa_analytics - INFO - Parsed formula: Value > 100 -> (df['Value']>100)
2025-05-14 14:27:58,752 - excel_formula_test - INFO - Parsed: (df['Value']>100)
2025-05-14 14:27:58,752 - excel_formula_test - INFO - Fields: ['Value']
2025-05-14 14:27:58,752 - excel_formula_test - INFO - Results: 2 of 5 records pass (40.0%)
2025-05-14 14:27:58,752 - excel_formula_test - INFO - Expected: 3 records, Got: 2
2025-05-14 14:27:58,752 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:27:58,753 - excel_formula_test - INFO -    Value
1    200
3    500
2025-05-14 14:27:58,753 - excel_formula_test - INFO - Failing Examples:
2025-05-14 14:27:58,754 - excel_formula_test - INFO -    Value
0    100
2     50
2025-05-14 14:27:58,754 - excel_formula_test - INFO - 
Testing formula: `Submit Date` <= `TL Date`
2025-05-14 14:27:58,754 - qa_analytics - INFO - Parsed formula: __FIELD_1__ <= __FIELD_0__ -> (df['Submit Date']<=df['TL Date'])
2025-05-14 14:27:58,754 - excel_formula_test - INFO - Parsed: (df['Submit Date']<=df['TL Date'])
2025-05-14 14:27:58,754 - excel_formula_test - INFO - Fields: ['TL Date', 'Submit Date']
2025-05-14 14:27:58,755 - excel_formula_test - INFO - Results: 2 of 5 records pass (40.0%)
2025-05-14 14:27:58,755 - excel_formula_test - INFO - Expected: 3 records, Got: 2
2025-05-14 14:27:58,755 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:27:58,757 - excel_formula_test - INFO -      TL Date Submit Date
0 2025-01-05  2025-01-01
3 2025-05-01  2025-04-01
2025-05-14 14:27:58,757 - excel_formula_test - INFO - Failing Examples:
2025-05-14 14:27:58,758 - excel_formula_test - INFO -      TL Date Submit Date
1 2025-01-15  2025-02-01
2 2025-02-01  2025-03-01
2025-05-14 14:27:58,758 - excel_formula_test - INFO - 
Testing formula: Submitter <> Approver AND Value > 100
2025-05-14 14:27:58,758 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND Value > 100 -> (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 14:27:58,758 - excel_formula_test - INFO - Parsed: (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 14:27:58,758 - excel_formula_test - INFO - Fields: ['Submitter', 'Approver', 'Value']
2025-05-14 14:27:58,758 - excel_formula_test - INFO - Results: 2 of 5 records pass (40.0%)
2025-05-14 14:27:58,758 - excel_formula_test - INFO - Expected: 2 records, Got: 2
2025-05-14 14:27:58,758 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:27:58,759 - excel_formula_test - INFO -   Submitter Approver  Value
1      Mary     John    200
3       Bob  Charlie    500
2025-05-14 14:27:58,759 - excel_formula_test - INFO - Failing Examples:
2025-05-14 14:27:58,760 - excel_formula_test - INFO -   Submitter Approver  Value
0      John    Alice    100
2      John     John     50
2025-05-14 14:27:58,760 - excel_formula_test - INFO - 
Testing formula: Risk Level = "High"
2025-05-14 14:27:58,760 - qa_analytics - INFO - Parsed formula: Risk Level = "High" -> (df['Risk Level']=="High")
2025-05-14 14:27:58,760 - excel_formula_test - INFO - Parsed: (df['Risk Level']=="High")
2025-05-14 14:27:58,761 - excel_formula_test - INFO - Fields: ['Risk Level']
2025-05-14 14:27:58,761 - excel_formula_test - INFO - Results: 1 of 5 records pass (20.0%)
2025-05-14 14:27:58,761 - excel_formula_test - INFO - Expected: 1 records, Got: 1
2025-05-14 14:27:58,761 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:27:58,762 - excel_formula_test - INFO -   Risk Level
0       High
2025-05-14 14:27:58,762 - excel_formula_test - INFO - Failing Examples:
2025-05-14 14:27:58,762 - excel_formula_test - INFO -   Risk Level
1     Medium
2        Low
2025-05-14 14:27:58,763 - excel_formula_test - INFO - 
Testing formula: Risk Level IN ("High", "Medium")
2025-05-14 14:27:58,763 - qa_analytics - INFO - Parsed formula: Risk Level IN ("High", "Medium") -> (df['Risk Level']df['Risk Level'].isin(["High", "Medium"]))
2025-05-14 14:27:58,763 - excel_formula_test - INFO - Parsed: (df['Risk Level']df['Risk Level'].isin(["High", "Medium"]))
2025-05-14 14:27:58,763 - excel_formula_test - INFO - Fields: ['Risk Level']
2025-05-14 14:27:58,764 - qa_analytics - ERROR - Custom formula failed: invalid syntax. Perhaps you forgot a comma? (<string>, line 1), Formula: Risk Level IN ("High", "Medium")
2025-05-14 14:27:58,764 - excel_formula_test - INFO - Results: 0 of 5 records pass (0.0%)
2025-05-14 14:27:58,764 - excel_formula_test - INFO - Expected: 2 records, Got: 0
2025-05-14 14:27:58,764 - excel_formula_test - INFO - Failing Examples:
2025-05-14 14:27:58,764 - excel_formula_test - INFO -   Risk Level
0       High
1     Medium
2025-05-14 14:27:58,765 - excel_formula_test - INFO - 
Testing formula: NOT ISBLANK(Value)
2025-05-14 14:27:58,765 - qa_analytics - INFO - Parsed formula: NOT ISBLANK(Value) -> (~pd.isna(df['Value']))
2025-05-14 14:27:58,765 - excel_formula_test - INFO - Parsed: (~pd.isna(df['Value']))
2025-05-14 14:27:58,765 - excel_formula_test - INFO - Fields: ['Value']
2025-05-14 14:27:58,765 - excel_formula_test - INFO - Results: 5 of 5 records pass (100.0%)
2025-05-14 14:27:58,765 - excel_formula_test - INFO - Expected: 5 records, Got: 5
2025-05-14 14:27:58,765 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:27:58,766 - excel_formula_test - INFO -    Value
0    100
1    200
2025-05-14 14:27:58,766 - excel_formula_test - INFO - 
=== CONFIGURATION EXAMPLE ===
2025-05-14 14:27:58,766 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND __FIELD_1__ <= __FIELD_0__ -> (df['Submitter']!=df['Approver']) & (df['Submit Date']<=df['TL Date'])
2025-05-14 14:27:58,766 - excel_formula_test - INFO - Sample YAML configuration with Excel formula:
2025-05-14 14:27:58,766 - excel_formula_test - INFO - 
analytic_id: 99
analytic_name: 'Custom Formula Demo'
analytic_description: 'Demonstrates Excel-style formula validation'

# Data source configuration
data_source:
  name: 'approval_workflow'
  required_fields:
    - 'Submitter'
    - 'Approver'
    - 'Submit Date'
    - 'TL Date'
    - 'Risk Level'
    - 'Value'

# Validations with custom formula
validations:
  - rule: custom_formula
    description: 'Submitter cannot approve their own work and approval sequence must be followed'
    parameters:
      original_formula: 'Submitter <> Approver AND `Submit Date` <= `TL Date`'
      
  # With the auto-parsing feature you added, just providing the original_formula is enough!
  # The formula will be parsed during validation.
  # For reference, the parser would generate:
  # formula: "(df['Submitter']!=df['Approver']) & (df['Submit Date']<=df['TL Date'])"
  
  - rule: segregation_of_duties
    description: 'Traditional segregation of duties validation for comparison'
    parameters:
      submitter_field: 'Submitter'
      approver_fields: ['Approver']

thresholds:
  error_percentage: 5.0
  rationale: 'Industry standard allows for up to 5% error rate.'

reporting:
  group_by: 'Approver'
  summary_fields: ['GC', 'PC', 'DNC', 'Total', 'DNC_Percentage']
  detail_required: True

2025-05-14 14:27:58,766 - excel_formula_test - INFO - 
Demo complete! The Excel Formula Enhancement is working correctly.
2025-05-14 14:27:58,766 - excel_formula_test - INFO - You can now use Excel-style formulas in your QA Analytics Framework.
2025-05-14 14:52:54,282 - excel_formula_test - INFO - EXCEL FORMULA ENHANCEMENT DEMO
2025-05-14 14:52:54,282 - excel_formula_test - INFO - ============================
2025-05-14 14:52:54,282 - excel_formula_test - INFO - === EXCEL FORMULA PARSER TESTS ===
2025-05-14 14:52:54,282 - qa_analytics - INFO - Parsed formula: Submitter = Approver -> (df['Submitter']==df['Approver'])
2025-05-14 14:52:54,284 - excel_formula_test - INFO -   Parsed: (df['Submitter']==df['Approver'])
2025-05-14 14:52:54,284 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver']
2025-05-14 14:52:54,284 - excel_formula_test - INFO - ---
2025-05-14 14:52:54,284 - qa_analytics - INFO - Parsed formula: Submitter <> Approver -> (df['Submitter']!=df['Approver'])
2025-05-14 14:52:54,285 - excel_formula_test - INFO -   Parsed: (df['Submitter']!=df['Approver'])
2025-05-14 14:52:54,285 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver']
2025-05-14 14:52:54,285 - excel_formula_test - INFO - ---
2025-05-14 14:52:54,285 - qa_analytics - INFO - Parsed formula: Value > 100 -> (df['Value']>100)
2025-05-14 14:52:54,286 - excel_formula_test - INFO -   Parsed: (df['Value']>100)
2025-05-14 14:52:54,286 - excel_formula_test - INFO -   Fields: ['Value']
2025-05-14 14:52:54,286 - excel_formula_test - INFO - ---
2025-05-14 14:52:54,286 - qa_analytics - INFO - Parsed formula: Value >= 100 -> (df['Value']>=100)
2025-05-14 14:52:54,287 - excel_formula_test - INFO -   Parsed: (df['Value']>=100)
2025-05-14 14:52:54,287 - excel_formula_test - INFO -   Fields: ['Value']
2025-05-14 14:52:54,287 - excel_formula_test - INFO - ---
2025-05-14 14:52:54,287 - qa_analytics - INFO - Parsed formula: Value < 200 -> (df['Value']<200)
2025-05-14 14:52:54,288 - excel_formula_test - INFO -   Parsed: (df['Value']<200)
2025-05-14 14:52:54,288 - excel_formula_test - INFO -   Fields: ['Value']
2025-05-14 14:52:54,288 - excel_formula_test - INFO - ---
2025-05-14 14:52:54,288 - qa_analytics - INFO - Parsed formula: Value <= 200 -> (df['Value']<=200)
2025-05-14 14:52:54,289 - excel_formula_test - INFO -   Parsed: (df['Value']<=200)
2025-05-14 14:52:54,289 - excel_formula_test - INFO -   Fields: ['Value']
2025-05-14 14:52:54,289 - excel_formula_test - INFO - ---
2025-05-14 14:52:54,289 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND Value > 100 -> (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 14:52:54,290 - excel_formula_test - INFO -   Parsed: (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 14:52:54,290 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver', 'Value']
2025-05-14 14:52:54,290 - excel_formula_test - INFO - ---
2025-05-14 14:52:54,291 - qa_analytics - INFO - Parsed formula: Submitter = Approver OR Value > 100 -> (df['Submitter']==df['Approver']) | (df['Value']>100)
2025-05-14 14:52:54,291 - excel_formula_test - INFO -   Parsed: (df['Submitter']==df['Approver']) | (df['Value']>100)
2025-05-14 14:52:54,292 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver', 'Value']
2025-05-14 14:52:54,292 - excel_formula_test - INFO - ---
2025-05-14 14:52:54,292 - qa_analytics - INFO - Parsed formula: NOT Complete -> (~df['Complete'])
2025-05-14 14:52:54,293 - excel_formula_test - INFO -   Parsed: (~df['Complete'])
2025-05-14 14:52:54,293 - excel_formula_test - INFO -   Fields: ['Complete']
2025-05-14 14:52:54,293 - excel_formula_test - INFO - ---
2025-05-14 14:52:54,293 - qa_analytics - INFO - Parsed formula: (Submitter <> Approver) AND (Value > 100) -> (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 14:52:54,294 - excel_formula_test - INFO -   Parsed: (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 14:52:54,294 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver', 'Value']
2025-05-14 14:52:54,294 - excel_formula_test - INFO - ---
2025-05-14 14:52:54,294 - qa_analytics - INFO - Parsed formula: __FIELD_1__ <= __FIELD_0__ -> (df['Submit Date']<=df['TL Date'])
2025-05-14 14:52:54,295 - excel_formula_test - INFO -   Parsed: (df['Submit Date']<=df['TL Date'])
2025-05-14 14:52:54,295 - excel_formula_test - INFO -   Fields: ['TL Date', 'Submit Date']
2025-05-14 14:52:54,295 - excel_formula_test - INFO - ---
2025-05-14 14:52:54,295 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND __FIELD_1__ <= __FIELD_0__ AND Value > 100 -> (df['Submitter']!=df['Approver']) & (df['Submit Date']<=df['TL Date']) & (df['Value']>100)
2025-05-14 14:52:54,296 - excel_formula_test - INFO -   Parsed: (df['Submitter']!=df['Approver']) & (df['Submit Date']<=df['TL Date']) & (df['Value']>100)
2025-05-14 14:52:54,296 - excel_formula_test - INFO -   Fields: ['TL Date', 'Submit Date', 'Submitter', 'Approver', 'Value']
2025-05-14 14:52:54,296 - excel_formula_test - INFO - ---
2025-05-14 14:52:54,296 - qa_analytics - INFO - Parsed formula: ISBLANK(Approver) -> (pd.isna(df['Approver']))
2025-05-14 14:52:54,297 - excel_formula_test - INFO -   Parsed: (pd.isna(df['Approver']))
2025-05-14 14:52:54,297 - excel_formula_test - INFO -   Fields: ['Approver']
2025-05-14 14:52:54,297 - excel_formula_test - INFO - ---
2025-05-14 14:52:54,297 - qa_analytics - INFO - Parsed formula: NOT ISBLANK(Approver) -> (~pd.isna(df['Approver']))
2025-05-14 14:52:54,298 - excel_formula_test - INFO -   Parsed: (~pd.isna(df['Approver']))
2025-05-14 14:52:54,298 - excel_formula_test - INFO -   Fields: ['Approver']
2025-05-14 14:52:54,298 - excel_formula_test - INFO - ---
2025-05-14 14:52:54,298 - qa_analytics - INFO - Parsed formula: Risk Level IN ("High", "Medium") -> (df['Risk Level'].isin(["High", "Medium"]))
2025-05-14 14:52:54,299 - excel_formula_test - INFO -   Parsed: (df['Risk Level'].isin(["High", "Medium"]))
2025-05-14 14:52:54,299 - excel_formula_test - INFO -   Fields: ['Risk Level']
2025-05-14 14:52:54,299 - excel_formula_test - INFO - ---
2025-05-14 14:52:54,299 - excel_formula_test - INFO - 
=== FORMULA VALIDATION TESTS ===
2025-05-14 14:52:54,301 - excel_formula_test - INFO - Test data created with 5 records
2025-05-14 14:52:54,301 - excel_formula_test - INFO - 
Testing formula: Submitter <> Approver
2025-05-14 14:52:54,301 - qa_analytics - INFO - Parsed formula: Submitter <> Approver -> (df['Submitter']!=df['Approver'])
2025-05-14 14:52:54,301 - excel_formula_test - INFO - Parsed: (df['Submitter']!=df['Approver'])
2025-05-14 14:52:54,301 - excel_formula_test - INFO - Fields: ['Submitter', 'Approver']
2025-05-14 14:52:54,302 - excel_formula_test - INFO - Results: 4 of 5 records pass (80.0%)
2025-05-14 14:52:54,302 - excel_formula_test - INFO - Expected: 3 records, Got: 4
2025-05-14 14:52:54,302 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:52:54,304 - excel_formula_test - INFO -   Submitter Approver
0      John    Alice
1      Mary     John
2025-05-14 14:52:54,304 - excel_formula_test - INFO - Failing Examples:
2025-05-14 14:52:54,305 - excel_formula_test - INFO -   Submitter Approver
2      John     John
2025-05-14 14:52:54,305 - excel_formula_test - INFO - 
Testing formula: Value > 100
2025-05-14 14:52:54,305 - qa_analytics - INFO - Parsed formula: Value > 100 -> (df['Value']>100)
2025-05-14 14:52:54,306 - excel_formula_test - INFO - Parsed: (df['Value']>100)
2025-05-14 14:52:54,306 - excel_formula_test - INFO - Fields: ['Value']
2025-05-14 14:52:54,306 - excel_formula_test - INFO - Results: 2 of 5 records pass (40.0%)
2025-05-14 14:52:54,306 - excel_formula_test - INFO - Expected: 3 records, Got: 2
2025-05-14 14:52:54,306 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:52:54,307 - excel_formula_test - INFO -    Value
1    200
3    500
2025-05-14 14:52:54,307 - excel_formula_test - INFO - Failing Examples:
2025-05-14 14:52:54,308 - excel_formula_test - INFO -    Value
0    100
2     50
2025-05-14 14:52:54,308 - excel_formula_test - INFO - 
Testing formula: `Submit Date` <= `TL Date`
2025-05-14 14:52:54,308 - qa_analytics - INFO - Parsed formula: __FIELD_1__ <= __FIELD_0__ -> (df['Submit Date']<=df['TL Date'])
2025-05-14 14:52:54,308 - excel_formula_test - INFO - Parsed: (df['Submit Date']<=df['TL Date'])
2025-05-14 14:52:54,308 - excel_formula_test - INFO - Fields: ['TL Date', 'Submit Date']
2025-05-14 14:52:54,308 - excel_formula_test - INFO - Results: 2 of 5 records pass (40.0%)
2025-05-14 14:52:54,309 - excel_formula_test - INFO - Expected: 3 records, Got: 2
2025-05-14 14:52:54,309 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:52:54,309 - excel_formula_test - INFO -      TL Date Submit Date
0 2025-01-05  2025-01-01
3 2025-05-01  2025-04-01
2025-05-14 14:52:54,310 - excel_formula_test - INFO - Failing Examples:
2025-05-14 14:52:54,310 - excel_formula_test - INFO -      TL Date Submit Date
1 2025-01-15  2025-02-01
2 2025-02-01  2025-03-01
2025-05-14 14:52:54,310 - excel_formula_test - INFO - 
Testing formula: Submitter <> Approver AND Value > 100
2025-05-14 14:52:54,311 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND Value > 100 -> (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 14:52:54,311 - excel_formula_test - INFO - Parsed: (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 14:52:54,311 - excel_formula_test - INFO - Fields: ['Submitter', 'Approver', 'Value']
2025-05-14 14:52:54,311 - excel_formula_test - INFO - Results: 2 of 5 records pass (40.0%)
2025-05-14 14:52:54,311 - excel_formula_test - INFO - Expected: 2 records, Got: 2
2025-05-14 14:52:54,311 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:52:54,312 - excel_formula_test - INFO -   Submitter Approver  Value
1      Mary     John    200
3       Bob  Charlie    500
2025-05-14 14:52:54,312 - excel_formula_test - INFO - Failing Examples:
2025-05-14 14:52:54,313 - excel_formula_test - INFO -   Submitter Approver  Value
0      John    Alice    100
2      John     John     50
2025-05-14 14:52:54,313 - excel_formula_test - INFO - 
Testing formula: Risk Level = "High"
2025-05-14 14:52:54,313 - qa_analytics - INFO - Parsed formula: Risk Level = "High" -> (df['Risk Level']=="High")
2025-05-14 14:52:54,313 - excel_formula_test - INFO - Parsed: (df['Risk Level']=="High")
2025-05-14 14:52:54,313 - excel_formula_test - INFO - Fields: ['Risk Level']
2025-05-14 14:52:54,313 - excel_formula_test - INFO - Results: 1 of 5 records pass (20.0%)
2025-05-14 14:52:54,314 - excel_formula_test - INFO - Expected: 1 records, Got: 1
2025-05-14 14:52:54,314 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:52:54,314 - excel_formula_test - INFO -   Risk Level
0       High
2025-05-14 14:52:54,314 - excel_formula_test - INFO - Failing Examples:
2025-05-14 14:52:54,315 - excel_formula_test - INFO -   Risk Level
1     Medium
2        Low
2025-05-14 14:52:54,315 - excel_formula_test - INFO - 
Testing formula: Risk Level IN ("High", "Medium")
2025-05-14 14:52:54,315 - qa_analytics - INFO - Parsed formula: Risk Level IN ("High", "Medium") -> (df['Risk Level'].isin(["High", "Medium"]))
2025-05-14 14:52:54,315 - excel_formula_test - INFO - Parsed: (df['Risk Level'].isin(["High", "Medium"]))
2025-05-14 14:52:54,315 - excel_formula_test - INFO - Fields: ['Risk Level']
2025-05-14 14:52:54,317 - excel_formula_test - INFO - Results: 2 of 5 records pass (40.0%)
2025-05-14 14:52:54,317 - excel_formula_test - INFO - Expected: 2 records, Got: 2
2025-05-14 14:52:54,317 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:52:54,317 - excel_formula_test - INFO -   Risk Level
0       High
1     Medium
2025-05-14 14:52:54,317 - excel_formula_test - INFO - Failing Examples:
2025-05-14 14:52:54,318 - excel_formula_test - INFO -   Risk Level
2        Low
3   Critical
2025-05-14 14:52:54,318 - excel_formula_test - INFO - 
Testing formula: NOT ISBLANK(Value)
2025-05-14 14:52:54,318 - qa_analytics - INFO - Parsed formula: NOT ISBLANK(Value) -> (~pd.isna(df['Value']))
2025-05-14 14:52:54,318 - excel_formula_test - INFO - Parsed: (~pd.isna(df['Value']))
2025-05-14 14:52:54,319 - excel_formula_test - INFO - Fields: ['Value']
2025-05-14 14:52:54,319 - excel_formula_test - INFO - Results: 5 of 5 records pass (100.0%)
2025-05-14 14:52:54,319 - excel_formula_test - INFO - Expected: 5 records, Got: 5
2025-05-14 14:52:54,319 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:52:54,319 - excel_formula_test - INFO -    Value
0    100
1    200
2025-05-14 14:52:54,320 - excel_formula_test - INFO - 
=== CONFIGURATION EXAMPLE ===
2025-05-14 14:52:54,320 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND __FIELD_1__ <= __FIELD_0__ -> (df['Submitter']!=df['Approver']) & (df['Submit Date']<=df['TL Date'])
2025-05-14 14:52:54,320 - excel_formula_test - INFO - Sample YAML configuration with Excel formula:
2025-05-14 14:52:54,320 - excel_formula_test - INFO - 
analytic_id: 99
analytic_name: 'Custom Formula Demo'
analytic_description: 'Demonstrates Excel-style formula validation'

# Data source configuration
data_source:
  name: 'approval_workflow'
  required_fields:
    - 'Submitter'
    - 'Approver'
    - 'Submit Date'
    - 'TL Date'
    - 'Risk Level'
    - 'Value'

# Validations with custom formula
validations:
  - rule: custom_formula
    description: 'Submitter cannot approve their own work and approval sequence must be followed'
    parameters:
      original_formula: 'Submitter <> Approver AND `Submit Date` <= `TL Date`'
      
  # With the auto-parsing feature you added, just providing the original_formula is enough!
  # The formula will be parsed during validation.
  # For reference, the parser would generate:
  # formula: "(df['Submitter']!=df['Approver']) & (df['Submit Date']<=df['TL Date'])"
  
  - rule: segregation_of_duties
    description: 'Traditional segregation of duties validation for comparison'
    parameters:
      submitter_field: 'Submitter'
      approver_fields: ['Approver']

thresholds:
  error_percentage: 5.0
  rationale: 'Industry standard allows for up to 5% error rate.'

reporting:
  group_by: 'Approver'
  summary_fields: ['GC', 'PC', 'DNC', 'Total', 'DNC_Percentage']
  detail_required: True

2025-05-14 14:52:54,320 - excel_formula_test - INFO - 
Demo complete! The Excel Formula Enhancement is working correctly.
2025-05-14 14:52:54,320 - excel_formula_test - INFO - You can now use Excel-style formulas in your QA Analytics Framework.
2025-05-14 14:59:57,516 - excel_formula_test - INFO - EXCEL FORMULA ENHANCEMENT DEMO
2025-05-14 14:59:57,516 - excel_formula_test - INFO - ============================
2025-05-14 14:59:57,517 - excel_formula_test - INFO - === EXCEL FORMULA PARSER TESTS ===
2025-05-14 14:59:57,517 - qa_analytics - INFO - Parsed formula: Submitter = Approver -> (df['Submitter']==df['Approver'])
2025-05-14 14:59:57,518 - excel_formula_test - INFO -   Parsed: (df['Submitter']==df['Approver'])
2025-05-14 14:59:57,518 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver']
2025-05-14 14:59:57,518 - excel_formula_test - INFO - ---
2025-05-14 14:59:57,518 - qa_analytics - INFO - Parsed formula: Submitter <> Approver -> (df['Submitter']!=df['Approver'])
2025-05-14 14:59:57,519 - excel_formula_test - INFO -   Parsed: (df['Submitter']!=df['Approver'])
2025-05-14 14:59:57,519 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver']
2025-05-14 14:59:57,519 - excel_formula_test - INFO - ---
2025-05-14 14:59:57,519 - qa_analytics - INFO - Parsed formula: Value > 100 -> (df['Value']>100)
2025-05-14 14:59:57,520 - excel_formula_test - INFO -   Parsed: (df['Value']>100)
2025-05-14 14:59:57,520 - excel_formula_test - INFO -   Fields: ['Value']
2025-05-14 14:59:57,520 - excel_formula_test - INFO - ---
2025-05-14 14:59:57,520 - qa_analytics - INFO - Parsed formula: Value >= 100 -> (df['Value']>=100)
2025-05-14 14:59:57,521 - excel_formula_test - INFO -   Parsed: (df['Value']>=100)
2025-05-14 14:59:57,521 - excel_formula_test - INFO -   Fields: ['Value']
2025-05-14 14:59:57,522 - excel_formula_test - INFO - ---
2025-05-14 14:59:57,522 - qa_analytics - INFO - Parsed formula: Value < 200 -> (df['Value']<200)
2025-05-14 14:59:57,523 - excel_formula_test - INFO -   Parsed: (df['Value']<200)
2025-05-14 14:59:57,523 - excel_formula_test - INFO -   Fields: ['Value']
2025-05-14 14:59:57,523 - excel_formula_test - INFO - ---
2025-05-14 14:59:57,523 - qa_analytics - INFO - Parsed formula: Value <= 200 -> (df['Value']<=200)
2025-05-14 14:59:57,524 - excel_formula_test - INFO -   Parsed: (df['Value']<=200)
2025-05-14 14:59:57,524 - excel_formula_test - INFO -   Fields: ['Value']
2025-05-14 14:59:57,524 - excel_formula_test - INFO - ---
2025-05-14 14:59:57,524 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND Value > 100 -> (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 14:59:57,525 - excel_formula_test - INFO -   Parsed: (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 14:59:57,525 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver', 'Value']
2025-05-14 14:59:57,525 - excel_formula_test - INFO - ---
2025-05-14 14:59:57,525 - qa_analytics - INFO - Parsed formula: Submitter = Approver OR Value > 100 -> (df['Submitter']==df['Approver']) | (df['Value']>100)
2025-05-14 14:59:57,526 - excel_formula_test - INFO -   Parsed: (df['Submitter']==df['Approver']) | (df['Value']>100)
2025-05-14 14:59:57,526 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver', 'Value']
2025-05-14 14:59:57,526 - excel_formula_test - INFO - ---
2025-05-14 14:59:57,526 - qa_analytics - INFO - Parsed formula: NOT Complete -> (~df['Complete'])
2025-05-14 14:59:57,527 - excel_formula_test - INFO -   Parsed: (~df['Complete'])
2025-05-14 14:59:57,527 - excel_formula_test - INFO -   Fields: ['Complete']
2025-05-14 14:59:57,527 - excel_formula_test - INFO - ---
2025-05-14 14:59:57,527 - qa_analytics - INFO - Parsed formula: (Submitter <> Approver) AND (Value > 100) -> (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 14:59:57,528 - excel_formula_test - INFO -   Parsed: (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 14:59:57,528 - excel_formula_test - INFO -   Fields: ['Submitter', 'Approver', 'Value']
2025-05-14 14:59:57,528 - excel_formula_test - INFO - ---
2025-05-14 14:59:57,528 - qa_analytics - INFO - Parsed formula: __FIELD_1__ <= __FIELD_0__ -> (df['Submit Date']<=df['TL Date'])
2025-05-14 14:59:57,528 - excel_formula_test - INFO -   Parsed: (df['Submit Date']<=df['TL Date'])
2025-05-14 14:59:57,529 - excel_formula_test - INFO -   Fields: ['TL Date', 'Submit Date']
2025-05-14 14:59:57,529 - excel_formula_test - INFO - ---
2025-05-14 14:59:57,529 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND __FIELD_1__ <= __FIELD_0__ AND Value > 100 -> (df['Submitter']!=df['Approver']) & (df['Submit Date']<=df['TL Date']) & (df['Value']>100)
2025-05-14 14:59:57,529 - excel_formula_test - INFO -   Parsed: (df['Submitter']!=df['Approver']) & (df['Submit Date']<=df['TL Date']) & (df['Value']>100)
2025-05-14 14:59:57,530 - excel_formula_test - INFO -   Fields: ['TL Date', 'Submit Date', 'Submitter', 'Approver', 'Value']
2025-05-14 14:59:57,530 - excel_formula_test - INFO - ---
2025-05-14 14:59:57,530 - qa_analytics - INFO - Parsed formula: ISBLANK(Approver) -> (pd.isna(df['Approver']))
2025-05-14 14:59:57,530 - excel_formula_test - INFO -   Parsed: (pd.isna(df['Approver']))
2025-05-14 14:59:57,530 - excel_formula_test - INFO -   Fields: ['Approver']
2025-05-14 14:59:57,530 - excel_formula_test - INFO - ---
2025-05-14 14:59:57,530 - qa_analytics - INFO - Parsed formula: NOT ISBLANK(Approver) -> (~pd.isna(df['Approver']))
2025-05-14 14:59:57,531 - excel_formula_test - INFO -   Parsed: (~pd.isna(df['Approver']))
2025-05-14 14:59:57,531 - excel_formula_test - INFO -   Fields: ['Approver']
2025-05-14 14:59:57,531 - excel_formula_test - INFO - ---
2025-05-14 14:59:57,531 - qa_analytics - INFO - Parsed formula: Risk Level IN ("High", "Medium") -> (df['Risk Level'].isin(["High", "Medium"]))
2025-05-14 14:59:57,532 - excel_formula_test - INFO -   Parsed: (df['Risk Level'].isin(["High", "Medium"]))
2025-05-14 14:59:57,532 - excel_formula_test - INFO -   Fields: ['Risk Level']
2025-05-14 14:59:57,532 - excel_formula_test - INFO - ---
2025-05-14 14:59:57,532 - excel_formula_test - INFO - 
=== FORMULA VALIDATION TESTS ===
2025-05-14 14:59:57,534 - excel_formula_test - INFO - Test data created with 5 records
2025-05-14 14:59:57,534 - excel_formula_test - INFO - 
Testing formula: Submitter <> Approver
2025-05-14 14:59:57,534 - qa_analytics - INFO - Parsed formula: Submitter <> Approver -> (df['Submitter']!=df['Approver'])
2025-05-14 14:59:57,534 - excel_formula_test - INFO - Parsed: (df['Submitter']!=df['Approver'])
2025-05-14 14:59:57,534 - excel_formula_test - INFO - Fields: ['Submitter', 'Approver']
2025-05-14 14:59:57,534 - excel_formula_test - INFO - Results: 4 of 5 records pass (80.0%)
2025-05-14 14:59:57,535 - excel_formula_test - INFO - Expected: 3 records, Got: 4
2025-05-14 14:59:57,535 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:59:57,537 - excel_formula_test - INFO -   Submitter Approver
0      John    Alice
1      Mary     John
2025-05-14 14:59:57,537 - excel_formula_test - INFO - Failing Examples:
2025-05-14 14:59:57,538 - excel_formula_test - INFO -   Submitter Approver
2      John     John
2025-05-14 14:59:57,538 - excel_formula_test - INFO - 
Testing formula: Value > 100
2025-05-14 14:59:57,538 - qa_analytics - INFO - Parsed formula: Value > 100 -> (df['Value']>100)
2025-05-14 14:59:57,539 - excel_formula_test - INFO - Parsed: (df['Value']>100)
2025-05-14 14:59:57,539 - excel_formula_test - INFO - Fields: ['Value']
2025-05-14 14:59:57,539 - excel_formula_test - INFO - Results: 2 of 5 records pass (40.0%)
2025-05-14 14:59:57,539 - excel_formula_test - INFO - Expected: 3 records, Got: 2
2025-05-14 14:59:57,539 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:59:57,540 - excel_formula_test - INFO -    Value
1    200
3    500
2025-05-14 14:59:57,540 - excel_formula_test - INFO - Failing Examples:
2025-05-14 14:59:57,540 - excel_formula_test - INFO -    Value
0    100
2     50
2025-05-14 14:59:57,540 - excel_formula_test - INFO - 
Testing formula: `Submit Date` <= `TL Date`
2025-05-14 14:59:57,541 - qa_analytics - INFO - Parsed formula: __FIELD_1__ <= __FIELD_0__ -> (df['Submit Date']<=df['TL Date'])
2025-05-14 14:59:57,541 - excel_formula_test - INFO - Parsed: (df['Submit Date']<=df['TL Date'])
2025-05-14 14:59:57,541 - excel_formula_test - INFO - Fields: ['TL Date', 'Submit Date']
2025-05-14 14:59:57,541 - excel_formula_test - INFO - Results: 2 of 5 records pass (40.0%)
2025-05-14 14:59:57,541 - excel_formula_test - INFO - Expected: 3 records, Got: 2
2025-05-14 14:59:57,541 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:59:57,542 - excel_formula_test - INFO -      TL Date Submit Date
0 2025-01-05  2025-01-01
3 2025-05-01  2025-04-01
2025-05-14 14:59:57,542 - excel_formula_test - INFO - Failing Examples:
2025-05-14 14:59:57,543 - excel_formula_test - INFO -      TL Date Submit Date
1 2025-01-15  2025-02-01
2 2025-02-01  2025-03-01
2025-05-14 14:59:57,543 - excel_formula_test - INFO - 
Testing formula: Submitter <> Approver AND Value > 100
2025-05-14 14:59:57,543 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND Value > 100 -> (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 14:59:57,543 - excel_formula_test - INFO - Parsed: (df['Submitter']!=df['Approver']) & (df['Value']>100)
2025-05-14 14:59:57,543 - excel_formula_test - INFO - Fields: ['Submitter', 'Approver', 'Value']
2025-05-14 14:59:57,543 - excel_formula_test - INFO - Results: 2 of 5 records pass (40.0%)
2025-05-14 14:59:57,543 - excel_formula_test - INFO - Expected: 2 records, Got: 2
2025-05-14 14:59:57,543 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:59:57,544 - excel_formula_test - INFO -   Submitter Approver  Value
1      Mary     John    200
3       Bob  Charlie    500
2025-05-14 14:59:57,544 - excel_formula_test - INFO - Failing Examples:
2025-05-14 14:59:57,545 - excel_formula_test - INFO -   Submitter Approver  Value
0      John    Alice    100
2      John     John     50
2025-05-14 14:59:57,545 - excel_formula_test - INFO - 
Testing formula: Risk Level = "High"
2025-05-14 14:59:57,545 - qa_analytics - INFO - Parsed formula: Risk Level = "High" -> (df['Risk Level']=="High")
2025-05-14 14:59:57,545 - excel_formula_test - INFO - Parsed: (df['Risk Level']=="High")
2025-05-14 14:59:57,545 - excel_formula_test - INFO - Fields: ['Risk Level']
2025-05-14 14:59:57,546 - excel_formula_test - INFO - Results: 1 of 5 records pass (20.0%)
2025-05-14 14:59:57,546 - excel_formula_test - INFO - Expected: 1 records, Got: 1
2025-05-14 14:59:57,546 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:59:57,546 - excel_formula_test - INFO -   Risk Level
0       High
2025-05-14 14:59:57,546 - excel_formula_test - INFO - Failing Examples:
2025-05-14 14:59:57,547 - excel_formula_test - INFO -   Risk Level
1     Medium
2        Low
2025-05-14 14:59:57,547 - excel_formula_test - INFO - 
Testing formula: Risk Level IN ("High", "Medium")
2025-05-14 14:59:57,547 - qa_analytics - INFO - Parsed formula: Risk Level IN ("High", "Medium") -> (df['Risk Level'].isin(["High", "Medium"]))
2025-05-14 14:59:57,547 - excel_formula_test - INFO - Parsed: (df['Risk Level'].isin(["High", "Medium"]))
2025-05-14 14:59:57,547 - excel_formula_test - INFO - Fields: ['Risk Level']
2025-05-14 14:59:57,547 - excel_formula_test - INFO - Results: 2 of 5 records pass (40.0%)
2025-05-14 14:59:57,547 - excel_formula_test - INFO - Expected: 2 records, Got: 2
2025-05-14 14:59:57,547 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:59:57,548 - excel_formula_test - INFO -   Risk Level
0       High
1     Medium
2025-05-14 14:59:57,548 - excel_formula_test - INFO - Failing Examples:
2025-05-14 14:59:57,549 - excel_formula_test - INFO -   Risk Level
2        Low
3   Critical
2025-05-14 14:59:57,549 - excel_formula_test - INFO - 
Testing formula: NOT ISBLANK(Value)
2025-05-14 14:59:57,549 - qa_analytics - INFO - Parsed formula: NOT ISBLANK(Value) -> (~pd.isna(df['Value']))
2025-05-14 14:59:57,549 - excel_formula_test - INFO - Parsed: (~pd.isna(df['Value']))
2025-05-14 14:59:57,549 - excel_formula_test - INFO - Fields: ['Value']
2025-05-14 14:59:57,549 - excel_formula_test - INFO - Results: 5 of 5 records pass (100.0%)
2025-05-14 14:59:57,549 - excel_formula_test - INFO - Expected: 5 records, Got: 5
2025-05-14 14:59:57,549 - excel_formula_test - INFO - Passing Examples:
2025-05-14 14:59:57,550 - excel_formula_test - INFO -    Value
0    100
1    200
2025-05-14 14:59:57,550 - excel_formula_test - INFO - 
=== CONFIGURATION EXAMPLE ===
2025-05-14 14:59:57,550 - qa_analytics - INFO - Parsed formula: Submitter <> Approver AND __FIELD_1__ <= __FIELD_0__ -> (df['Submitter']!=df['Approver']) & (df['Submit Date']<=df['TL Date'])
2025-05-14 14:59:57,550 - excel_formula_test - INFO - Sample YAML configuration with Excel formula:
2025-05-14 14:59:57,550 - excel_formula_test - INFO - 
analytic_id: 99
analytic_name: 'Custom Formula Demo'
analytic_description: 'Demonstrates Excel-style formula validation'

# Data source configuration
data_source:
  name: 'approval_workflow'
  required_fields:
    - 'Submitter'
    - 'Approver'
    - 'Submit Date'
    - 'TL Date'
    - 'Risk Level'
    - 'Value'

# Validations with custom formula
validations:
  - rule: custom_formula
    description: 'Submitter cannot approve their own work and approval sequence must be followed'
    parameters:
      original_formula: 'Submitter <> Approver AND `Submit Date` <= `TL Date`'
      
  # With the auto-parsing feature you added, just providing the original_formula is enough!
  # The formula will be parsed during validation.
  # For reference, the parser would generate:
  # formula: "(df['Submitter']!=df['Approver']) & (df['Submit Date']<=df['TL Date'])"
  
  - rule: segregation_of_duties
    description: 'Traditional segregation of duties validation for comparison'
    parameters:
      submitter_field: 'Submitter'
      approver_fields: ['Approver']

thresholds:
  error_percentage: 5.0
  rationale: 'Industry standard allows for up to 5% error rate.'

reporting:
  group_by: 'Approver'
  summary_fields: ['GC', 'PC', 'DNC', 'Total', 'DNC_Percentage']
  detail_required: True

2025-05-14 14:59:57,550 - excel_formula_test - INFO - 
Demo complete! The Excel Formula Enhancement is working correctly.
2025-05-14 14:59:57,551 - excel_formula_test - INFO - You can now use Excel-style formulas in your QA Analytics Framework.
2025-05-14 15:03:56,062 - qa_analytics - INFO - Parsed formula: __FIELD_0__ = "High" -> (df['Risk Level']=="High")
2025-05-14 15:03:56,063 - qa_analytics - INFO - Parsed formula: __FIELD_0__ = "High" -> (df['Risk Level']=="High")
2025-05-14 15:03:56,063 - qa_analytics - INFO - Parsed formula: __FIELD_0__ IN ("High", "Critical") -> (df['Risk Level'].isin(["High", "Critical"]))
2025-05-14 15:03:56,063 - qa_analytics - INFO - Parsed formula: __FIELD_0__ IN ("High", "Critical") -> (df['Risk Level'].isin(["High", "Critical"]))
2025-05-14 15:03:56,064 - qa_analytics - INFO - Parsed formula: IF(__FIELD_1__="High", __FIELD_0__ > "2025-02-01", False) -> (np.where(df['Risk Level']=="High", df['Approval Date']>"2025-02-01", df['False']))
2025-05-14 15:03:56,064 - qa_analytics - INFO - Parsed formula: IF(__FIELD_1__="High", __FIELD_0__ > "2025-02-01", False) -> (np.where(df['Risk Level']=="High", df['Approval Date']>"2025-02-01", df['False']))
2025-05-14 15:03:56,065 - qa_analytics - INFO - Parsed formula: Value > 100 -> (df['Value']>100)
2025-05-14 15:03:56,065 - qa_analytics - INFO - Parsed formula: Value > 100 -> (df['Value']>100)
2025-05-14 15:03:56,066 - qa_analytics - INFO - Parsed formula: Value < 100 -> (df['Value']<100)
2025-05-14 15:03:56,066 - qa_analytics - INFO - Parsed formula: Value < 100 -> (df['Value']<100)
2025-05-14 15:03:56,066 - qa_analytics - INFO - Parsed formula: Value = 150 -> (df['Value']==150)
2025-05-14 15:03:56,066 - qa_analytics - INFO - Parsed formula: Value = 150 -> (df['Value']==150)
2025-05-14 15:03:56,067 - qa_analytics - INFO - Parsed formula: Value <> 150 -> (df['Value']!=150)
2025-05-14 15:03:56,067 - qa_analytics - INFO - Parsed formula: Value <> 150 -> (df['Value']!=150)
2025-05-14 15:03:56,067 - qa_analytics - INFO - Parsed formula: Value >= 150 -> (df['Value']>=150)
2025-05-14 15:03:56,067 - qa_analytics - INFO - Parsed formula: Value >= 150 -> (df['Value']>=150)
2025-05-14 15:03:56,067 - qa_analytics - INFO - Parsed formula: Value <= 75 -> (df['Value']<=75)
2025-05-14 15:03:56,068 - qa_analytics - INFO - Parsed formula: Value <= 75 -> (df['Value']<=75)
2025-05-14 15:03:56,069 - qa_analytics - INFO - Parsed formula: IF(Risk_Level IN ("High", "Critical"),    Days_Open<=30 AND Value>100,    Days_Open<=90 AND Value<200) -> (np.where(df['Risk_Level'].isin("High","Critical"), df['Days_Open']<=30&df['Value']>100, df['Days_Open']<=90&df['Value']<200))
2025-05-14 15:03:56,069 - qa_analytics - INFO - Parsed formula: IF(Risk_Level IN ("High", "Critical"),    Days_Open<=30 AND Value>100,    Days_Open<=90 AND Value<200) -> (np.where(df['Risk_Level'].isin("High","Critical"), df['Days_Open']<=30&df['Value']>100, df['Days_Open']<=90&df['Value']<200))
2025-05-14 15:03:56,069 - qa_analytics - ERROR - Custom formula failed: Series.isin() takes 2 positional arguments but 3 were given, Formula: IF(Risk_Level IN ("High", "Critical"),    Days_Open<=30 AND Value>100,    Days_Open<=90 AND Value<200)
2025-05-14 15:03:56,069 - qa_analytics - INFO - Parsed formula: IF(ISBLANK(Third_Party), "N/A",    IF(Risk_Level IN ("High", "Critical"), "DNC", "GC")) = "N/A" -> (np.where(df['ISBLANK'](df['Third_Party']), "N/A", df['IF'](df['Risk_Level'].isin("High","Critical"),"DNC","GC"))"N/A")
2025-05-14 15:03:56,069 - qa_analytics - INFO - Parsed formula: IF(ISBLANK(Third_Party), "N/A",    IF(Risk_Level IN ("High", "Critical"), "DNC", "GC")) = "N/A" -> (np.where(df['ISBLANK'](df['Third_Party']), "N/A", df['IF'](df['Risk_Level'].isin("High","Critical"),"DNC","GC"))"N/A")
2025-05-14 15:03:56,070 - qa_analytics - INFO - Parsed formula: NOT(Risk_Level IN ("High", "Critical")) OR (Submit_Date <= Approval_Date AND Days_Open <= 30) -> (~(df['Risk_Level'].isin(["High", "Critical"]))) | (df['Submit_Date']<=df['Approval_Date']&df['Days_Open']<=30)
2025-05-14 15:03:56,070 - qa_analytics - INFO - Parsed formula: NOT(Risk_Level IN ("High", "Critical")) OR (Submit_Date <= Approval_Date AND Days_Open <= 30) -> (~(df['Risk_Level'].isin(["High", "Critical"]))) | (df['Submit_Date']<=df['Approval_Date']&df['Days_Open']<=30)
2025-05-14 15:03:56,071 - qa_analytics - ERROR - Custom formula failed: ufunc 'bitwise_and' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe'', Formula: NOT(Risk_Level IN ("High", "Critical")) OR (Submit_Date <= Approval_Date AND Days_Open <= 30)
2025-05-14 15:03:56,072 - qa_analytics - INFO - Parsed formula: Submit_Date <= Approval_Date -> (df['Submit_Date']<=df['Approval_Date'])
2025-05-14 15:03:56,072 - qa_analytics - INFO - Parsed formula: Submit_Date <= Approval_Date -> (df['Submit_Date']<=df['Approval_Date'])
2025-05-14 15:03:56,072 - qa_analytics - INFO - Parsed formula: (Approval_Date - Submit_Date).dt.days <= 10 -> ((df['Approval_Date Submit_Date'])df['dt days']<=10)
2025-05-14 15:03:56,072 - qa_analytics - INFO - Parsed formula: (Approval_Date - Submit_Date).dt.days <= 10 -> ((df['Approval_Date Submit_Date'])df['dt days']<=10)
2025-05-14 15:03:56,072 - qa_analytics - INFO - Parsed formula: DATEDIF(Submit_Date, Approval_Date, "D") > 10 -> ((pd.to_datetime(df['Approval_Date'], errors='coerce') - pd.to_datetime(df['Submit_Date'], errors='coerce')).dt.days10)
2025-05-14 15:03:56,073 - qa_analytics - INFO - Parsed formula: DATEDIF(Submit_Date, Approval_Date, "D") > 10 -> ((pd.to_datetime(df['Approval_Date'], errors='coerce') - pd.to_datetime(df['Submit_Date'], errors='coerce')).dt.days10)
2025-05-14 15:03:56,073 - qa_analytics - ERROR - Custom formula failed: 'TimedeltaProperties' object has no attribute 'days10', Formula: DATEDIF(Submit_Date, Approval_Date, "D") > 10
2025-05-14 15:03:56,080 - qa_analytics - ERROR - IN operator has no preceding field
2025-05-14 15:03:56,080 - qa_analytics - INFO - Parsed formula: IN ("High", "Medium") -> (.isin([]))
2025-05-14 15:03:56,081 - qa_analytics - ERROR - Custom formula failed: invalid syntax (<string>, line 1), Formula: IN ("High", "Medium")
2025-05-14 15:03:56,081 - qa_analytics - INFO - Parsed formula: Risk_Level =  -> (df['Risk_Level']==)
2025-05-14 15:03:56,081 - qa_analytics - ERROR - Custom formula failed: invalid syntax (<string>, line 1), Formula: Risk_Level = 
2025-05-14 15:03:56,081 - qa_analytics - ERROR - Unexpected end of IF function
2025-05-14 15:03:56,081 - qa_analytics - INFO - Parsed formula: IF(Risk_Level="High") -> (pd.Series(np.nan, index=df.index))
2025-05-14 15:03:56,082 - qa_analytics - INFO - Parsed formula: UNKNOWNFUNC(Value) -> (df['UNKNOWNFUNC'](df['Value']))
2025-05-14 15:03:56,083 - qa_analytics - INFO - Parsed formula: IF(Risk_Level="High", Days_Open<=30, Days_Open<=90) -> (np.where(df['Risk_Level']=="High", df['Days_Open']<=30, df['Days_Open']<=90))
2025-05-14 15:03:56,083 - qa_analytics - INFO - Parsed formula: IF(Risk_Level="High", Days_Open<=30, Days_Open<=90) -> (np.where(df['Risk_Level']=="High", df['Days_Open']<=30, df['Days_Open']<=90))
2025-05-14 15:03:56,084 - qa_analytics - INFO - Parsed formula: IF(Value>100, "High", "Low") = "High" -> (np.where(df['Value']>100, "High", "Low")"High")
2025-05-14 15:03:56,084 - qa_analytics - INFO - Parsed formula: IF(Value>100, "High", "Low") = "High" -> (np.where(df['Value']>100, "High", "Low")"High")
2025-05-14 15:03:56,084 - qa_analytics - ERROR - Custom formula failed: invalid syntax. Perhaps you forgot a comma? (<string>, line 1), Formula: IF(Value>100, "High", "Low") = "High"
2025-05-14 15:03:56,084 - qa_analytics - INFO - Parsed formula: IF(Owner="John", Value>100, Value<100) = True -> (np.where(df['Owner']=="John", df['Value']>100, df['Value']<100)df['True'])
2025-05-14 15:03:56,084 - qa_analytics - INFO - Parsed formula: IF(Owner="John", Value>100, Value<100) = True -> (np.where(df['Owner']=="John", df['Value']>100, df['Value']<100)df['True'])
2025-05-14 15:03:56,084 - qa_analytics - INFO - Parsed formula: IF(Third_Party="", "N/A", "Has TP") = "N/A" -> (np.where(df['Third_Party']=="", "N/A", "Has TP")"N/A")
2025-05-14 15:03:56,085 - qa_analytics - INFO - Parsed formula: IF(Third_Party="", "N/A", "Has TP") = "N/A" -> (np.where(df['Third_Party']=="", "N/A", "Has TP")"N/A")
2025-05-14 15:03:56,085 - qa_analytics - ERROR - Custom formula failed: invalid syntax. Perhaps you forgot a comma? (<string>, line 1), Formula: IF(Third_Party="", "N/A", "Has TP") = "N/A"
2025-05-14 15:03:56,086 - qa_analytics - INFO - Parsed formula: IFS(   Risk_Level="Critical", "Urgent",    Risk_Level="High", "Important",    Risk_Level="Medium", "Normal",    Risk_Level="Low", "Low Priority") = "Important" -> (np.where(df['Risk_Level']=="Critical", "Urgent", np.where(df['Risk_Level']=="High", "Important", np.where(df['Risk_Level']=="Medium", "Normal", np.where(df['Risk_Level']=="Low", "Low Priority", pd.Series(np.nan, index=df.index)))))"Important")
2025-05-14 15:03:56,086 - qa_analytics - INFO - Parsed formula: IFS(   Risk_Level="Critical", "Urgent",    Risk_Level="High", "Important",    Risk_Level="Medium", "Normal",    Risk_Level="Low", "Low Priority") = "Important" -> (np.where(df['Risk_Level']=="Critical", "Urgent", np.where(df['Risk_Level']=="High", "Important", np.where(df['Risk_Level']=="Medium", "Normal", np.where(df['Risk_Level']=="Low", "Low Priority", pd.Series(np.nan, index=df.index)))))"Important")
2025-05-14 15:03:56,086 - qa_analytics - ERROR - Custom formula failed: invalid syntax. Perhaps you forgot a comma? (<string>, line 1), Formula: IFS(   Risk_Level="Critical", "Urgent",    Risk_Level="High", "Important",    Risk_Level="Medium", "Normal",    Risk_Level="Low", "Low Priority") = "Important"
2025-05-14 15:03:56,087 - qa_analytics - INFO - Parsed formula: Risk_Level IN ("High", "Critical") -> (df['Risk_Level'].isin(["High", "Critical"]))
2025-05-14 15:03:56,088 - qa_analytics - INFO - Parsed formula: Risk_Level IN ("High", "Critical") -> (df['Risk_Level'].isin(["High", "Critical"]))
2025-05-14 15:03:56,088 - qa_analytics - INFO - Parsed formula: Owner IN ("John") -> (df['Owner'].isin(["John"]))
2025-05-14 15:03:56,088 - qa_analytics - INFO - Parsed formula: Owner IN ("John") -> (df['Owner'].isin(["John"]))
2025-05-14 15:03:56,088 - qa_analytics - INFO - Parsed formula: Value IN (50, 75, 100) -> (df['Value'].isin([50, 75, 100]))
2025-05-14 15:03:56,088 - qa_analytics - INFO - Parsed formula: Value IN (50, 75, 100) -> (df['Value'].isin([50, 75, 100]))
2025-05-14 15:03:56,089 - qa_analytics - INFO - Parsed formula: Risk_Level IN ("Medium", "Low") -> (df['Risk_Level'].isin(["Medium", "Low"]))
2025-05-14 15:03:56,089 - qa_analytics - INFO - Parsed formula: Risk_Level IN ("Medium", "Low") -> (df['Risk_Level'].isin(["Medium", "Low"]))
2025-05-14 15:03:56,090 - qa_analytics - INFO - Parsed formula: Risk_Level = "High" AND Value > 100 -> (df['Risk_Level']=="High") & (df['Value']>100)
2025-05-14 15:03:56,090 - qa_analytics - INFO - Parsed formula: Risk_Level = "High" AND Value > 100 -> (df['Risk_Level']=="High") & (df['Value']>100)
2025-05-14 15:03:56,091 - qa_analytics - INFO - Parsed formula: Risk_Level = "High" OR Value > 100 -> (df['Risk_Level']=="High") | (df['Value']>100)
2025-05-14 15:03:56,091 - qa_analytics - INFO - Parsed formula: Risk_Level = "High" OR Value > 100 -> (df['Risk_Level']=="High") | (df['Value']>100)
2025-05-14 15:03:56,091 - qa_analytics - INFO - Parsed formula: NOT(Risk_Level = "High") -> (~(df['Risk_Level']=="High"))
2025-05-14 15:03:56,091 - qa_analytics - INFO - Parsed formula: NOT(Risk_Level = "High") -> (~(df['Risk_Level']=="High"))
2025-05-14 15:03:56,092 - qa_analytics - INFO - Parsed formula: Risk_Level = "High" AND NOT(Value < 100) -> (df['Risk_Level']=="High") & (~(df['Value']<100))
2025-05-14 15:03:56,092 - qa_analytics - INFO - Parsed formula: Risk_Level = "High" AND NOT(Value < 100) -> (df['Risk_Level']=="High") & (~(df['Value']<100))
2025-05-14 15:03:56,092 - qa_analytics - INFO - Parsed formula: (Value > 100 AND Risk_Level = "High") OR Risk_Level = "Critical" -> (df['Value']>100&df['Risk_Level']=="High") | (df['Risk_Level']=="Critical")
2025-05-14 15:03:56,092 - qa_analytics - INFO - Parsed formula: (Value > 100 AND Risk_Level = "High") OR Risk_Level = "Critical" -> (df['Value']>100&df['Risk_Level']=="High") | (df['Risk_Level']=="Critical")
2025-05-14 15:03:56,093 - qa_analytics - ERROR - Custom formula failed: Cannot perform 'rand_' with a dtyped [object] array and scalar of type [bool], Formula: (Value > 100 AND Risk_Level = "High") OR Risk_Level = "Critical"
2025-05-14 15:03:56,094 - qa_analytics - INFO - Parsed formula: LEFT(Text_Field, 3) = "ABC" -> (df['Text_Field'].astype(str).str[:int(3)]"ABC")
2025-05-14 15:03:56,094 - qa_analytics - INFO - Parsed formula: LEFT(Text_Field, 3) = "ABC" -> (df['Text_Field'].astype(str).str[:int(3)]"ABC")
2025-05-14 15:03:56,094 - qa_analytics - ERROR - Custom formula failed: invalid syntax. Perhaps you forgot a comma? (<string>, line 1), Formula: LEFT(Text_Field, 3) = "ABC"
2025-05-14 15:03:56,094 - qa_analytics - INFO - Parsed formula: RIGHT(Text_Field, 3) = "789" -> (df['Text_Field'].astype(str).str[-int(3):]"789")
2025-05-14 15:03:56,095 - qa_analytics - INFO - Parsed formula: RIGHT(Text_Field, 3) = "789" -> (df['Text_Field'].astype(str).str[-int(3):]"789")
2025-05-14 15:03:56,095 - qa_analytics - ERROR - Custom formula failed: invalid syntax. Perhaps you forgot a comma? (<string>, line 1), Formula: RIGHT(Text_Field, 3) = "789"
2025-05-14 15:03:56,095 - qa_analytics - INFO - Parsed formula: TRIM(Text_Field) = Text_Field -> (df['Text_Field'].astype(str).str.strip()df['Text_Field'])
2025-05-14 15:03:56,095 - qa_analytics - INFO - Parsed formula: TRIM(Text_Field) = Text_Field -> (df['Text_Field'].astype(str).str.strip()df['Text_Field'])
2025-05-14 15:03:56,095 - qa_analytics - ERROR - Custom formula failed: invalid syntax. Perhaps you forgot a comma? (<string>, line 1), Formula: TRIM(Text_Field) = Text_Field
2025-05-14 15:03:56,096 - qa_analytics - INFO - Parsed formula: Owner <> "John" OR Risk_Level <> "High" -> (df['Owner']!="John") | (df['Risk_Level']!="High")
2025-05-14 15:03:56,096 - qa_analytics - INFO - Parsed formula: Owner <> "John" OR Risk_Level <> "High" -> (df['Owner']!="John") | (df['Risk_Level']!="High")
2025-05-14 15:03:56,096 - qa_analytics - INFO - Parsed formula: Submit_Date <= Approval_Date -> (df['Submit_Date']<=df['Approval_Date'])
2025-05-14 15:03:56,097 - qa_analytics - INFO - Parsed formula: Submit_Date <= Approval_Date -> (df['Submit_Date']<=df['Approval_Date'])
2025-05-14 15:03:56,097 - qa_analytics - INFO - Parsed formula: IF(Third_Party <> "", Risk_Level IN ("High", "Critical"), Risk_Level = "Low") -> (np.where(df['Third_Party']!="", df['Risk_Level'].isin("High","Critical"), df['Risk_Level']=="Low"))
2025-05-14 15:03:56,097 - qa_analytics - INFO - Parsed formula: IF(Third_Party <> "", Risk_Level IN ("High", "Critical"), Risk_Level = "Low") -> (np.where(df['Third_Party']!="", df['Risk_Level'].isin("High","Critical"), df['Risk_Level']=="Low"))
2025-05-14 15:03:56,097 - qa_analytics - ERROR - Custom formula failed: Series.isin() takes 2 positional arguments but 3 were given, Formula: IF(Third_Party <> "", Risk_Level IN ("High", "Critical"), Risk_Level = "Low")
2025-05-14 15:03:56,097 - qa_analytics - INFO - Parsed formula: IF(Risk_Level = "Critical", Days_Open <= 7, IF(Risk_Level = "High", Days_Open <= 30, Days_Open <= 90)) -> (np.where(df['Risk_Level']=="Critical", df['Days_Open']<=7, df['IF'](df['Risk_Level']=="High",df['Days_Open']<=30,df['Days_Open']<=90)))
2025-05-14 15:03:56,098 - qa_analytics - INFO - Parsed formula: IF(Risk_Level = "Critical", Days_Open <= 7, IF(Risk_Level = "High", Days_Open <= 30, Days_Open <= 90)) -> (np.where(df['Risk_Level']=="Critical", df['Days_Open']<=7, df['IF'](df['Risk_Level']=="High",df['Days_Open']<=30,df['Days_Open']<=90)))
2025-05-14 15:03:56,098 - qa_analytics - INFO - Parsed formula: (Risk_Level IN ("High", "Critical") AND Value > 100) OR (Risk_Level = "Medium" AND Value <= 100) -> (df['Risk_Level'].isin(["High", "Critical"])&df['Value']>100) | (df['Risk_Level']=="Medium"&df['Value']<=100)
2025-05-14 15:03:56,098 - qa_analytics - INFO - Parsed formula: (Risk_Level IN ("High", "Critical") AND Value > 100) OR (Risk_Level = "Medium" AND Value <= 100) -> (df['Risk_Level'].isin(["High", "Critical"])&df['Value']>100) | (df['Risk_Level']=="Medium"&df['Value']<=100)
2025-05-14 15:03:56,098 - qa_analytics - ERROR - Custom formula failed: Cannot perform 'rand_' with a dtyped [int64] array and scalar of type [bool], Formula: (Risk_Level IN ("High", "Critical") AND Value > 100) OR (Risk_Level = "Medium" AND Value <= 100)
2025-05-14 15:42:22,465 - qa_analytics - INFO - Parsed formula: __FIELD_0__ = "High" -> (df['Risk Level'] == "High")
2025-05-14 15:42:22,465 - qa_analytics - INFO - Parsed formula: __FIELD_0__ = "High" -> (df['Risk Level'] == "High")
2025-05-14 15:42:22,466 - qa_analytics - INFO - Parsed formula: __FIELD_0__ IN ("High", "Critical") -> (df['Risk Level'].isin(["High", "Critical"]))
2025-05-14 15:42:22,466 - qa_analytics - INFO - Parsed formula: __FIELD_0__ IN ("High", "Critical") -> (df['Risk Level'].isin(["High", "Critical"]))
2025-05-14 15:42:22,467 - qa_analytics - INFO - Parsed formula: IF(__FIELD_1__="High", __FIELD_0__ > "2025-02-01", False) -> (np.where(df['Risk Level']=="High", df['Approval Date']>"2025-02-01", False))
2025-05-14 15:42:22,467 - qa_analytics - INFO - Parsed formula: IF(__FIELD_1__="High", __FIELD_0__ > "2025-02-01", False) -> (np.where(df['Risk Level']=="High", df['Approval Date']>"2025-02-01", False))
2025-05-14 15:42:22,469 - qa_analytics - INFO - Parsed formula: Value -> ((df['Value'])) > 100
2025-05-14 15:42:22,469 - qa_analytics - INFO - Parsed formula: Value -> ((df['Value'])) > 100
2025-05-14 15:42:22,470 - qa_analytics - INFO - Parsed formula: Value -> ((df['Value'])) < 100
2025-05-14 15:42:22,470 - qa_analytics - INFO - Parsed formula: Value -> ((df['Value'])) < 100
2025-05-14 15:42:22,470 - qa_analytics - INFO - Parsed formula: Value -> ((df['Value'])) == 150
2025-05-14 15:42:22,470 - qa_analytics - INFO - Parsed formula: Value -> ((df['Value'])) == 150
2025-05-14 15:42:22,470 - qa_analytics - INFO - Parsed formula: Value -> ((df['Value'])) != 150
2025-05-14 15:42:22,470 - qa_analytics - INFO - Parsed formula: Value -> ((df['Value'])) != 150
2025-05-14 15:42:22,471 - qa_analytics - INFO - Parsed formula: Value -> ((df['Value'])) >= 150
2025-05-14 15:42:22,471 - qa_analytics - INFO - Parsed formula: Value -> ((df['Value'])) >= 150
2025-05-14 15:42:22,471 - qa_analytics - INFO - Parsed formula: Value -> ((df['Value'])) <= 75
2025-05-14 15:42:22,471 - qa_analytics - INFO - Parsed formula: Value -> ((df['Value'])) <= 75
2025-05-14 15:42:22,472 - qa_analytics - INFO - Parsed formula: IF(Risk_Level IN ("High", "Critical"),    Days_Open AND Value>100,    Days_Open<=90 AND Value<200) -> ((]<=90 ) & ( df[)'Value']<200)) <= 30
2025-05-14 15:42:22,473 - qa_analytics - INFO - Parsed formula: IF(Risk_Level IN ("High", "Critical"),    Days_Open AND Value>100,    Days_Open<=90 AND Value<200) -> ((]<=90 ) & ( df[)'Value']<200)) <= 30
2025-05-14 15:42:22,473 - qa_analytics - ERROR - Custom formula failed: closing parenthesis ']' does not match opening parenthesis '(' (<string>, line 1), Formula: IF(Risk_Level IN ("High", "Critical"),    Days_Open<=30 AND Value>100,    Days_Open<=90 AND Value<200)
2025-05-14 15:42:22,473 - qa_analytics - INFO - Parsed formula: IF(ISBLANK(Third_Party), "N/A",    IF(Risk_Level IN ("High", "Critical"), "DNC", "GC"))/A" -> ((np.where(df['ISBLANK'](df['Third_Party']), "N/A", df['IF'](df['Risk_Level'].isin("High","Critical"),"DNC","GC")) df['A'])) == "N
2025-05-14 15:42:22,473 - qa_analytics - INFO - Parsed formula: IF(ISBLANK(Third_Party), "N/A",    IF(Risk_Level IN ("High", "Critical"), "DNC", "GC"))/A" -> ((np.where(df['ISBLANK'](df['Third_Party']), "N/A", df['IF'](df['Risk_Level'].isin("High","Critical"),"DNC","GC")) df['A'])) == "N
2025-05-14 15:42:22,474 - qa_analytics - INFO - Parsed formula: NOT(Risk_Level IN ("High", "Critical")) OR (Submit_Date AND Days_Open <= 30) -> ((]  ) & (  df[)'Days_Open'] <= 30 )) <= Approval_Date
2025-05-14 15:42:22,474 - qa_analytics - INFO - Parsed formula: NOT(Risk_Level IN ("High", "Critical")) OR (Submit_Date AND Days_Open <= 30) -> ((]  ) & (  df[)'Days_Open'] <= 30 )) <= Approval_Date
2025-05-14 15:42:22,474 - qa_analytics - ERROR - Custom formula failed: closing parenthesis ']' does not match opening parenthesis '(' (<string>, line 1), Formula: NOT(Risk_Level IN ("High", "Critical")) OR (Submit_Date <= Approval_Date AND Days_Open <= 30)
2025-05-14 15:42:22,475 - qa_analytics - INFO - Parsed formula: Submit_Date -> ((df['Submit_Date'])) <= Approval_Date
2025-05-14 15:42:22,475 - qa_analytics - INFO - Parsed formula: Submit_Date -> ((df['Submit_Date'])) <= Approval_Date
2025-05-14 15:42:22,475 - qa_analytics - ERROR - Custom formula failed: name 'Approval_Date' is not defined, Formula: Submit_Date <= Approval_Date
2025-05-14 15:42:22,476 - qa_analytics - INFO - Parsed formula: (Approval_Date - Submit_Date).dt.days -> ((( df['Approval_Date Submit_Date'] ) df['dt'] df['days'])) <= 10
2025-05-14 15:42:22,476 - qa_analytics - INFO - Parsed formula: (Approval_Date - Submit_Date).dt.days -> ((( df['Approval_Date Submit_Date'] ) df['dt'] df['days'])) <= 10
2025-05-14 15:42:22,476 - qa_analytics - INFO - Parsed formula: DATEDIF(Submit_Date, Approval_Date, "D") -> (((pd.to_datetime(df['Approval_Date'], errors='coerce') - pd.to_datetime(df['Submit_Date'], errors='coerce')).dt.days)) > 10
2025-05-14 15:42:22,476 - qa_analytics - INFO - Parsed formula: DATEDIF(Submit_Date, Approval_Date, "D") -> (((pd.to_datetime(df['Approval_Date'], errors='coerce') - pd.to_datetime(df['Submit_Date'], errors='coerce')).dt.days)) > 10
2025-05-14 15:42:22,479 - qa_analytics - ERROR - IN operator has no preceding field
2025-05-14 15:42:22,479 - qa_analytics - INFO - Parsed formula: IN ("High", "Medium") -> (pd.Series(False, index=df.index) ( "High" , "Medium" ))
2025-05-14 15:42:22,479 - qa_analytics - ERROR - Custom formula failed: 'Series' object is not callable, Formula: IN ("High", "Medium")
2025-05-14 15:42:22,479 - qa_analytics - INFO - Parsed formula: Risk_Level =  -> (df['Risk_Level'] ==)
2025-05-14 15:42:22,479 - qa_analytics - ERROR - Custom formula failed: invalid syntax (<string>, line 1), Formula: Risk_Level = 
2025-05-14 15:42:22,479 - qa_analytics - WARNING - Not enough arguments for function, expected at least 3, got 1
2025-05-14 15:42:22,480 - qa_analytics - INFO - Parsed formula: IF(Risk_Level) -> ((np.where(df['Risk_Level'], pd.Series(np.nan, index=df.index), pd.Series(np.nan, index=df.index)))) == "High"
2025-05-14 15:42:22,480 - qa_analytics - INFO - Parsed formula: UNKNOWNFUNC(Value) -> (df['UNKNOWNFUNC'] ( df['Value'] ))
2025-05-14 15:42:22,487 - qa_analytics - INFO - Parsed formula: IF(Risk_Level, Days_Open<=30, Days_Open<=90) -> ((np.where(df['Risk_Level'], df['Days_Open']<=30, df['Days_Open']<=90))) == "High"
2025-05-14 15:42:22,487 - qa_analytics - INFO - Parsed formula: IF(Risk_Level, Days_Open<=30, Days_Open<=90) -> ((np.where(df['Risk_Level'], df['Days_Open']<=30, df['Days_Open']<=90))) == "High"
2025-05-14 15:42:22,487 - qa_analytics - INFO - Parsed formula: IF(Value, "High", "Low") = "High" -> ((np.where(df['Value'], "High", "Low") == "High")) > 100
2025-05-14 15:42:22,488 - qa_analytics - INFO - Parsed formula: IF(Value, "High", "Low") = "High" -> ((np.where(df['Value'], "High", "Low") == "High")) > 100
2025-05-14 15:42:22,489 - qa_analytics - INFO - Parsed formula: IF(Owner, Value>100, Value<100) = True -> ((np.where(df['Owner'], df['Value']>100, df['Value']<100) == True)) == "John"
2025-05-14 15:42:22,489 - qa_analytics - INFO - Parsed formula: IF(Owner, Value>100, Value<100) = True -> ((np.where(df['Owner'], df['Value']>100, df['Value']<100) == True)) == "John"
2025-05-14 15:42:22,489 - qa_analytics - INFO - Parsed formula: IF(Third_Party, "N/A", "Has TP") = "N/A" -> ((np.where(df['Third_Party'], "N/A", "Has TP") == "N/A")) == ""
2025-05-14 15:42:22,489 - qa_analytics - INFO - Parsed formula: IF(Third_Party, "N/A", "Has TP") = "N/A" -> ((np.where(df['Third_Party'], "N/A", "Has TP") == "N/A")) == ""
2025-05-14 15:42:22,490 - qa_analytics - INFO - Parsed formula: IFS(   Risk_Level, "Urgent",    Risk_Level="High", "Important",    Risk_Level="Medium", "Normal",    Risk_Level="Low", "Low Priority") = "Important" -> ((np.where(df['Risk_Level'], "Urgent", np.where(df['Risk_Level']=="High", "Important", np.where(df['Risk_Level']=="Medium", "Normal", np.where(df['Risk_Level']=="Low", "Low Priority", pd.Series(np.nan, index=df.index))))) == "Important")) == "Critical"
2025-05-14 15:42:22,491 - qa_analytics - INFO - Parsed formula: IFS(   Risk_Level, "Urgent",    Risk_Level="High", "Important",    Risk_Level="Medium", "Normal",    Risk_Level="Low", "Low Priority") = "Important" -> ((np.where(df['Risk_Level'], "Urgent", np.where(df['Risk_Level']=="High", "Important", np.where(df['Risk_Level']=="Medium", "Normal", np.where(df['Risk_Level']=="Low", "Low Priority", pd.Series(np.nan, index=df.index))))) == "Important")) == "Critical"
2025-05-14 15:42:22,492 - qa_analytics - INFO - Parsed formula: Risk_Level IN ("High", "Critical") -> (df['Risk_Level'].isin(["High", "Critical"]))
2025-05-14 15:42:22,492 - qa_analytics - INFO - Parsed formula: Risk_Level IN ("High", "Critical") -> (df['Risk_Level'].isin(["High", "Critical"]))
2025-05-14 15:42:22,492 - qa_analytics - INFO - Parsed formula: Owner IN ("John") -> (df['Owner'].isin(["John"]))
2025-05-14 15:42:22,492 - qa_analytics - INFO - Parsed formula: Owner IN ("John") -> (df['Owner'].isin(["John"]))
2025-05-14 15:42:22,493 - qa_analytics - INFO - Parsed formula: Value IN (50, 75, 100) -> (df['Value'].isin([50, 75, 100]))
2025-05-14 15:42:22,493 - qa_analytics - INFO - Parsed formula: Value IN (50, 75, 100) -> (df['Value'].isin([50, 75, 100]))
2025-05-14 15:42:22,493 - qa_analytics - INFO - Parsed formula: Risk_Level IN ("Medium", "Low") -> (df['Risk_Level'].isin(["Medium", "Low"]))
2025-05-14 15:42:22,493 - qa_analytics - INFO - Parsed formula: Risk_Level IN ("Medium", "Low") -> (df['Risk_Level'].isin(["Medium", "Low"]))
2025-05-14 15:42:22,494 - qa_analytics - INFO - Parsed formula: Risk_Level AND Value > 100 -> (((]  ) & (  df[)'Value'] > 100)) == "High"
2025-05-14 15:42:22,494 - qa_analytics - INFO - Parsed formula: Risk_Level AND Value > 100 -> (((]  ) & (  df[)'Value'] > 100)) == "High"
2025-05-14 15:42:22,494 - qa_analytics - ERROR - Custom formula failed: closing parenthesis ']' does not match opening parenthesis '(' (<string>, line 1), Formula: Risk_Level = "High" AND Value > 100
2025-05-14 15:42:22,494 - qa_analytics - INFO - Parsed formula: Risk_Level OR Value > 100 -> (((]  ) | (  df[)'Value'] > 100)) == "High"
2025-05-14 15:42:22,495 - qa_analytics - INFO - Parsed formula: Risk_Level OR Value > 100 -> (((]  ) | (  df[)'Value'] > 100)) == "High"
2025-05-14 15:42:22,495 - qa_analytics - ERROR - Custom formula failed: closing parenthesis ']' does not match opening parenthesis '(' (<string>, line 1), Formula: Risk_Level = "High" OR Value > 100
2025-05-14 15:42:22,495 - qa_analytics - INFO - Parsed formula: NOT(Risk_Level) -> ((~ ( df['Risk_Level'] ))) == "High"
2025-05-14 15:42:22,495 - qa_analytics - INFO - Parsed formula: NOT(Risk_Level) -> ((~ ( df['Risk_Level'] ))) == "High"
2025-05-14 15:42:22,495 - qa_analytics - ERROR - Custom formula failed: bad operand type for unary ~: 'str', Formula: NOT(Risk_Level = "High")
2025-05-14 15:42:22,495 - qa_analytics - INFO - Parsed formula: Risk_Level AND NOT(Value < 100) -> ((]  ) & (  ~ )( df['Value'] < 100 )) == "High"
2025-05-14 15:42:22,495 - qa_analytics - INFO - Parsed formula: Risk_Level AND NOT(Value < 100) -> ((]  ) & (  ~ )( df['Value'] < 100 )) == "High"
2025-05-14 15:42:22,495 - qa_analytics - ERROR - Custom formula failed: closing parenthesis ']' does not match opening parenthesis '(' (<string>, line 1), Formula: Risk_Level = "High" AND NOT(Value < 100)
2025-05-14 15:42:22,496 - qa_analytics - INFO - Parsed formula: (Value AND Risk_Level = "High") OR Risk_Level = "Critical" -> (((  ) | (  df[)'Risk_Level'] == "Critical")) > 100
2025-05-14 15:42:22,496 - qa_analytics - INFO - Parsed formula: (Value AND Risk_Level = "High") OR Risk_Level = "Critical" -> (((  ) | (  df[)'Risk_Level'] == "Critical")) > 100
2025-05-14 15:42:22,496 - qa_analytics - ERROR - Custom formula failed: closing parenthesis ')' does not match opening parenthesis '[' (<string>, line 1), Formula: (Value > 100 AND Risk_Level = "High") OR Risk_Level = "Critical"
2025-05-14 15:42:22,496 - qa_analytics - INFO - Parsed formula: LEFT(Text_Field, 3) -> ((df['Text_Field'].astype(str).str[:int(3)])) == "ABC"
2025-05-14 15:42:22,497 - qa_analytics - INFO - Parsed formula: LEFT(Text_Field, 3) -> ((df['Text_Field'].astype(str).str[:int(3)])) == "ABC"
2025-05-14 15:42:22,497 - qa_analytics - ERROR - Custom formula failed: name 'str' is not defined, Formula: LEFT(Text_Field, 3) = "ABC"
2025-05-14 15:42:22,497 - qa_analytics - INFO - Parsed formula: RIGHT(Text_Field, 3) -> ((df['Text_Field'].astype(str).str[-int(3):])) == "789"
2025-05-14 15:42:22,497 - qa_analytics - INFO - Parsed formula: RIGHT(Text_Field, 3) -> ((df['Text_Field'].astype(str).str[-int(3):])) == "789"
2025-05-14 15:42:22,497 - qa_analytics - ERROR - Custom formula failed: name 'str' is not defined, Formula: RIGHT(Text_Field, 3) = "789"
2025-05-14 15:42:22,497 - qa_analytics - INFO - Parsed formula: TRIM(Text_Field) -> ((df['Text_Field'].astype(str).str.strip())) == Text_Field
2025-05-14 15:42:22,498 - qa_analytics - INFO - Parsed formula: TRIM(Text_Field) -> ((df['Text_Field'].astype(str).str.strip())) == Text_Field
2025-05-14 15:42:22,498 - qa_analytics - ERROR - Custom formula failed: name 'str' is not defined, Formula: TRIM(Text_Field) = Text_Field
2025-05-14 15:42:22,499 - qa_analytics - INFO - Parsed formula: Owner OR Risk_Level <> "High" -> (((]  ) | (  df[)'Risk_Level'] != "High")) != "John"
2025-05-14 15:42:22,499 - qa_analytics - INFO - Parsed formula: Owner OR Risk_Level <> "High" -> (((]  ) | (  df[)'Risk_Level'] != "High")) != "John"
2025-05-14 15:42:22,499 - qa_analytics - ERROR - Custom formula failed: closing parenthesis ']' does not match opening parenthesis '(' (<string>, line 1), Formula: Owner <> "John" OR Risk_Level <> "High"
2025-05-14 15:42:22,499 - qa_analytics - INFO - Parsed formula: Submit_Date -> ((df['Submit_Date'])) <= Approval_Date
2025-05-14 15:42:22,499 - qa_analytics - INFO - Parsed formula: Submit_Date -> ((df['Submit_Date'])) <= Approval_Date
2025-05-14 15:42:22,499 - qa_analytics - ERROR - Custom formula failed: name 'Approval_Date' is not defined, Formula: Submit_Date <= Approval_Date
2025-05-14 15:42:22,499 - qa_analytics - INFO - Parsed formula: IF(Third_Party, Risk_Level IN ("High", "Critical"), Risk_Level = "Low") -> ((np.where(df['Third_Party'], df['Risk_Level'].isin("High","Critical"), df['Risk_Level']=="Low"))) != ""
2025-05-14 15:42:22,500 - qa_analytics - INFO - Parsed formula: IF(Third_Party, Risk_Level IN ("High", "Critical"), Risk_Level = "Low") -> ((np.where(df['Third_Party'], df['Risk_Level'].isin("High","Critical"), df['Risk_Level']=="Low"))) != ""
2025-05-14 15:42:22,500 - qa_analytics - ERROR - Custom formula failed: Series.isin() takes 2 positional arguments but 3 were given, Formula: IF(Third_Party <> "", Risk_Level IN ("High", "Critical"), Risk_Level = "Low")
2025-05-14 15:42:22,500 - qa_analytics - INFO - Parsed formula: IF(Risk_Level, Days_Open <= 7, IF(Risk_Level = "High", Days_Open <= 30, Days_Open <= 90)) -> ((np.where(df['Risk_Level'], df['Days_Open']<=7, df['IF'](df['Risk_Level']=="High",df['Days_Open']<=30,df['Days_Open']<=90)))) == "Critical"
2025-05-14 15:42:22,500 - qa_analytics - INFO - Parsed formula: IF(Risk_Level, Days_Open <= 7, IF(Risk_Level = "High", Days_Open <= 30, Days_Open <= 90)) -> ((np.where(df['Risk_Level'], df['Days_Open']<=7, df['IF'](df['Risk_Level']=="High",df['Days_Open']<=30,df['Days_Open']<=90)))) == "Critical"
2025-05-14 15:42:22,501 - qa_analytics - INFO - Parsed formula: (Risk_Level IN ("High", "Critical") AND Value) OR (Risk_Level = "Medium" AND Value <= 100) -> ((  ) & (  df[)'Value'] <= 100 )) > 100
2025-05-14 15:42:22,501 - qa_analytics - INFO - Parsed formula: (Risk_Level IN ("High", "Critical") AND Value) OR (Risk_Level = "Medium" AND Value <= 100) -> ((  ) & (  df[)'Value'] <= 100 )) > 100
2025-05-14 15:42:22,501 - qa_analytics - ERROR - Custom formula failed: closing parenthesis ')' does not match opening parenthesis '[' (<string>, line 1), Formula: (Risk_Level IN ("High", "Critical") AND Value > 100) OR (Risk_Level = "Medium" AND Value <= 100)
2025-05-14 21:18:22,781 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-14 21:18:23,099 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-14 21:18:23,106 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-14 21:18:23,111 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-14 21:18:23,117 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-14 21:18:23,122 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-14 21:18:23,127 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-14 21:18:23,133 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-14 21:18:23,138 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-14 21:18:23,140 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-14 21:18:23,149 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-14 21:18:23,149 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-14 21:18:23,158 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-14 21:18:23,166 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-14 21:18:23,181 - qa_analytics - INFO - Loaded template metadata
2025-05-14 21:18:23,181 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-14 21:19:16,611 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-14 21:19:16,660 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-14 21:19:16,662 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-14 21:19:16,663 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-14 21:19:16,664 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-14 21:19:16,665 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-14 21:19:16,666 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-14 21:19:16,668 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-14 21:19:16,668 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-14 21:19:16,670 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-14 21:19:16,679 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-14 21:19:16,679 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-14 21:19:16,682 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-14 21:19:16,685 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-14 21:19:16,690 - qa_analytics - INFO - Loaded template metadata
2025-05-14 21:19:16,691 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-14 21:19:27,394 - qa_analytics - INFO - User preferences saved
2025-05-14 21:19:38,625 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-14 21:19:38,625 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-14 21:21:39,667 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-14 21:21:39,713 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-14 21:21:39,715 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-14 21:21:39,716 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-14 21:21:39,718 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-14 21:21:39,719 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-14 21:21:39,720 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-14 21:21:39,721 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-14 21:21:39,722 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-14 21:21:39,723 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-14 21:21:39,732 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-14 21:21:39,732 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-14 21:21:39,736 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-14 21:21:39,738 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-14 21:21:39,744 - qa_analytics - INFO - Loaded template metadata
2025-05-14 21:21:39,744 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-14 21:21:53,325 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-14 21:21:53,326 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-14 21:22:50,337 - qa_analytics - INFO - Successfully generated configuration for template risk_assessment
2025-05-14 21:24:01,268 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-14 21:24:01,315 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-14 21:24:01,317 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-14 21:24:01,318 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-14 21:24:01,319 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-14 21:24:01,320 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-14 21:24:01,321 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-14 21:24:01,322 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-14 21:24:01,323 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-14 21:24:01,324 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-14 21:24:01,334 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-14 21:24:01,334 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-14 21:24:01,337 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-14 21:24:01,338 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-14 21:24:01,341 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-14 21:24:01,346 - qa_analytics - INFO - Loaded template metadata
2025-05-14 21:24:01,347 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-14 21:24:06,278 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-14 21:24:06,278 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-14 21:24:24,665 - formula_parser - INFO - Parsed formula: i -> (df['i'])
2025-05-14 21:24:24,725 - formula_parser - INFO - Parsed formula: if -> (df['if'])
2025-05-14 21:24:26,022 - formula_parser - INFO - Parsed formula: if= -> (df['if'] ==)
2025-05-14 21:24:26,543 - formula_parser - INFO - Parsed formula: if -> (df['if'])
2025-05-14 21:24:27,128 - formula_parser - INFO - Parsed formula: i -> (df['i'])
2025-05-14 21:24:30,439 - formula_parser - INFO - Parsed formula: i -> (df['i'])
2025-05-14 21:24:30,487 - formula_parser - INFO - Parsed formula: if -> (df['if'])
2025-05-14 21:24:31,207 - formula_parser - ERROR - IF requires 3 arguments, got 0
2025-05-14 21:24:31,207 - formula_parser - INFO - Parsed formula: if( -> (pd.Series(np.nan, index=df.index))
2025-05-14 21:24:34,511 - formula_parser - ERROR - IF requires 3 arguments, got 0
2025-05-14 21:24:34,511 - formula_parser - INFO - Parsed formula: if(a -> (pd.Series(np.nan, index=df.index))
2025-05-14 21:24:35,079 - formula_parser - ERROR - IF requires 3 arguments, got 0
2025-05-14 21:24:35,080 - formula_parser - INFO - Parsed formula: if(a2 -> (pd.Series(np.nan, index=df.index))
2025-05-14 21:24:35,783 - formula_parser - ERROR - IF requires 3 arguments, got 0
2025-05-14 21:24:35,783 - formula_parser - INFO - Parsed formula: if(a -> (pd.Series(np.nan, index=df.index))
2025-05-14 21:24:36,535 - formula_parser - ERROR - IF requires 3 arguments, got 0
2025-05-14 21:24:36,535 - formula_parser - INFO - Parsed formula: if( -> (pd.Series(np.nan, index=df.index))
2025-05-14 21:24:47,759 - formula_parser - INFO - Parsed formula: i -> (df['i'])
2025-05-14 21:24:47,837 - formula_parser - INFO - Parsed formula: if -> (df['if'])
2025-05-14 21:24:47,951 - formula_parser - INFO - Parsed formula: if  -> (df['if'])
2025-05-14 21:24:48,622 - formula_parser - INFO - Parsed formula: if -> (df['if'])
2025-05-14 21:24:48,919 - formula_parser - ERROR - IF requires 3 arguments, got 0
2025-05-14 21:24:48,919 - formula_parser - INFO - Parsed formula: if( -> (pd.Series(np.nan, index=df.index))
2025-05-14 21:24:49,567 - formula_parser - ERROR - IF requires 3 arguments, got 0
2025-05-14 21:24:49,568 - formula_parser - INFO - Parsed formula: if(a -> (pd.Series(np.nan, index=df.index))
2025-05-14 21:24:49,903 - formula_parser - ERROR - IF requires 3 arguments, got 0
2025-05-14 21:24:49,903 - formula_parser - INFO - Parsed formula: if(a2 -> (pd.Series(np.nan, index=df.index))
2025-05-14 21:24:50,303 - formula_parser - ERROR - IF requires 3 arguments, got 0
2025-05-14 21:24:50,304 - formula_parser - INFO - Parsed formula: if(a2= -> (pd.Series(np.nan, index=df.index))
2025-05-14 21:24:50,791 - formula_parser - ERROR - IF requires 3 arguments, got 0
2025-05-14 21:24:50,792 - formula_parser - INFO - Parsed formula: if(a2 -> ((pd.Series(np.nan, index=df.index)) == df['b'])
2025-05-14 21:24:50,958 - formula_parser - ERROR - IF requires 3 arguments, got 0
2025-05-14 21:24:50,959 - formula_parser - INFO - Parsed formula: if(a2 -> ((pd.Series(np.nan, index=df.index)) == df['b2'])
2025-05-14 21:24:52,223 - formula_parser - ERROR - IF requires 3 arguments, got 0
2025-05-14 21:24:52,223 - formula_parser - INFO - Parsed formula: if(a2 -> ((pd.Series(np.nan, index=df.index)) == df['b'])
2025-05-14 21:24:52,374 - formula_parser - ERROR - IF requires 3 arguments, got 0
2025-05-14 21:24:52,375 - formula_parser - INFO - Parsed formula: if(a2= -> (pd.Series(np.nan, index=df.index))
2025-05-14 21:24:52,503 - formula_parser - ERROR - IF requires 3 arguments, got 0
2025-05-14 21:24:52,503 - formula_parser - INFO - Parsed formula: if(a2 -> (pd.Series(np.nan, index=df.index))
2025-05-14 21:24:52,655 - formula_parser - ERROR - IF requires 3 arguments, got 0
2025-05-14 21:24:52,655 - formula_parser - INFO - Parsed formula: if(a -> (pd.Series(np.nan, index=df.index))
2025-05-14 21:24:52,815 - formula_parser - ERROR - IF requires 3 arguments, got 0
2025-05-14 21:24:52,816 - formula_parser - INFO - Parsed formula: if( -> (pd.Series(np.nan, index=df.index))
2025-05-14 21:24:55,343 - formula_parser - ERROR - IF requires 3 arguments, got 0
2025-05-14 21:24:55,343 - formula_parser - INFO - Parsed formula: if($ -> (pd.Series(np.nan, index=df.index))
2025-05-14 21:24:55,935 - formula_parser - ERROR - IF requires 3 arguments, got 0
2025-05-14 21:24:55,935 - formula_parser - INFO - Parsed formula: if( -> (pd.Series(np.nan, index=df.index))
2025-05-14 21:24:56,607 - formula_parser - INFO - Parsed formula: if -> (df['if'])
2025-05-14 21:24:56,775 - formula_parser - INFO - Parsed formula: i -> (df['i'])
2025-05-14 21:25:56,958 - formula_parser - INFO - Parsed formula: A -> (df['A'])
2025-05-14 21:26:00,215 - formula_parser - INFO - Parsed formula: A  -> (df['A'])
2025-05-14 21:26:00,310 - formula_parser - INFO - Parsed formula: A = -> (df['A'] ==)
2025-05-14 21:26:00,447 - formula_parser - INFO - Parsed formula: A =  -> (df['A'] ==)
2025-05-14 21:26:00,726 - formula_parser - INFO - Parsed formula: A -> ((df['A']) == df['B'])
2025-05-14 21:26:07,287 - formula_parser - INFO - Parsed formula: A -> (df['A'])
2025-05-14 21:26:07,590 - formula_parser - INFO - Parsed formula: A  -> (df['A'])
2025-05-14 21:26:08,039 - formula_parser - INFO - Parsed formula: A > -> (df['A'] >)
2025-05-14 21:26:08,175 - formula_parser - INFO - Parsed formula: A >  -> (df['A'] >)
2025-05-14 21:26:08,406 - formula_parser - INFO - Parsed formula: A -> ((df['A']) > df['B'])
2025-05-14 21:26:13,993 - formula_parser - INFO - Parsed formula: A -> ((df['A']) > df['B'])
2025-05-14 21:26:13,993 - qa_analytics - ERROR - Custom formula failed: 'B', Formula: A > B
2025-05-14 21:26:16,770 - formula_parser - INFO - Parsed formula: A -> ((df['A']) > df['B'])
2025-05-14 21:26:16,771 - qa_analytics - ERROR - Custom formula failed: 'B', Formula: A > B
2025-05-14 21:26:22,849 - formula_parser - INFO - Parsed formula: A -> ((df['A']) > df['B'])
2025-05-14 21:26:22,849 - qa_analytics - ERROR - Custom formula failed: 'B', Formula: A > B
2025-05-14 21:26:22,968 - formula_parser - INFO - Parsed formula: A -> ((df['A']) > df['B'])
2025-05-14 21:26:22,968 - qa_analytics - ERROR - Custom formula failed: 'B', Formula: A > B
2025-05-14 21:27:12,899 - formula_parser - INFO - Parsed formula: __FIELD_1__ <= __FIELD_0__ -> (df['Submit Date'] <= df['Approval Date'])
2025-05-14 21:27:16,530 - formula_parser - INFO - Parsed formula: Submitter -> ((df['Submitter']) != df['Approver'])
2025-05-14 21:27:18,522 - formula_parser - INFO - Parsed formula: ISBLANK ( RiskRating -> (pd.isna(df['RiskRating']))
2025-05-14 21:27:18,522 - formula_parser - INFO - Parsed formula: NOT ISBLANK(RiskRating) -> (~pd.Series((pd.isna(df['RiskRating'])), index=df.index).astype(bool) ))
2025-05-14 21:27:25,271 - formula_parser - INFO - Parsed formula: __FIELD_1__ <= __FIELD_0__ -> (df['Submit Date'] <= df['Approval Date'])
2025-05-14 21:27:26,342 - qa_analytics - INFO - Successfully generated configuration for template custom_formula
2025-05-14 21:27:35,920 - qa_analytics - INFO - Successfully generated configuration for template custom_formula
2025-05-14 21:39:37,184 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-14 21:39:37,449 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-14 21:39:37,455 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-14 21:39:37,461 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-14 21:39:37,465 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-14 21:39:37,469 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-14 21:39:37,473 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-14 21:39:37,478 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-14 21:39:37,482 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-14 21:39:37,483 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-14 21:39:37,492 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-14 21:39:37,492 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-14 21:39:37,500 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-14 21:39:37,505 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-14 21:39:37,513 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-14 21:39:37,526 - qa_analytics - INFO - Loaded template metadata
2025-05-14 21:39:37,527 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-14 21:40:06,408 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-14 21:40:06,408 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-14 21:40:33,649 - formula_parser - INFO - Parsed formula: a -> (df['a'])
2025-05-14 21:40:33,807 - formula_parser - INFO - Parsed formula: a  -> (df['a'])
2025-05-14 21:40:33,950 - formula_parser - INFO - Parsed formula: a = -> (df['a'] ==)
2025-05-14 21:40:34,151 - formula_parser - INFO - Parsed formula: a =  -> (df['a'] ==)
2025-05-14 21:40:34,559 - formula_parser - INFO - Parsed formula: a -> ((df['a']) == df['b'])
2025-05-14 21:40:39,735 - formula_parser - INFO - Parsed formula: a -> ((df['a']) == df['b'])
2025-05-14 21:40:46,823 - formula_parser - INFO - Parsed formula: a -> ((df['a']) == df['b'])
2025-05-14 21:45:48,224 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-14 21:45:48,269 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-14 21:45:48,271 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-14 21:45:48,272 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-14 21:45:48,273 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-14 21:45:48,274 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-14 21:45:48,276 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-14 21:45:48,277 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-14 21:45:48,277 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-14 21:45:48,279 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-14 21:45:48,288 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-14 21:45:48,288 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-14 21:45:48,291 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-14 21:45:48,292 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-14 21:45:48,295 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-14 21:45:48,300 - qa_analytics - INFO - Loaded template metadata
2025-05-14 21:45:48,301 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-14 21:45:56,268 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-14 21:45:56,268 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-14 21:51:23,379 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-14 21:51:23,438 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-14 21:51:23,440 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-14 21:51:23,442 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-14 21:51:23,443 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-14 21:51:23,444 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-14 21:51:23,446 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-14 21:51:23,447 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-14 21:51:23,448 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-14 21:51:23,449 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-14 21:51:23,458 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-14 21:51:23,458 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-14 21:51:23,462 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-14 21:51:23,463 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-14 21:51:23,466 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-14 21:51:23,471 - qa_analytics - INFO - Loaded template metadata
2025-05-14 21:51:23,472 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-14 21:51:27,641 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-14 21:51:27,641 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-14 21:51:37,933 - formula_parser - INFO - Parsed formula: Submitter AND __FIELD_1__ <= __FIELD_0__ -> ((pd.Series(df['Submitter'], index=df.index).astype(bool)&pd.Series(df['Submit Date'] <= df['TL Date'], index=df.index).astype(bool)) != df['Approver'])
2025-05-14 21:55:48,330 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-14 21:55:48,376 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-14 21:55:48,378 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-14 21:55:48,380 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-14 21:55:48,381 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-14 21:55:48,382 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-14 21:55:48,383 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-14 21:55:48,384 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-14 21:55:48,385 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-14 21:55:48,386 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-14 21:55:48,396 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-14 21:55:48,396 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-14 21:55:48,399 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-14 21:55:48,400 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-14 21:55:48,404 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-14 21:55:48,409 - qa_analytics - INFO - Loaded template metadata
2025-05-14 21:55:48,410 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-14 21:55:55,510 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-14 21:55:55,510 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-14 21:56:10,290 - formula_parser - INFO - Parsed formula: a -> (df['a'])
2025-05-14 21:56:10,424 - formula_parser - INFO - Parsed formula: a  -> (df['a'])
2025-05-14 21:56:10,544 - formula_parser - INFO - Parsed formula: a = -> (df['a'] ==)
2025-05-14 21:56:10,631 - formula_parser - INFO - Parsed formula: a =  -> (df['a'] ==)
2025-05-14 21:56:10,696 - formula_parser - INFO - Parsed formula: a -> ((df['a']) == df['b'])
2025-05-14 21:56:12,503 - formula_parser - INFO - Parsed formula: A -> (df['A'])
2025-05-14 21:56:12,752 - formula_parser - INFO - Parsed formula: A  -> (df['A'])
2025-05-14 21:56:12,912 - formula_parser - INFO - Parsed formula: A = -> (df['A'] ==)
2025-05-14 21:56:13,055 - formula_parser - INFO - Parsed formula: A -> ((df['A']) == df['b'])
2025-05-14 21:56:13,311 - formula_parser - INFO - Parsed formula: A  -> ((df['A']) == df['b'])
2025-05-14 21:56:13,584 - formula_parser - INFO - Parsed formula: A -> ((df['A']) == df['b'])
2025-05-14 21:56:13,719 - formula_parser - INFO - Parsed formula: A = -> (df['A'] ==)
2025-05-14 21:56:13,864 - formula_parser - INFO - Parsed formula: A =  -> (df['A'] ==)
2025-05-14 21:56:14,039 - formula_parser - INFO - Parsed formula: A -> ((df['A']) == df['B'])
2025-05-14 21:57:38,059 - qa_analytics - INFO - Successfully generated configuration for template custom_formula
2025-05-14 21:59:59,309 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-14 21:59:59,358 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-14 21:59:59,360 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-14 21:59:59,361 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-14 21:59:59,362 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-14 21:59:59,363 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-14 21:59:59,364 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-14 21:59:59,366 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-14 21:59:59,367 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-14 21:59:59,368 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-14 21:59:59,377 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-14 21:59:59,377 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-14 21:59:59,381 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-14 21:59:59,382 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-14 21:59:59,385 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-14 21:59:59,390 - qa_analytics - INFO - Loaded template metadata
2025-05-14 21:59:59,391 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-14 22:00:05,734 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-14 22:00:05,734 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-14 22:00:18,162 - formula_parser - INFO - Parsed formula: A -> (df['A'])
2025-05-14 22:00:18,392 - formula_parser - INFO - Parsed formula: A  -> (df['A'])
2025-05-14 22:00:18,560 - formula_parser - INFO - Parsed formula: A = -> (df['A'] ==)
2025-05-14 22:00:18,673 - formula_parser - INFO - Parsed formula: A =  -> (df['A'] ==)
2025-05-14 22:00:18,856 - formula_parser - INFO - Parsed formula: A -> ((df['A']) == df['B'])
2025-05-14 22:00:23,716 - qa_analytics - INFO - Successfully generated configuration for template custom_formula
2025-05-14 22:02:54,022 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-14 22:02:54,022 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-14 22:05:20,758 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-14 22:05:20,758 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-15 13:30:16,761 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-15 13:30:17,061 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 13:30:17,068 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 13:30:17,073 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-15 13:30:17,078 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 13:30:17,083 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 13:30:17,088 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-15 13:30:17,094 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 13:30:17,097 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 13:30:17,099 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 13:30:17,108 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 13:30:17,108 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-15 13:30:17,117 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-15 13:30:17,122 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-15 13:30:17,129 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-15 13:30:17,145 - qa_analytics - INFO - Loaded template metadata
2025-05-15 13:30:17,146 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-15 13:30:21,326 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 13:30:21,326 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-15 13:30:35,056 - formula_parser - INFO - Parsed formula: a -> (df['a'])
2025-05-15 13:30:35,167 - formula_parser - INFO - Parsed formula: a  -> (df['a'])
2025-05-15 13:30:35,293 - formula_parser - INFO - Parsed formula: a = -> (df['a'] ==)
2025-05-15 13:30:35,478 - formula_parser - INFO - Parsed formula: a =  -> (df['a'] ==)
2025-05-15 13:30:35,695 - formula_parser - INFO - Parsed formula: a -> ((df['a']) == df['B'])
2025-05-15 13:30:36,310 - formula_parser - INFO - Parsed formula: a =  -> (df['a'] ==)
2025-05-15 13:30:36,398 - formula_parser - INFO - Parsed formula: a -> ((df['a']) == df['b'])
2025-05-15 13:30:37,849 - qa_analytics - INFO - Successfully generated configuration for template custom_formula
2025-05-15 13:31:59,242 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-15 13:31:59,291 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 13:31:59,293 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 13:31:59,294 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-15 13:31:59,295 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 13:31:59,296 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 13:31:59,297 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-15 13:31:59,299 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 13:31:59,299 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 13:31:59,300 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 13:31:59,310 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 13:31:59,310 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-15 13:31:59,313 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-15 13:31:59,314 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-15 13:31:59,317 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-15 13:31:59,322 - qa_analytics - INFO - Loaded template metadata
2025-05-15 13:31:59,323 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-15 13:32:05,941 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 13:32:05,941 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-15 13:32:16,534 - formula_parser - INFO - Parsed formula: a -> (df['a'])
2025-05-15 13:32:16,726 - formula_parser - INFO - Parsed formula: a  -> (df['a'])
2025-05-15 13:32:16,798 - formula_parser - INFO - Parsed formula: a = -> (df['a'] ==)
2025-05-15 13:32:16,918 - formula_parser - INFO - Parsed formula: a =  -> (df['a'] ==)
2025-05-15 13:32:16,991 - formula_parser - INFO - Parsed formula: a -> ((df['a']) == df['b'])
2025-05-15 13:32:18,381 - qa_analytics - INFO - Successfully generated configuration for template custom_formula
2025-05-15 13:34:12,181 - formula_parser - INFO - Parsed formula: a -> (df['a'])
2025-05-15 13:34:12,309 - formula_parser - INFO - Parsed formula: au -> (df['au'])
2025-05-15 13:34:12,341 - formula_parser - INFO - Parsed formula: aud -> (df['aud'])
2025-05-15 13:34:12,437 - formula_parser - INFO - Parsed formula: audi -> (df['audi'])
2025-05-15 13:34:12,525 - formula_parser - INFO - Parsed formula: audit -> (df['audit'])
2025-05-15 13:34:12,589 - formula_parser - INFO - Parsed formula: audit  -> (df['audit'])
2025-05-15 13:34:12,677 - formula_parser - INFO - Parsed formula: audit l -> (df['audit'] df['l'])
2025-05-15 13:34:12,765 - formula_parser - INFO - Parsed formula: audit le -> (df['audit'] df['le'])
2025-05-15 13:34:12,805 - formula_parser - INFO - Parsed formula: audit lea -> (df['audit'] df['lea'])
2025-05-15 13:34:12,957 - formula_parser - INFO - Parsed formula: audit lead -> (df['audit'] df['lead'])
2025-05-15 13:34:13,093 - formula_parser - INFO - Parsed formula: audit leade -> (df['audit'] df['leade'])
2025-05-15 13:34:13,133 - formula_parser - INFO - Parsed formula: audit leader -> (df['audit'] df['leader'])
2025-05-15 13:34:13,197 - formula_parser - INFO - Parsed formula: audit leader  -> (df['audit'] df['leader'])
2025-05-15 13:34:13,365 - formula_parser - INFO - Parsed formula: audit leader > -> (df['audit leader'] >)
2025-05-15 13:34:13,493 - formula_parser - INFO - Parsed formula: audit leader >  -> (df['audit leader'] >)
2025-05-15 13:34:14,333 - formula_parser - INFO - Parsed formula: audit leader > -> (df['audit leader'] >)
2025-05-15 13:34:14,461 - formula_parser - INFO - Parsed formula: audit leader  -> (df['audit'] df['leader'])
2025-05-15 13:34:15,183 - formula_parser - INFO - Parsed formula: audit leader = -> (df['audit leader'] ==)
2025-05-15 13:34:15,343 - formula_parser - INFO - Parsed formula: audit leader == -> (df['audit leader'] == ==)
2025-05-15 13:34:15,845 - formula_parser - INFO - Parsed formula: audit leader = -> (df['audit leader'] ==)
2025-05-15 13:34:16,030 - formula_parser - INFO - Parsed formula: audit leader =  -> (df['audit leader'] ==)
2025-05-15 13:34:17,144 - formula_parser - INFO - Parsed formula: audit leader -> ((df['audit'] df['leader']) == df['A'])
2025-05-15 13:34:17,319 - formula_parser - INFO - Parsed formula: audit leader -> ((df['audit'] df['leader']) == df['Au'])
2025-05-15 13:34:17,366 - formula_parser - INFO - Parsed formula: audit leader -> ((df['audit'] df['leader']) == df['Aud'])
2025-05-15 13:34:17,510 - formula_parser - INFO - Parsed formula: audit leader -> ((df['audit'] df['leader']) == df['Audi'])
2025-05-15 13:34:17,807 - formula_parser - INFO - Parsed formula: audit leader -> ((df['audit'] df['leader']) == df['Aud'])
2025-05-15 13:34:17,926 - formula_parser - INFO - Parsed formula: audit leader -> ((df['audit'] df['leader']) == df['Au'])
2025-05-15 13:34:18,045 - formula_parser - INFO - Parsed formula: audit leader -> ((df['audit'] df['leader']) == df['A'])
2025-05-15 13:34:18,175 - formula_parser - INFO - Parsed formula: audit leader =  -> (df['audit leader'] ==)
2025-05-15 13:34:18,270 - formula_parser - INFO - Parsed formula: audit leader -> ((df['audit'] df['leader']) == df['a'])
2025-05-15 13:34:18,407 - formula_parser - INFO - Parsed formula: audit leader -> ((df['audit'] df['leader']) == df['au'])
2025-05-15 13:34:18,455 - formula_parser - INFO - Parsed formula: audit leader -> ((df['audit'] df['leader']) == df['aud'])
2025-05-15 13:34:18,878 - formula_parser - INFO - Parsed formula: audit leader -> ((df['audit'] df['leader']) == df['au'])
2025-05-15 13:34:18,998 - formula_parser - INFO - Parsed formula: audit leader -> ((df['audit'] df['leader']) == df['a'])
2025-05-15 13:34:19,133 - formula_parser - INFO - Parsed formula: audit leader =  -> (df['audit leader'] ==)
2025-05-15 13:34:19,455 - formula_parser - INFO - Parsed formula: audit leader -> ((df['audit'] df['leader']) == df['A'])
2025-05-15 13:34:19,567 - formula_parser - INFO - Parsed formula: audit leader -> ((df['audit'] df['leader']) == df['AL'])
2025-05-15 13:34:19,662 - formula_parser - INFO - Parsed formula: audit leader  -> ((df['audit'] df['leader']) == df['AL'])
2025-05-15 13:34:20,336 - formula_parser - INFO - Parsed formula: audit leader a -> ((df['audit'] df['leader'] df['a']) == df['AL'])
2025-05-15 13:34:20,414 - formula_parser - INFO - Parsed formula: audit leader ap -> ((df['audit'] df['leader'] df['ap']) == df['AL'])
2025-05-15 13:34:20,549 - formula_parser - INFO - Parsed formula: audit leader app -> ((df['audit'] df['leader'] df['app']) == df['AL'])
2025-05-15 13:34:20,590 - formula_parser - INFO - Parsed formula: audit leader appr -> ((df['audit'] df['leader'] df['appr']) == df['AL'])
2025-05-15 13:34:20,734 - formula_parser - INFO - Parsed formula: audit leader appro -> ((df['audit'] df['leader'] df['appro']) == df['AL'])
2025-05-15 13:34:20,782 - formula_parser - INFO - Parsed formula: audit leader approv -> ((df['audit'] df['leader'] df['approv']) == df['AL'])
2025-05-15 13:34:20,838 - formula_parser - INFO - Parsed formula: audit leader approva -> ((df['audit'] df['leader'] df['approva']) == df['AL'])
2025-05-15 13:34:20,917 - formula_parser - INFO - Parsed formula: audit leader approval -> ((df['audit'] df['leader'] df['approval']) == df['AL'])
2025-05-15 13:34:26,203 - qa_analytics - INFO - Successfully generated configuration for template custom_formula
2025-05-15 13:40:19,805 - formula_parser - INFO - Parsed formula: ' -> ()
2025-05-15 13:40:20,117 - formula_parser - INFO - Parsed formula: 'A -> (df['A'])
2025-05-15 13:40:20,302 - formula_parser - INFO - Parsed formula: 'Au -> (df['Au'])
2025-05-15 13:40:20,389 - formula_parser - INFO - Parsed formula: 'Aud -> (df['Aud'])
2025-05-15 13:40:20,509 - formula_parser - INFO - Parsed formula: 'Audi -> (df['Audi'])
2025-05-15 13:40:20,581 - formula_parser - INFO - Parsed formula: 'Audit -> (df['Audit'])
2025-05-15 13:40:20,910 - formula_parser - INFO - Parsed formula: 'Audit  -> (df['Audit'])
2025-05-15 13:40:21,438 - formula_parser - INFO - Parsed formula: 'Audit l -> (df['Audit'] df['l'])
2025-05-15 13:40:21,525 - formula_parser - INFO - Parsed formula: 'Audit le -> (df['Audit'] df['le'])
2025-05-15 13:40:21,605 - formula_parser - INFO - Parsed formula: 'Audit lea -> (df['Audit'] df['lea'])
2025-05-15 13:40:21,910 - formula_parser - INFO - Parsed formula: 'Audit le -> (df['Audit'] df['le'])
2025-05-15 13:40:22,013 - formula_parser - INFO - Parsed formula: 'Audit l -> (df['Audit'] df['l'])
2025-05-15 13:40:22,109 - formula_parser - INFO - Parsed formula: 'Audit  -> (df['Audit'])
2025-05-15 13:40:22,477 - formula_parser - INFO - Parsed formula: 'Audit L -> (df['Audit'] df['L'])
2025-05-15 13:40:22,725 - formula_parser - INFO - Parsed formula: 'Audit La -> (df['Audit'] df['La'])
2025-05-15 13:40:23,134 - formula_parser - INFO - Parsed formula: 'Audit L -> (df['Audit'] df['L'])
2025-05-15 13:40:23,165 - formula_parser - INFO - Parsed formula: 'Audit Le -> (df['Audit'] df['Le'])
2025-05-15 13:40:23,261 - formula_parser - INFO - Parsed formula: 'Audit Lea -> (df['Audit'] df['Lea'])
2025-05-15 13:40:23,349 - formula_parser - INFO - Parsed formula: 'Audit Lead -> (df['Audit'] df['Lead'])
2025-05-15 13:40:23,526 - formula_parser - INFO - Parsed formula: 'Audit Leade -> (df['Audit'] df['Leade'])
2025-05-15 13:40:23,581 - formula_parser - INFO - Parsed formula: 'Audit Leader -> (df['Audit'] df['Leader'])
2025-05-15 13:40:23,741 - formula_parser - INFO - Parsed formula: 'Audit Leader' -> ('Audit Leader')
2025-05-15 13:40:23,829 - formula_parser - INFO - Parsed formula: 'Audit Leader'  -> ('Audit Leader')
2025-05-15 13:40:24,589 - formula_parser - INFO - Parsed formula: 'Audit Leader' = -> ('Audit Leader' ==)
2025-05-15 13:40:24,661 - formula_parser - INFO - Parsed formula: 'Audit Leader' =  -> ('Audit Leader' ==)
2025-05-15 13:40:25,655 - formula_parser - INFO - Parsed formula: 'Audit Leader' = ' -> ('Audit Leader' ==)
2025-05-15 13:40:26,182 - formula_parser - INFO - Parsed formula: 'Audit Leader' = 'A -> ('Audit Leader' == df['A'])
2025-05-15 13:40:26,342 - formula_parser - INFO - Parsed formula: 'Audit Leader' = 'Au -> ('Audit Leader' == df['Au'])
2025-05-15 13:40:26,398 - formula_parser - INFO - Parsed formula: 'Audit Leader' = 'Aud -> ('Audit Leader' == df['Aud'])
2025-05-15 13:40:26,518 - formula_parser - INFO - Parsed formula: 'Audit Leader' = 'Audi -> ('Audit Leader' == df['Audi'])
2025-05-15 13:40:26,590 - formula_parser - INFO - Parsed formula: 'Audit Leader' = 'Audit -> ('Audit Leader' == df['Audit'])
2025-05-15 13:40:26,686 - formula_parser - INFO - Parsed formula: 'Audit Leader' = 'Audit  -> ('Audit Leader' == df['Audit'])
2025-05-15 13:40:27,423 - formula_parser - INFO - Parsed formula: 'Audit Leader' = 'Audit -> ('Audit Leader' == df['Audit'])
2025-05-15 13:40:27,478 - formula_parser - INFO - Parsed formula: 'Audit Leader' = 'Audi -> ('Audit Leader' == df['Audi'])
2025-05-15 13:40:27,632 - formula_parser - INFO - Parsed formula: 'Audit Leader' = 'Aud -> ('Audit Leader' == df['Aud'])
2025-05-15 13:40:27,750 - formula_parser - INFO - Parsed formula: 'Audit Leader' = 'Au -> ('Audit Leader' == df['Au'])
2025-05-15 13:40:27,886 - formula_parser - INFO - Parsed formula: 'Audit Leader' = 'A -> ('Audit Leader' == df['A'])
2025-05-15 13:40:28,246 - formula_parser - INFO - Parsed formula: 'Audit Leader' = 'Al -> ('Audit Leader' == df['Al'])
2025-05-15 13:40:28,846 - formula_parser - INFO - Parsed formula: 'Audit Leader' = 'A -> ('Audit Leader' == df['A'])
2025-05-15 13:40:29,041 - formula_parser - INFO - Parsed formula: 'Audit Leader' = 'AL -> ('Audit Leader' == df['AL'])
2025-05-15 13:40:29,310 - formula_parser - INFO - Parsed formula: 'Audit Leader' = 'AL  -> ('Audit Leader' == df['AL'])
2025-05-15 13:40:29,457 - formula_parser - INFO - Parsed formula: 'Audit Leader' = 'AL A -> ('Audit Leader' == df['AL'] df['A'])
2025-05-15 13:40:29,670 - formula_parser - INFO - Parsed formula: 'Audit Leader' = 'AL Ap -> ('Audit Leader' == df['AL'] df['Ap'])
2025-05-15 13:40:29,830 - formula_parser - INFO - Parsed formula: 'Audit Leader' = 'AL App -> ('Audit Leader' == df['AL'] df['App'])
2025-05-15 13:40:29,917 - formula_parser - INFO - Parsed formula: 'Audit Leader' = 'AL Appr -> ('Audit Leader' == df['AL'] df['Appr'])
2025-05-15 13:40:30,006 - formula_parser - INFO - Parsed formula: 'Audit Leader' = 'AL Appro -> ('Audit Leader' == df['AL'] df['Appro'])
2025-05-15 13:40:30,149 - formula_parser - INFO - Parsed formula: 'Audit Leader' = 'AL Approa -> ('Audit Leader' == df['AL'] df['Approa'])
2025-05-15 13:40:30,271 - formula_parser - INFO - Parsed formula: 'Audit Leader' = 'AL Approal -> ('Audit Leader' == df['AL'] df['Approal'])
2025-05-15 13:40:30,543 - formula_parser - INFO - Parsed formula: 'Audit Leader' = 'AL Approa -> ('Audit Leader' == df['AL'] df['Approa'])
2025-05-15 13:40:30,639 - formula_parser - INFO - Parsed formula: 'Audit Leader' = 'AL Appro -> ('Audit Leader' == df['AL'] df['Appro'])
2025-05-15 13:40:30,702 - formula_parser - INFO - Parsed formula: 'Audit Leader' = 'AL Approv -> ('Audit Leader' == df['AL'] df['Approv'])
2025-05-15 13:40:30,823 - formula_parser - INFO - Parsed formula: 'Audit Leader' = 'AL Approve -> ('Audit Leader' == df['AL'] df['Approve'])
2025-05-15 13:40:30,894 - formula_parser - INFO - Parsed formula: 'Audit Leader' = 'AL Approver -> ('Audit Leader' == df['AL'] df['Approver'])
2025-05-15 13:40:30,998 - formula_parser - INFO - Parsed formula: 'Audit Leader' = 'AL Approver' -> ('Audit Leader' == 'AL Approver')
2025-05-15 13:40:33,487 - qa_analytics - INFO - Successfully generated configuration for template custom_formula
2025-05-15 13:42:35,573 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-15 13:42:35,628 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 13:42:35,630 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 13:42:35,631 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-15 13:42:35,632 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 13:42:35,633 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 13:42:35,635 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-15 13:42:35,636 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 13:42:35,637 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 13:42:35,639 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 13:42:35,648 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 13:42:35,648 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-15 13:42:35,651 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-15 13:42:35,652 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-15 13:42:35,656 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-15 13:42:35,661 - qa_analytics - INFO - Loaded template metadata
2025-05-15 13:42:35,662 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-15 13:42:40,644 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 13:42:40,644 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-15 13:42:51,640 - formula_parser - INFO - Parsed formula: ` -> ()
2025-05-15 13:42:52,293 - formula_parser - INFO - Parsed formula: `A -> (df['A'])
2025-05-15 13:42:52,439 - formula_parser - INFO - Parsed formula: `Au -> (df['Au'])
2025-05-15 13:42:52,509 - formula_parser - INFO - Parsed formula: `Aud -> (df['Aud'])
2025-05-15 13:42:52,599 - formula_parser - INFO - Parsed formula: `Audi -> (df['Audi'])
2025-05-15 13:42:52,656 - formula_parser - INFO - Parsed formula: `Audit -> (df['Audit'])
2025-05-15 13:42:52,766 - formula_parser - INFO - Parsed formula: `Audit  -> (df['Audit'])
2025-05-15 13:42:52,832 - formula_parser - INFO - Parsed formula: `Audit L -> (df['Audit'] df['L'])
2025-05-15 13:42:52,966 - formula_parser - INFO - Parsed formula: `Audit Le -> (df['Audit'] df['Le'])
2025-05-15 13:42:53,014 - formula_parser - INFO - Parsed formula: `Audit Lea -> (df['Audit'] df['Lea'])
2025-05-15 13:42:53,150 - formula_parser - INFO - Parsed formula: `Audit Lead -> (df['Audit'] df['Lead'])
2025-05-15 13:42:53,302 - formula_parser - INFO - Parsed formula: `Audit Leade -> (df['Audit'] df['Leade'])
2025-05-15 13:42:53,342 - formula_parser - INFO - Parsed formula: `Audit Leader -> (df['Audit'] df['Leader'])
2025-05-15 13:42:54,399 - formula_parser - INFO - Parsed formula: __FIELD_0__ -> (df['Audit Leader'])
2025-05-15 13:42:54,726 - formula_parser - INFO - Parsed formula: __FIELD_0__  -> (df['Audit Leader'])
2025-05-15 13:42:55,904 - formula_parser - INFO - Parsed formula: __FIELD_0__ -> (df['Audit Leader'])
2025-05-15 13:42:56,262 - formula_parser - INFO - Parsed formula: `Audit Leader -> (df['Audit'] df['Leader'])
2025-05-15 13:42:57,958 - formula_parser - INFO - Parsed formula: __FIELD_0__ -> (df['Audit Leader'])
2025-05-15 13:42:58,190 - formula_parser - INFO - Parsed formula: __FIELD_0__  -> (df['Audit Leader'])
2025-05-15 13:42:59,165 - formula_parser - INFO - Parsed formula: __FIELD_0__ = -> (df['Audit Leader'] ==)
2025-05-15 13:42:59,287 - formula_parser - INFO - Parsed formula: __FIELD_0__ =  -> (df['Audit Leader'] ==)
2025-05-15 13:43:00,112 - formula_parser - INFO - Parsed formula: __FIELD_0__ = ` -> (df['Audit Leader'] ==)
2025-05-15 13:43:00,478 - formula_parser - INFO - Parsed formula: __FIELD_0__ = `A -> (df['Audit Leader'] == df['A'])
2025-05-15 13:43:00,839 - formula_parser - INFO - Parsed formula: __FIELD_0__ = `AL -> (df['Audit Leader'] == df['AL'])
2025-05-15 13:43:00,942 - formula_parser - INFO - Parsed formula: __FIELD_0__ = `AL  -> (df['Audit Leader'] == df['AL'])
2025-05-15 13:43:01,111 - formula_parser - INFO - Parsed formula: __FIELD_0__ = `AL A -> (df['Audit Leader'] == df['AL'] df['A'])
2025-05-15 13:43:01,326 - formula_parser - INFO - Parsed formula: __FIELD_0__ = `AL Ap -> (df['Audit Leader'] == df['AL'] df['Ap'])
2025-05-15 13:43:01,679 - formula_parser - INFO - Parsed formula: __FIELD_0__ = `AL Apo -> (df['Audit Leader'] == df['AL'] df['Apo'])
2025-05-15 13:43:01,926 - formula_parser - INFO - Parsed formula: __FIELD_0__ = `AL Ap -> (df['Audit Leader'] == df['AL'] df['Ap'])
2025-05-15 13:43:02,278 - formula_parser - INFO - Parsed formula: __FIELD_0__ = `AL App -> (df['Audit Leader'] == df['AL'] df['App'])
2025-05-15 13:43:02,438 - formula_parser - INFO - Parsed formula: __FIELD_0__ = `AL Appr -> (df['Audit Leader'] == df['AL'] df['Appr'])
2025-05-15 13:43:02,494 - formula_parser - INFO - Parsed formula: __FIELD_0__ = `AL Appro -> (df['Audit Leader'] == df['AL'] df['Appro'])
2025-05-15 13:43:02,615 - formula_parser - INFO - Parsed formula: __FIELD_0__ = `AL Approv -> (df['Audit Leader'] == df['AL'] df['Approv'])
2025-05-15 13:43:02,741 - formula_parser - INFO - Parsed formula: __FIELD_0__ = `AL Approve -> (df['Audit Leader'] == df['AL'] df['Approve'])
2025-05-15 13:43:02,815 - formula_parser - INFO - Parsed formula: __FIELD_0__ = `AL Approver -> (df['Audit Leader'] == df['AL'] df['Approver'])
2025-05-15 13:43:03,288 - formula_parser - INFO - Parsed formula: __FIELD_1__ = __FIELD_0__ -> (df['Audit Leader'] == df['AL Approver'])
2025-05-15 13:43:05,356 - qa_analytics - INFO - Successfully generated configuration for template custom_formula
2025-05-15 13:45:51,155 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-15 13:45:51,204 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 13:45:51,206 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 13:45:51,207 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-15 13:45:51,208 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 13:45:51,209 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 13:45:51,211 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-15 13:45:51,212 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 13:45:51,212 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 13:45:51,214 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 13:45:51,223 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 13:45:51,223 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-15 13:45:51,227 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-15 13:45:51,228 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-15 13:45:51,230 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-15 13:45:51,236 - qa_analytics - INFO - Loaded template metadata
2025-05-15 13:45:51,236 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-15 13:45:55,366 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 13:45:55,366 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-15 13:46:25,177 - formula_parser - INFO - Parsed formula: i -> (df['i'])
2025-05-15 13:46:25,254 - formula_parser - INFO - Parsed formula: if -> (df['if'])
2025-05-15 13:46:25,615 - formula_parser - ERROR - IF requires 3 arguments, got 0
2025-05-15 13:46:25,616 - formula_parser - INFO - Parsed formula: if( -> (pd.Series(np.nan, index=df.index))
2025-05-15 13:46:27,847 - formula_parser - ERROR - IF requires 3 arguments, got 0
2025-05-15 13:46:27,847 - formula_parser - INFO - Parsed formula: if(i -> (pd.Series(np.nan, index=df.index))
2025-05-15 13:46:27,920 - formula_parser - ERROR - IF requires 3 arguments, got 0
2025-05-15 13:46:27,921 - formula_parser - INFO - Parsed formula: if(is -> (pd.Series(np.nan, index=df.index))
2025-05-15 13:46:28,806 - formula_parser - ERROR - IF requires 3 arguments, got 0
2025-05-15 13:46:28,807 - formula_parser - INFO - Parsed formula: if(i -> (pd.Series(np.nan, index=df.index))
2025-05-15 13:46:28,950 - formula_parser - ERROR - IF requires 3 arguments, got 0
2025-05-15 13:46:28,951 - formula_parser - INFO - Parsed formula: if( -> (pd.Series(np.nan, index=df.index))
2025-05-15 13:46:29,111 - formula_parser - INFO - Parsed formula: if -> (df['if'])
2025-05-15 13:46:29,342 - formula_parser - INFO - Parsed formula: i -> (df['i'])
2025-05-15 13:46:33,415 - formula_parser - INFO - Parsed formula: ` -> ()
2025-05-15 13:46:33,720 - formula_parser - INFO - Parsed formula: `a -> (df['a'])
2025-05-15 13:46:33,790 - formula_parser - INFO - Parsed formula: `au -> (df['au'])
2025-05-15 13:46:33,895 - formula_parser - INFO - Parsed formula: `aud -> (df['aud'])
2025-05-15 13:46:33,951 - formula_parser - INFO - Parsed formula: `audi -> (df['audi'])
2025-05-15 13:46:34,038 - formula_parser - INFO - Parsed formula: `audit -> (df['audit'])
2025-05-15 13:46:34,478 - formula_parser - INFO - Parsed formula: `audit  -> (df['audit'])
2025-05-15 13:46:34,606 - formula_parser - INFO - Parsed formula: `audit l -> (df['audit'] df['l'])
2025-05-15 13:46:34,638 - formula_parser - INFO - Parsed formula: `audit le -> (df['audit'] df['le'])
2025-05-15 13:46:34,733 - formula_parser - INFO - Parsed formula: `audit lea -> (df['audit'] df['lea'])
2025-05-15 13:46:34,822 - formula_parser - INFO - Parsed formula: `audit lead -> (df['audit'] df['lead'])
2025-05-15 13:46:34,990 - formula_parser - INFO - Parsed formula: `audit leade -> (df['audit'] df['leade'])
2025-05-15 13:46:35,046 - formula_parser - INFO - Parsed formula: `audit leader -> (df['audit'] df['leader'])
2025-05-15 13:46:35,279 - formula_parser - INFO - Parsed formula: `audit leader  -> (df['audit'] df['leader'])
2025-05-15 13:46:35,478 - formula_parser - INFO - Parsed formula: `audit leader = -> (df['audit leader'] ==)
2025-05-15 13:46:35,752 - formula_parser - INFO - Parsed formula: `audit leader  -> (df['audit'] df['leader'])
2025-05-15 13:46:35,879 - formula_parser - INFO - Parsed formula: `audit leader -> (df['audit'] df['leader'])
2025-05-15 13:46:35,998 - formula_parser - INFO - Parsed formula: __FIELD_0__ -> (df['audit leader'])
2025-05-15 13:46:36,206 - formula_parser - INFO - Parsed formula: __FIELD_0__  -> (df['audit leader'])
2025-05-15 13:46:36,678 - formula_parser - INFO - Parsed formula: __FIELD_0__ = -> (df['audit leader'] ==)
2025-05-15 13:46:36,854 - formula_parser - INFO - Parsed formula: __FIELD_0__ =  -> (df['audit leader'] ==)
2025-05-15 13:46:37,822 - formula_parser - INFO - Parsed formula: __FIELD_0__ = ` -> (df['audit leader'] ==)
2025-05-15 13:46:38,359 - formula_parser - INFO - Parsed formula: __FIELD_0__ = `A -> (df['audit leader'] == df['A'])
2025-05-15 13:46:38,471 - formula_parser - INFO - Parsed formula: __FIELD_0__ = `AL -> (df['audit leader'] == df['AL'])
2025-05-15 13:46:38,590 - formula_parser - INFO - Parsed formula: __FIELD_0__ = `AL  -> (df['audit leader'] == df['AL'])
2025-05-15 13:46:38,742 - formula_parser - INFO - Parsed formula: __FIELD_0__ = `AL a -> (df['audit leader'] == df['AL'] df['a'])
2025-05-15 13:46:38,821 - formula_parser - INFO - Parsed formula: __FIELD_0__ = `AL ap -> (df['audit leader'] == df['AL'] df['ap'])
2025-05-15 13:46:38,989 - formula_parser - INFO - Parsed formula: __FIELD_0__ = `AL app -> (df['audit leader'] == df['AL'] df['app'])
2025-05-15 13:46:39,055 - formula_parser - INFO - Parsed formula: __FIELD_0__ = `AL appr -> (df['audit leader'] == df['AL'] df['appr'])
2025-05-15 13:46:39,192 - formula_parser - INFO - Parsed formula: __FIELD_0__ = `AL appro -> (df['audit leader'] == df['AL'] df['appro'])
2025-05-15 13:46:39,285 - formula_parser - INFO - Parsed formula: __FIELD_0__ = `AL approv -> (df['audit leader'] == df['AL'] df['approv'])
2025-05-15 13:46:39,383 - formula_parser - INFO - Parsed formula: __FIELD_0__ = `AL approve -> (df['audit leader'] == df['AL'] df['approve'])
2025-05-15 13:46:39,470 - formula_parser - INFO - Parsed formula: __FIELD_0__ = `AL approver -> (df['audit leader'] == df['AL'] df['approver'])
2025-05-15 13:46:39,997 - formula_parser - INFO - Parsed formula: __FIELD_1__ = __FIELD_0__ -> (df['audit leader'] == df['AL approver'])
2025-05-15 13:47:14,180 - qa_analytics - INFO - Successfully generated configuration for template custom_formula
2025-05-15 13:47:15,046 - qa_analytics - INFO - Saved configuration to configs\qa_1.yaml
2025-05-15 13:47:16,317 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 13:47:16,318 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 13:47:16,324 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 13:47:16,326 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-15 13:47:16,328 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 13:47:16,329 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 13:47:16,330 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-15 13:47:16,331 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 13:47:16,332 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 13:47:27,737 - qa_analytics - INFO - Saved configuration to configs\qa_1.yaml
2025-05-15 13:47:28,739 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 13:47:28,741 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 13:47:28,742 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 13:47:28,743 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-15 13:47:28,744 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 13:47:28,745 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 13:47:28,746 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-15 13:47:28,747 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 13:47:28,748 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 13:55:47,218 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-15 13:55:47,265 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 13:55:47,267 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 13:55:47,268 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 13:55:47,270 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-15 13:55:47,271 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 13:55:47,272 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 13:55:47,273 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-15 13:55:47,274 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 13:55:47,275 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 13:55:47,276 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 13:55:47,285 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 13:55:47,286 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-15 13:55:47,289 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-15 13:55:47,290 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-15 13:55:47,293 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-15 13:55:47,298 - qa_analytics - INFO - Loaded template metadata
2025-05-15 13:55:47,299 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-15 13:55:59,377 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 13:55:59,377 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-15 13:56:09,009 - formula_parser - INFO - Parsed formula: a -> (df['a'])
2025-05-15 13:56:09,086 - formula_parser - INFO - Parsed formula: a  -> (df['a'])
2025-05-15 13:56:09,270 - formula_parser - INFO - Parsed formula: a = -> (df['a'] ==)
2025-05-15 13:56:09,383 - formula_parser - INFO - Parsed formula: a =  -> (df['a'] ==)
2025-05-15 13:56:09,494 - formula_parser - INFO - Parsed formula: a -> ((df['a']) == df['b'])
2025-05-15 13:56:11,026 - qa_analytics - INFO - Successfully generated configuration for template custom_formula
2025-05-15 13:56:14,418 - qa_analytics - INFO - Saved configuration to configs\qa_1.yaml
2025-05-15 13:56:15,642 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 13:56:15,644 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 13:56:15,652 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 13:56:15,654 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-15 13:56:15,655 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 13:56:15,656 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 13:56:15,657 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-15 13:56:15,658 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 13:56:15,659 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 13:56:15,659 - qa_analytics - INFO - Refreshed analytics list: found 3 configurations
2025-05-15 13:57:17,229 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-15 13:57:17,280 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 13:57:17,282 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 13:57:17,283 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 13:57:17,284 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-15 13:57:17,285 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 13:57:17,286 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 13:57:17,287 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-15 13:57:17,289 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 13:57:17,289 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 13:57:17,291 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 13:57:17,300 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 13:57:17,300 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-15 13:57:17,304 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-15 13:57:17,305 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-15 13:57:17,308 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-15 13:57:17,313 - qa_analytics - INFO - Loaded template metadata
2025-05-15 13:57:17,314 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-15 13:58:59,391 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-15 13:58:59,440 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 13:58:59,442 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 13:58:59,443 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 13:58:59,444 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-15 13:58:59,445 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 13:58:59,446 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 13:58:59,447 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-15 13:58:59,449 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 13:58:59,449 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 13:58:59,451 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 13:58:59,461 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 13:58:59,461 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-15 13:58:59,464 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-15 13:58:59,465 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-15 13:58:59,468 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-15 13:58:59,474 - qa_analytics - INFO - Loaded template metadata
2025-05-15 13:58:59,474 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-15 14:03:29,120 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-15 14:03:29,167 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:03:29,169 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 14:03:29,170 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 14:03:29,171 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-15 14:03:29,172 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 14:03:29,173 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 14:03:29,174 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-15 14:03:29,175 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:03:29,176 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:03:29,178 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 14:03:29,186 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 14:03:29,186 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-15 14:03:29,190 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-15 14:03:29,191 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-15 14:03:29,194 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-15 14:03:29,199 - qa_analytics - INFO - Loaded template metadata
2025-05-15 14:03:29,200 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-15 14:04:25,251 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-15 14:04:25,300 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:04:25,302 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 14:04:25,303 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 14:04:25,304 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-15 14:04:25,305 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 14:04:25,307 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 14:04:25,308 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-15 14:04:25,310 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:04:25,310 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:04:25,312 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 14:04:25,322 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 14:04:25,322 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-15 14:04:25,326 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-15 14:04:25,327 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-15 14:04:25,330 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-15 14:04:25,335 - qa_analytics - INFO - Loaded template metadata
2025-05-15 14:04:25,336 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-15 14:04:27,790 - qa_analytics - INFO - User preferences saved
2025-05-15 14:04:29,804 - qa_analytics - INFO - User preferences saved
2025-05-15 14:04:30,637 - qa_analytics - INFO - User preferences saved
2025-05-15 14:04:32,012 - qa_analytics - INFO - User preferences saved
2025-05-15 14:04:34,590 - qa_analytics - INFO - User preferences saved
2025-05-15 14:04:38,298 - qa_analytics - INFO - User preferences saved
2025-05-15 14:04:42,901 - qa_analytics - INFO - User preferences saved
2025-05-15 14:13:08,324 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-15 14:13:08,372 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:13:08,373 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 14:13:08,374 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 14:13:08,376 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-15 14:13:08,377 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 14:13:08,378 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 14:13:08,379 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-15 14:13:08,380 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:13:08,381 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:13:08,382 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 14:13:08,392 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 14:13:08,392 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-15 14:13:08,395 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-15 14:13:08,396 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-15 14:13:08,399 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-15 14:13:08,405 - qa_analytics - INFO - Loaded template metadata
2025-05-15 14:13:08,405 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-15 14:14:29,774 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-15 14:14:29,823 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:14:29,825 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 14:14:29,826 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 14:14:29,827 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-15 14:14:29,828 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 14:14:29,829 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 14:14:29,831 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-15 14:14:29,832 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:14:29,833 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:14:29,834 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 14:14:29,844 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 14:14:29,844 - qa_analytics - INFO - Found 5 data sources and 9 analytic mappings
2025-05-15 14:14:29,847 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-15 14:14:29,848 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-15 14:14:29,851 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-15 14:14:29,857 - qa_analytics - INFO - Loaded template metadata
2025-05-15 14:14:29,858 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-15 14:17:22,647 - qa_analytics - INFO - User preferences saved
2025-05-15 14:23:24,914 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-15 14:23:24,966 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:23:24,968 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 14:23:24,969 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 14:23:24,971 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-15 14:23:24,972 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 14:23:24,973 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 14:23:24,975 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-15 14:23:24,976 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:23:24,977 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:23:24,979 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 14:23:24,992 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 14:23:24,992 - qa_analytics - INFO - Found 6 data sources and 9 analytic mappings
2025-05-15 14:23:24,996 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-15 14:23:24,997 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-15 14:23:25,001 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-15 14:23:25,007 - qa_analytics - INFO - Loaded template metadata
2025-05-15 14:23:25,007 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-15 14:23:34,355 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 14:23:34,355 - qa_analytics - INFO - Found 6 data sources and 9 analytic mappings
2025-05-15 14:24:09,402 - formula_parser - INFO - Parsed formula: ISBLANK ( Comments -> (pd.isna(df['Comments']))
2025-05-15 14:24:09,403 - formula_parser - INFO - Parsed formula: Submitter AND Reviewer <> Approver AND __FIELD_6__ <= __FIELD_5__ AND __FIELD_4__ <= __FIELD_3__ AND ((__FIELD_2__ = "High" OR __FIELD_1__ = "Critical") AND __FIELD_0__ = "Complete" => NOT ISBLANK(Comments)) -> ((pd.Series(df['Submitter'], index=df.index).astype(bool)&pd.Series(df['Reviewer'] != df['Approver'], index=df.index).astype(bool)&pd.Series(df['Submission_Date'] <= df['Review_Date'], index=df.index).astype(bool)&pd.Series(df['Review_Date'] <= df['Approval_Date'], index=df.index).astype(bool)&pd.Series(( ( df['Risk_Level'] == "High", index=df.index).astype(bool)|pd.Series(df['Risk_Level'] == "Critical" ), index=df.index).astype(bool)&pd.Series(df['Status'] == "Complete" == > ~pd.Series((pd.isna(df['Comments'])), index=df.index).astype(bool) ) ), index=df.index).astype(bool)) != df['Reviewer'])
2025-05-15 14:24:16,276 - qa_analytics - INFO - Successfully generated configuration for template custom_formula
2025-05-15 14:25:09,742 - formula_parser - INFO - Parsed formula: ( Risk_Level OR Risk_Level = "Critical" ) AND Status = "Complete" -> ((pd.Series(( df['Risk_Level'], index=df.index).astype(bool)|pd.Series(df['Risk_Level'] == "Critical" ), index=df.index).astype(bool)&pd.Series(df['Status'] == "Complete", index=df.index).astype(bool)) == "High")
2025-05-15 14:25:09,742 - formula_parser - INFO - Parsed formula: ISBLANK ( Comments -> (pd.isna(df['Comments']))
2025-05-15 14:25:09,742 - formula_parser - INFO - Parsed formula: (Submitter) AND (Reviewer <> Approver) AND (Submission_Date <= Review_Date) AND (Review_Date <= Approval_Date) AND (NOT((Risk_Level = "High" OR Risk_Level = "Critical") AND Status = "Complete") OR NOT ISBLANK(Comments)) -> ((pd.Series(( df['Submitter'] ), index=df.index).astype(bool)&pd.Series(( df['Reviewer'] != df['Approver'] ), index=df.index).astype(bool)&pd.Series(( df['Submission_Date'] <= df['Review_Date'] ), index=df.index).astype(bool)&pd.Series(( df['Review_Date'] <= df['Approval_Date'] ), index=df.index).astype(bool)&pd.Series(( ~pd.Series(((pd.Series(( df['Risk_Level'], index=df.index).astype(bool), index=df.index).astype(bool)|pd.Series(df['Risk_Level'] == "Critical" ), index=df.index).astype(bool)&pd.Series(df['Status'] == "Complete", index=df.index).astype(bool)) == "High"), index=df.index).astype(bool)|~pd.Series((pd.isna(df['Comments'])), index=df.index).astype(bool) ) )) != df['Reviewer'])
2025-05-15 14:25:11,110 - qa_analytics - INFO - Successfully generated configuration for template custom_formula
2025-05-15 14:25:20,872 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 14:25:20,872 - qa_analytics - INFO - Found 6 data sources and 9 analytic mappings
2025-05-15 14:25:26,529 - formula_parser - ERROR - Unknown function: astype
2025-05-15 14:25:32,073 - formula_parser - INFO - Parsed formula: ( Risk_Level OR Risk_Level = "Critical" ) AND Status = "Complete" -> ((pd.Series(( df['Risk_Level'], index=df.index).astype(bool)|pd.Series(df['Risk_Level'] == "Critical" ), index=df.index).astype(bool)&pd.Series(df['Status'] == "Complete", index=df.index).astype(bool)) == "High")
2025-05-15 14:25:32,073 - formula_parser - INFO - Parsed formula: ISBLANK ( Comments -> (pd.isna(df['Comments']))
2025-05-15 14:25:32,074 - formula_parser - INFO - Parsed formula: (Submitter) AND (Reviewer <> Approver) AND (Submission_Date <= Review_Date) AND (Review_Date <= Approval_Date) AND (NOT((Risk_Level = "High" OR Risk_Level = "Critical") AND Status = "Complete") OR NOT ISBLANK(Comments)) -> ((pd.Series(( df['Submitter'] ), index=df.index).astype(bool)&pd.Series(( df['Reviewer'] != df['Approver'] ), index=df.index).astype(bool)&pd.Series(( df['Submission_Date'] <= df['Review_Date'] ), index=df.index).astype(bool)&pd.Series(( df['Review_Date'] <= df['Approval_Date'] ), index=df.index).astype(bool)&pd.Series(( ~pd.Series(((pd.Series(( df['Risk_Level'], index=df.index).astype(bool), index=df.index).astype(bool)|pd.Series(df['Risk_Level'] == "Critical" ), index=df.index).astype(bool)&pd.Series(df['Status'] == "Complete", index=df.index).astype(bool)) == "High"), index=df.index).astype(bool)|~pd.Series((pd.isna(df['Comments'])), index=df.index).astype(bool) ) )) != df['Reviewer'])
2025-05-15 14:25:34,166 - qa_analytics - INFO - Successfully generated configuration for template custom_formula
2025-05-15 14:27:48,192 - qa_analytics - INFO - Saved configuration to configs\qa_99.yaml
2025-05-15 14:27:49,246 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:27:49,248 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 14:27:49,249 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 14:27:49,250 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-15 14:27:49,251 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 14:27:49,252 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 14:27:49,253 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-15 14:27:49,261 - qa_analytics - INFO - Loaded config for QA-ID 99
2025-05-15 14:27:49,262 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:27:49,263 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:27:49,263 - qa_analytics - INFO - Refreshed analytics list: found 4 configurations
2025-05-15 14:28:20,317 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-15 14:28:20,368 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:28:20,370 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 14:28:20,371 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 14:28:20,372 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-15 14:28:20,373 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 14:28:20,374 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 14:28:20,376 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-15 14:28:20,378 - qa_analytics - INFO - Loaded config for QA-ID 99
2025-05-15 14:28:20,379 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:28:20,380 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:28:20,381 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 14:28:20,394 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 14:28:20,394 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-15 14:28:20,397 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-15 14:28:20,398 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-15 14:28:20,401 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-15 14:28:20,406 - qa_analytics - INFO - Loaded template metadata
2025-05-15 14:28:20,407 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-15 14:28:37,759 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 14:28:37,775 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 14:28:37,776 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-15 14:28:37,777 - qa_analytics - INFO - Starting processing for QA-ID 99
2025-05-15 14:28:37,780 - qa_analytics - INFO - Loading data from registered data source 'audit_workpapers_2025q2'
2025-05-15 14:28:37,789 - qa_analytics - INFO - Loaded data source 'audit_workpapers_2025q2' from C:/Users/luria/PycharmProjects/AuditQAStudio/audit_workpapers_2025Q2.xlsx (30 rows)
2025-05-15 14:28:37,789 - qa_analytics - INFO - Successfully loaded source data with 30 rows
2025-05-15 14:28:37,795 - qa_analytics - INFO - Validation 'custom_formula' completed - 21 of 30 records conform
2025-05-15 14:28:37,798 - qa_analytics - INFO - Validation complete: 21 GC, 9 DNC
2025-05-15 14:30:12,921 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 14:30:12,935 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 14:30:12,935 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-15 14:30:12,940 - qa_analytics - INFO - Starting processing for QA-ID 99
2025-05-15 14:30:12,942 - qa_analytics - INFO - Loading data from registered data source 'audit_workpapers_2025q2'
2025-05-15 14:30:12,948 - qa_analytics - INFO - Loaded data source 'audit_workpapers_2025q2' from C:/Users/luria/PycharmProjects/AuditQAStudio/audit_workpapers_2025Q2.xlsx (30 rows)
2025-05-15 14:30:12,948 - qa_analytics - INFO - Successfully loaded source data with 30 rows
2025-05-15 14:30:12,953 - qa_analytics - INFO - Validation 'custom_formula' completed - 21 of 30 records conform
2025-05-15 14:30:12,955 - qa_analytics - INFO - Validation complete: 21 GC, 9 DNC
2025-05-15 14:32:10,859 - qa_analytics - INFO - Generated main report: C:/Users/luria/OneDrive/Desktop/q22025AuditResults2.xlsx
2025-05-15 14:46:31,026 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-15 14:46:31,082 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:46:31,084 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 14:46:31,085 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 14:46:31,086 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-15 14:46:31,088 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 14:46:31,089 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 14:46:31,090 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-15 14:46:31,091 - qa_analytics - INFO - Loaded config for QA-ID 99
2025-05-15 14:46:31,093 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:46:31,094 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:46:31,095 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 14:46:31,107 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 14:46:31,107 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-15 14:46:31,111 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-15 14:46:31,112 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-15 14:46:31,114 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-15 14:46:31,120 - qa_analytics - INFO - Loaded template metadata
2025-05-15 14:46:31,120 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-15 14:46:46,679 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 14:46:46,693 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 14:46:46,694 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-15 14:46:46,695 - qa_analytics - INFO - Starting processing for QA-ID 99
2025-05-15 14:46:46,698 - qa_analytics - INFO - Loading data from registered data source 'audit_workpapers_2025q2'
2025-05-15 14:46:46,706 - qa_analytics - INFO - Loaded data source 'audit_workpapers_2025q2' from C:/Users/luria/PycharmProjects/AuditQAStudio/audit_workpapers_2025Q2.xlsx (30 rows)
2025-05-15 14:46:46,706 - qa_analytics - INFO - Successfully loaded source data with 30 rows
2025-05-15 14:46:46,711 - qa_analytics - INFO - Validation 'custom_formula' completed - 21 of 30 records conform
2025-05-15 14:46:46,713 - qa_analytics - INFO - Validation complete: 21 GC, 9 DNC
2025-05-15 14:50:34,344 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-15 14:50:34,392 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:50:34,394 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 14:50:34,395 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 14:50:34,396 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-15 14:50:34,397 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 14:50:34,398 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 14:50:34,400 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-15 14:50:34,401 - qa_analytics - INFO - Loaded config for QA-ID 99
2025-05-15 14:50:34,402 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:50:34,403 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:50:34,404 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 14:50:34,416 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 14:50:34,416 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-15 14:50:34,419 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-15 14:50:34,420 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-15 14:50:34,423 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-15 14:50:34,428 - qa_analytics - INFO - Loaded template metadata
2025-05-15 14:50:34,429 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-15 14:50:43,777 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 14:50:43,788 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 14:50:43,788 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-15 14:50:43,790 - qa_analytics - INFO - Starting processing for QA-ID 99
2025-05-15 14:50:43,793 - qa_analytics - INFO - Loading data from registered data source 'audit_workpapers_2025q2'
2025-05-15 14:50:43,800 - qa_analytics - INFO - Loaded data source 'audit_workpapers_2025q2' from C:/Users/luria/PycharmProjects/AuditQAStudio/audit_workpapers_2025Q2.xlsx (30 rows)
2025-05-15 14:50:43,800 - qa_analytics - INFO - Successfully loaded source data with 30 rows
2025-05-15 14:50:43,805 - qa_analytics - INFO - Validation 'custom_formula' completed - 21 of 30 records conform
2025-05-15 14:50:43,807 - qa_analytics - INFO - Validation complete: 21 GC, 9 DNC
2025-05-15 14:52:14,441 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-15 14:52:14,490 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:52:14,492 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 14:52:14,493 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 14:52:14,494 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-15 14:52:14,495 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 14:52:14,496 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 14:52:14,497 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-15 14:52:14,499 - qa_analytics - INFO - Loaded config for QA-ID 99
2025-05-15 14:52:14,500 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:52:14,501 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:52:14,502 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 14:52:14,514 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 14:52:14,514 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-15 14:52:14,518 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-15 14:52:14,519 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-15 14:52:14,522 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-15 14:52:14,527 - qa_analytics - INFO - Loaded template metadata
2025-05-15 14:52:14,527 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-15 14:52:20,489 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 14:52:20,501 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 14:52:20,501 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-15 14:52:20,505 - qa_analytics - INFO - Starting processing for QA-ID 99
2025-05-15 14:52:20,508 - qa_analytics - INFO - Loading data from registered data source 'audit_workpapers_2025q2'
2025-05-15 14:52:20,516 - qa_analytics - INFO - Loaded data source 'audit_workpapers_2025q2' from C:/Users/luria/PycharmProjects/AuditQAStudio/audit_workpapers_2025Q2.xlsx (30 rows)
2025-05-15 14:52:20,516 - qa_analytics - INFO - Successfully loaded source data with 30 rows
2025-05-15 14:52:20,523 - qa_analytics - INFO - Validation 'custom_formula' completed - 21 of 30 records conform
2025-05-15 14:52:20,526 - qa_analytics - INFO - Validation complete: 21 GC, 9 DNC
2025-05-15 14:52:20,534 - qa_analytics - INFO - Processor results keys: dict_keys(['detail', 'summary', 'warnings'])
2025-05-15 14:52:20,534 - qa_analytics - INFO - Summary data type: <class 'pandas.core.frame.DataFrame'>
2025-05-15 14:52:20,534 - qa_analytics - INFO - Summary data empty: False
2025-05-15 14:52:20,534 - qa_analytics - INFO - Summary columns: ['Audit_Entity', 'GC', 'PC', 'DNC', 'Total', 'DNC_Percentage', 'Exceeds_Threshold']
2025-05-15 14:52:20,534 - qa_analytics - INFO - Summary shape: (6, 7)
2025-05-15 14:52:20,541 - qa_analytics - INFO - Group by field from config: Audit_Entity
2025-05-15 14:54:12,408 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-15 14:54:12,458 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:54:12,460 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 14:54:12,461 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 14:54:12,461 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-15 14:54:12,462 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 14:54:12,464 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 14:54:12,465 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-15 14:54:12,466 - qa_analytics - INFO - Loaded config for QA-ID 99
2025-05-15 14:54:12,467 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:54:12,468 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:54:12,469 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 14:54:12,481 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 14:54:12,481 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-15 14:54:12,485 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-15 14:54:12,486 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-15 14:54:12,489 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-15 14:54:12,494 - qa_analytics - INFO - Loaded template metadata
2025-05-15 14:54:12,495 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-15 14:54:18,363 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 14:54:18,377 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 14:54:18,377 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-15 14:54:18,381 - qa_analytics - INFO - Starting processing for QA-ID 99
2025-05-15 14:54:18,384 - qa_analytics - INFO - Loading data from registered data source 'audit_workpapers_2025q2'
2025-05-15 14:54:18,391 - qa_analytics - INFO - Loaded data source 'audit_workpapers_2025q2' from C:/Users/luria/PycharmProjects/AuditQAStudio/audit_workpapers_2025Q2.xlsx (30 rows)
2025-05-15 14:54:18,391 - qa_analytics - INFO - Successfully loaded source data with 30 rows
2025-05-15 14:54:18,396 - qa_analytics - INFO - Validation 'custom_formula' completed - 21 of 30 records conform
2025-05-15 14:54:18,398 - qa_analytics - INFO - Validation complete: 21 GC, 9 DNC
2025-05-15 14:57:18,471 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-15 14:57:18,521 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:57:18,523 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 14:57:18,523 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 14:57:18,525 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-15 14:57:18,526 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 14:57:18,527 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 14:57:18,529 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-15 14:57:18,530 - qa_analytics - INFO - Loaded config for QA-ID 99
2025-05-15 14:57:18,531 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:57:18,532 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:57:18,533 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 14:57:18,545 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 14:57:18,545 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-15 14:57:18,549 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-15 14:57:18,550 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-15 14:57:18,553 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-15 14:57:18,558 - qa_analytics - INFO - Loaded template metadata
2025-05-15 14:57:18,559 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-15 14:57:34,278 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-15 14:57:34,327 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:57:34,329 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 14:57:34,330 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 14:57:34,331 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-15 14:57:34,332 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 14:57:34,334 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 14:57:34,335 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-15 14:57:34,336 - qa_analytics - INFO - Loaded config for QA-ID 99
2025-05-15 14:57:34,338 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:57:34,338 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:57:34,339 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 14:57:34,352 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 14:57:34,352 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-15 14:57:34,355 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-15 14:57:34,356 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-15 14:57:34,359 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-15 14:57:34,364 - qa_analytics - INFO - Loaded template metadata
2025-05-15 14:57:34,365 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-15 14:57:41,777 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 14:57:41,791 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 14:57:41,791 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-15 14:57:41,793 - qa_analytics - INFO - Starting processing for QA-ID 99
2025-05-15 14:57:41,795 - qa_analytics - INFO - Loading data from registered data source 'audit_workpapers_2025q2'
2025-05-15 14:57:41,803 - qa_analytics - INFO - Loaded data source 'audit_workpapers_2025q2' from C:/Users/luria/PycharmProjects/AuditQAStudio/audit_workpapers_2025Q2.xlsx (30 rows)
2025-05-15 14:57:41,804 - qa_analytics - INFO - Successfully loaded source data with 30 rows
2025-05-15 14:57:41,808 - qa_analytics - INFO - Validation 'custom_formula' completed - 21 of 30 records conform
2025-05-15 14:57:41,810 - qa_analytics - INFO - Validation complete: 21 GC, 9 DNC
2025-05-15 14:59:34,822 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-15 14:59:34,874 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:59:34,876 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 14:59:34,877 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 14:59:34,879 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-15 14:59:34,880 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 14:59:34,881 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 14:59:34,883 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-15 14:59:34,884 - qa_analytics - INFO - Loaded config for QA-ID 99
2025-05-15 14:59:34,886 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:59:34,886 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 14:59:34,888 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 14:59:34,901 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 14:59:34,901 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-15 14:59:34,906 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-15 14:59:34,907 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-15 14:59:34,910 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-15 14:59:34,915 - qa_analytics - INFO - Loaded template metadata
2025-05-15 14:59:34,916 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-15 14:59:42,793 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 14:59:42,806 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 14:59:42,806 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-15 14:59:42,809 - qa_analytics - INFO - Starting processing for QA-ID 99
2025-05-15 14:59:42,811 - qa_analytics - INFO - Loading data from registered data source 'audit_workpapers_2025q2'
2025-05-15 14:59:42,819 - qa_analytics - INFO - Loaded data source 'audit_workpapers_2025q2' from C:/Users/luria/PycharmProjects/AuditQAStudio/audit_workpapers_2025Q2.xlsx (30 rows)
2025-05-15 14:59:42,819 - qa_analytics - INFO - Successfully loaded source data with 30 rows
2025-05-15 14:59:42,823 - qa_analytics - INFO - Validation 'custom_formula' completed - 21 of 30 records conform
2025-05-15 14:59:42,825 - qa_analytics - INFO - Validation complete: 21 GC, 9 DNC
2025-05-15 15:07:03,751 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-15 15:07:03,812 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 15:07:03,814 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 15:07:03,815 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 15:07:03,817 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-15 15:07:03,818 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 15:07:03,819 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 15:07:03,821 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-15 15:07:03,822 - qa_analytics - INFO - Loaded config for QA-ID 99
2025-05-15 15:07:03,824 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 15:07:03,824 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 15:07:03,826 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 15:07:03,838 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 15:07:03,838 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-15 15:07:03,842 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-15 15:07:03,843 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-15 15:07:03,847 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-15 15:07:03,852 - qa_analytics - INFO - Loaded template metadata
2025-05-15 15:07:03,853 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-15 15:07:12,884 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 15:07:12,898 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 15:07:12,898 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-15 15:07:12,900 - qa_analytics - INFO - Starting processing for QA-ID 99
2025-05-15 15:07:12,902 - qa_analytics - INFO - Loading data from registered data source 'audit_workpapers_2025q2'
2025-05-15 15:07:12,911 - qa_analytics - INFO - Loaded data source 'audit_workpapers_2025q2' from C:/Users/luria/PycharmProjects/AuditQAStudio/audit_workpapers_2025Q2.xlsx (30 rows)
2025-05-15 15:07:12,911 - qa_analytics - INFO - Successfully loaded source data with 30 rows
2025-05-15 15:07:12,916 - qa_analytics - INFO - Validation 'custom_formula' completed - 21 of 30 records conform
2025-05-15 15:07:12,918 - qa_analytics - INFO - Validation complete: 21 GC, 9 DNC
2025-05-15 15:07:12,924 - qa_analytics - INFO - Generated summary with 6 groups
2025-05-15 15:10:59,485 - qa_analytics - INFO - Generated main report: C:/Users/luria/OneDrive/Desktop/testreport.xlsx
2025-05-15 15:15:16,610 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-15 15:15:16,662 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 15:15:16,664 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 15:15:16,665 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 15:15:16,666 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-15 15:15:16,667 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 15:15:16,668 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 15:15:16,669 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-15 15:15:16,671 - qa_analytics - INFO - Loaded config for QA-ID 99
2025-05-15 15:15:16,672 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 15:15:16,673 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 15:15:16,674 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 15:15:16,686 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 15:15:16,686 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-15 15:15:16,689 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-15 15:15:16,690 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-15 15:15:16,693 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-15 15:15:16,699 - qa_analytics - INFO - Loaded template metadata
2025-05-15 15:15:16,700 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-15 15:15:25,505 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 15:15:25,517 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 15:15:25,518 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-15 15:15:25,519 - qa_analytics - INFO - Starting processing for QA-ID 99
2025-05-15 15:15:25,522 - qa_analytics - INFO - Loading data from registered data source 'audit_workpapers_2025q2'
2025-05-15 15:15:25,530 - qa_analytics - INFO - Loaded data source 'audit_workpapers_2025q2' from C:/Users/luria/PycharmProjects/AuditQAStudio/audit_workpapers_2025Q2.xlsx (30 rows)
2025-05-15 15:15:25,531 - qa_analytics - INFO - Successfully loaded source data with 30 rows
2025-05-15 15:15:25,535 - qa_analytics - INFO - Validation 'custom_formula' completed - 21 of 30 records conform
2025-05-15 15:15:25,538 - qa_analytics - INFO - Validation complete: 21 GC, 9 DNC
2025-05-15 15:15:25,543 - qa_analytics - INFO - Generated summary with 6 groups
2025-05-15 15:15:54,343 - qa_analytics - ERROR - Error generating main report: name 'openpyxl' is not defined
2025-05-15 15:16:00,198 - qa_analytics - ERROR - Error generating main report: name 'openpyxl' is not defined
2025-05-15 15:17:41,735 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-15 15:17:41,787 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 15:17:41,789 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 15:17:41,790 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-15 15:17:41,791 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-15 15:17:41,792 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 15:17:41,793 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-15 15:17:41,794 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-15 15:17:41,795 - qa_analytics - INFO - Loaded config for QA-ID 99
2025-05-15 15:17:41,797 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 15:17:41,797 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-15 15:17:41,799 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 15:17:41,811 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 15:17:41,811 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-15 15:17:41,814 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-15 15:17:41,815 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-15 15:17:41,818 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-15 15:17:41,823 - qa_analytics - INFO - Loaded template metadata
2025-05-15 15:17:41,824 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-15 15:17:49,241 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-15 15:17:49,254 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-15 15:17:49,255 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-15 15:17:49,257 - qa_analytics - INFO - Starting processing for QA-ID 99
2025-05-15 15:17:49,259 - qa_analytics - INFO - Loading data from registered data source 'audit_workpapers_2025q2'
2025-05-15 15:17:49,267 - qa_analytics - INFO - Loaded data source 'audit_workpapers_2025q2' from C:/Users/luria/PycharmProjects/AuditQAStudio/audit_workpapers_2025Q2.xlsx (30 rows)
2025-05-15 15:17:49,267 - qa_analytics - INFO - Successfully loaded source data with 30 rows
2025-05-15 15:17:49,271 - qa_analytics - INFO - Validation 'custom_formula' completed - 21 of 30 records conform
2025-05-15 15:17:49,273 - qa_analytics - INFO - Validation complete: 21 GC, 9 DNC
2025-05-15 15:17:49,279 - qa_analytics - INFO - Generated summary with 6 groups
2025-05-16 14:23:46,197 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-16 14:23:46,566 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:23:46,568 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-16 14:23:46,569 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-16 14:23:46,571 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-16 14:23:46,572 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-16 14:23:46,574 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-16 14:23:46,576 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-16 14:23:46,578 - qa_analytics - INFO - Loaded config for QA-ID 99
2025-05-16 14:23:46,579 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:23:46,580 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:23:46,581 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-16 14:23:46,594 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-16 14:23:46,594 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-16 14:23:46,598 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-16 14:23:46,599 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-16 14:23:46,602 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-16 14:23:46,608 - qa_analytics - INFO - Loaded template metadata
2025-05-16 14:23:46,609 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-16 14:23:54,887 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-16 14:23:54,902 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-16 14:23:54,902 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-16 14:23:54,904 - qa_analytics - INFO - Starting processing for QA-ID 99
2025-05-16 14:23:54,906 - qa_analytics - INFO - Loading data from registered data source 'audit_workpapers_2025q2'
2025-05-16 14:23:54,920 - qa_analytics - INFO - Loaded data source 'audit_workpapers_2025q2' from C:/Users/luria/PycharmProjects/AuditQAStudio/audit_workpapers_2025Q2.xlsx (30 rows)
2025-05-16 14:23:54,920 - qa_analytics - INFO - Successfully loaded source data with 30 rows
2025-05-16 14:23:54,926 - qa_analytics - INFO - Validation 'custom_formula' completed - 21 of 30 records conform
2025-05-16 14:23:54,929 - qa_analytics - INFO - Validation complete: 21 GC, 9 DNC
2025-05-16 14:23:54,938 - qa_analytics - INFO - Generated summary with 6 groups
2025-05-16 14:24:16,872 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-16 14:24:16,872 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-16 14:24:35,883 - formula_parser - INFO - Parsed formula: a -> (df['a'])
2025-05-16 14:24:36,171 - formula_parser - INFO - Parsed formula: a= -> (df['a'] ==)
2025-05-16 14:24:36,324 - formula_parser - INFO - Parsed formula: a -> ((df['a']) == df['b'])
2025-05-16 14:24:40,044 - qa_analytics - INFO - Successfully generated configuration for template custom_formula
2025-05-16 14:27:40,795 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-16 14:27:40,851 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:27:40,853 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-16 14:27:40,854 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-16 14:27:40,855 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-16 14:27:40,856 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-16 14:27:40,857 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-16 14:27:40,859 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-16 14:27:40,860 - qa_analytics - INFO - Loaded config for QA-ID 99
2025-05-16 14:27:40,862 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:27:40,862 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:27:40,864 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-16 14:27:40,877 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-16 14:27:40,877 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-16 14:27:40,880 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-16 14:27:40,881 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-16 14:27:40,884 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-16 14:27:40,890 - qa_analytics - INFO - Loaded template metadata
2025-05-16 14:27:40,890 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-16 14:27:45,479 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-16 14:27:45,479 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-16 14:27:59,134 - formula_parser - INFO - Parsed formula: A -> (df['A'])
2025-05-16 14:27:59,315 - formula_parser - INFO - Parsed formula: Au -> (df['Au'])
2025-05-16 14:27:59,388 - formula_parser - INFO - Parsed formula: Aud -> (df['Aud'])
2025-05-16 14:27:59,499 - formula_parser - INFO - Parsed formula: Audi -> (df['Audi'])
2025-05-16 14:27:59,612 - formula_parser - INFO - Parsed formula: Audit -> (df['Audit'])
2025-05-16 14:27:59,708 - formula_parser - INFO - Parsed formula: Audit  -> (df['Audit'])
2025-05-16 14:27:59,859 - formula_parser - INFO - Parsed formula: Audit L -> (df['Audit'] df['L'])
2025-05-16 14:28:00,011 - formula_parser - INFO - Parsed formula: Audit Le -> (df['Audit'] df['Le'])
2025-05-16 14:28:00,108 - formula_parser - INFO - Parsed formula: Audit Lea -> (df['Audit'] df['Lea'])
2025-05-16 14:28:00,227 - formula_parser - INFO - Parsed formula: Audit Lead -> (df['Audit'] df['Lead'])
2025-05-16 14:28:00,436 - formula_parser - INFO - Parsed formula: Audit Leade -> (df['Audit'] df['Leade'])
2025-05-16 14:28:00,476 - formula_parser - INFO - Parsed formula: Audit Leader -> (df['Audit'] df['Leader'])
2025-05-16 14:28:00,532 - formula_parser - INFO - Parsed formula: Audit Leader  -> (df['Audit'] df['Leader'])
2025-05-16 14:28:00,730 - formula_parser - INFO - Parsed formula: Audit Leader = -> (df['Audit Leader'] ==)
2025-05-16 14:28:00,852 - formula_parser - INFO - Parsed formula: Audit Leader =  -> (df['Audit Leader'] ==)
2025-05-16 14:28:01,099 - formula_parser - INFO - Parsed formula: Audit Leader -> ((df['Audit'] df['Leader']) == df['A'])
2025-05-16 14:28:01,365 - formula_parser - INFO - Parsed formula: Audit Leader -> ((df['Audit'] df['Leader']) == df['Al'])
2025-05-16 14:28:01,812 - formula_parser - INFO - Parsed formula: Audit Leader -> ((df['Audit'] df['Leader']) == df['A'])
2025-05-16 14:28:02,035 - formula_parser - INFO - Parsed formula: Audit Leader -> ((df['Audit'] df['Leader']) == df['AL'])
2025-05-16 14:28:02,227 - formula_parser - INFO - Parsed formula: Audit Leader  -> ((df['Audit'] df['Leader']) == df['AL'])
2025-05-16 14:28:02,429 - formula_parser - INFO - Parsed formula: Audit Leader A -> ((df['Audit'] df['Leader'] df['A']) == df['AL'])
2025-05-16 14:28:02,676 - formula_parser - INFO - Parsed formula: Audit Leader Ap -> ((df['Audit'] df['Leader'] df['Ap']) == df['AL'])
2025-05-16 14:28:02,853 - formula_parser - INFO - Parsed formula: Audit Leader App -> ((df['Audit'] df['Leader'] df['App']) == df['AL'])
2025-05-16 14:28:02,916 - formula_parser - INFO - Parsed formula: Audit Leader Appr -> ((df['Audit'] df['Leader'] df['Appr']) == df['AL'])
2025-05-16 14:28:03,027 - formula_parser - INFO - Parsed formula: Audit Leader Appro -> ((df['Audit'] df['Leader'] df['Appro']) == df['AL'])
2025-05-16 14:28:03,116 - formula_parser - INFO - Parsed formula: Audit Leader Approv -> ((df['Audit'] df['Leader'] df['Approv']) == df['AL'])
2025-05-16 14:28:03,203 - formula_parser - INFO - Parsed formula: Audit Leader Approve -> ((df['Audit'] df['Leader'] df['Approve']) == df['AL'])
2025-05-16 14:28:03,284 - formula_parser - INFO - Parsed formula: Audit Leader Approver -> ((df['Audit'] df['Leader'] df['Approver']) == df['AL'])
2025-05-16 14:28:06,300 - formula_parser - INFO - Parsed formula: Audit Leader Approver` -> ((df['Audit'] df['Leader'] df['Approver']) == df['AL'])
2025-05-16 14:28:08,259 - formula_parser - INFO - Parsed formula: Audit Leader = __FIELD_0__ -> (df['Audit Leader'] == df['AL Approver'])
2025-05-16 14:28:12,995 - formula_parser - INFO - Parsed formula: Audit Leader Approver` -> ((df['Audit'] df['Leader'] df['Approver']) == df['AL'])
2025-05-16 14:28:18,507 - formula_parser - INFO - Parsed formula: Audit Leader Approver` -> ((df['Audit'] df['Leader'] df['Approver']) == df['1AL'])
2025-05-16 14:28:19,340 - formula_parser - INFO - Parsed formula: Audit Leader Approver` -> ((df['Audit'] df['Leader'] df['Approver']) == df['AL'])
2025-05-16 14:28:19,444 - formula_parser - INFO - Parsed formula: Audit Leader = __FIELD_0__ -> (df['Audit Leader'] == df['AL Approver'])
2025-05-16 14:28:24,420 - formula_parser - INFO - Parsed formula: Audit Leader Approver` -> ((df['Audit'] df['Leader'] df['Approver']) == df['AL'])
2025-05-16 14:28:25,332 - formula_parser - INFO - Parsed formula: Audit Leader = __FIELD_0__ -> (df['Audit Leader'] == df['AL Approver'])
2025-05-16 14:28:29,550 - qa_analytics - INFO - Successfully generated configuration for template custom_formula
2025-05-16 14:29:44,441 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-16 14:29:44,453 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-16 14:29:44,453 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-16 14:29:44,455 - qa_analytics - INFO - Starting processing for QA-ID 99
2025-05-16 14:29:44,458 - qa_analytics - INFO - Loading data from registered data source 'audit_workpapers_2025q2'
2025-05-16 14:29:44,466 - qa_analytics - INFO - Loaded data source 'audit_workpapers_2025q2' from C:/Users/luria/PycharmProjects/AuditQAStudio/audit_workpapers_2025Q2.xlsx (30 rows)
2025-05-16 14:29:44,466 - qa_analytics - INFO - Successfully loaded source data with 30 rows
2025-05-16 14:29:44,471 - qa_analytics - INFO - Validation 'custom_formula' completed - 21 of 30 records conform
2025-05-16 14:29:44,473 - qa_analytics - INFO - Validation complete: 21 GC, 9 DNC
2025-05-16 14:29:44,479 - qa_analytics - INFO - Generated summary with 6 groups
2025-05-16 14:31:55,088 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-16 14:31:55,143 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:31:55,145 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-16 14:31:55,146 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-16 14:31:55,147 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-16 14:31:55,148 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-16 14:31:55,149 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-16 14:31:55,150 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-16 14:31:55,152 - qa_analytics - INFO - Loaded config for QA-ID 99
2025-05-16 14:31:55,154 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:31:55,154 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:31:55,156 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-16 14:31:55,168 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-16 14:31:55,168 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-16 14:31:55,172 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-16 14:31:55,173 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-16 14:31:55,175 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-16 14:31:55,180 - qa_analytics - INFO - Loaded template metadata
2025-05-16 14:31:55,181 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-16 14:32:03,500 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-16 14:32:03,512 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-16 14:32:03,515 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-16 14:32:03,521 - qa_analytics - INFO - Starting processing for QA-ID 99
2025-05-16 14:32:03,524 - qa_analytics - INFO - Loading data from registered data source 'audit_workpapers_2025q2'
2025-05-16 14:32:03,532 - qa_analytics - INFO - Loaded data source 'audit_workpapers_2025q2' from C:/Users/luria/PycharmProjects/AuditQAStudio/audit_workpapers_2025Q2.xlsx (30 rows)
2025-05-16 14:32:03,532 - qa_analytics - INFO - Successfully loaded source data with 30 rows
2025-05-16 14:32:03,539 - qa_analytics - INFO - Validation 'custom_formula' completed - 21 of 30 records conform
2025-05-16 14:32:03,542 - qa_analytics - INFO - Validation complete: 21 GC, 9 DNC
2025-05-16 14:32:03,549 - qa_analytics - INFO - Generated summary with 6 groups
2025-05-16 14:32:03,553 - qa_analytics - INFO - Processor results keys: dict_keys(['detail', 'summary', 'warnings'])
2025-05-16 14:32:03,553 - qa_analytics - INFO - Summary data shape: (6, 7)
2025-05-16 14:32:03,553 - qa_analytics - INFO - Summary data columns: ['Audit_Entity', 'GC', 'PC', 'DNC', 'Total', 'DNC_Percentage', 'Exceeds_Threshold']
2025-05-16 14:32:03,553 - qa_analytics - INFO - First row of summary data: {'Audit_Entity': 'Compliance', 'GC': 5, 'PC': 0, 'DNC': 1, 'Total': 6, 'DNC_Percentage': 16.67, 'Exceeds_Threshold': True}
2025-05-16 14:32:03,555 - qa_analytics - INFO - Statistics - Total: 30, GC: 21, DNC: 9, PC: 0
2025-05-16 14:32:03,559 - qa_analytics - INFO - Current config: {'detail_required': True, 'group_by': 'Audit_Entity', 'summary_fields': ['GC', 'PC', 'DNC', 'Total', 'DNC_Percentage']}
2025-05-16 14:32:03,559 - qa_analytics - INFO - Group by field: Audit_Entity
2025-05-16 14:32:03,559 - qa_analytics - INFO - Summary data found with 6 rows
2025-05-16 14:32:03,559 - qa_analytics - INFO - Group by field 'Audit_Entity' found in summary data
2025-05-16 14:32:03,559 - qa_analytics - INFO - Unique values: ['Compliance' 'Finance Dept' 'HR' 'IT Security' 'Legal' 'Operations']
2025-05-16 14:32:03,561 - qa_analytics - INFO - Starting to process 6 summary rows
2025-05-16 14:32:03,561 - qa_analytics - INFO - Added 6 rows to summary treeview
2025-05-16 14:32:03,569 - qa_analytics - INFO - Results display update completed
2025-05-16 14:34:27,793 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-16 14:34:27,855 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:34:27,857 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-16 14:34:27,858 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-16 14:34:27,860 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-16 14:34:27,861 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-16 14:34:27,862 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-16 14:34:27,863 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-16 14:34:27,865 - qa_analytics - INFO - Loaded config for QA-ID 99
2025-05-16 14:34:27,866 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:34:27,867 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:34:27,869 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-16 14:34:27,881 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-16 14:34:27,881 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-16 14:34:27,885 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-16 14:34:27,886 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-16 14:34:27,890 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-16 14:34:27,895 - qa_analytics - INFO - Loaded template metadata
2025-05-16 14:34:27,896 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-16 14:34:33,226 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-16 14:34:33,240 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-16 14:34:33,241 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-16 14:34:33,243 - qa_analytics - INFO - Starting processing for QA-ID 99
2025-05-16 14:34:33,245 - qa_analytics - INFO - Loading data from registered data source 'audit_workpapers_2025q2'
2025-05-16 14:34:33,252 - qa_analytics - INFO - Loaded data source 'audit_workpapers_2025q2' from C:/Users/luria/PycharmProjects/AuditQAStudio/audit_workpapers_2025Q2.xlsx (30 rows)
2025-05-16 14:34:33,252 - qa_analytics - INFO - Successfully loaded source data with 30 rows
2025-05-16 14:34:33,257 - qa_analytics - INFO - Validation 'custom_formula' completed - 21 of 30 records conform
2025-05-16 14:34:33,259 - qa_analytics - INFO - Validation complete: 21 GC, 9 DNC
2025-05-16 14:34:33,265 - qa_analytics - INFO - Generated summary with 6 groups
2025-05-16 14:34:33,267 - qa_analytics - INFO - Processor results keys: dict_keys(['detail', 'summary', 'warnings'])
2025-05-16 14:34:33,267 - qa_analytics - INFO - Summary data shape: (6, 7)
2025-05-16 14:34:33,267 - qa_analytics - INFO - Summary data columns: ['Audit_Entity', 'GC', 'PC', 'DNC', 'Total', 'DNC_Percentage', 'Exceeds_Threshold']
2025-05-16 14:34:33,268 - qa_analytics - INFO - First row of summary data: {'Audit_Entity': 'Compliance', 'GC': 5, 'PC': 0, 'DNC': 1, 'Total': 6, 'DNC_Percentage': 16.67, 'Exceeds_Threshold': True}
2025-05-16 14:34:33,269 - qa_analytics - INFO - Statistics - Total: 30, GC: 21, DNC: 9, PC: 0
2025-05-16 14:34:33,272 - qa_analytics - INFO - Summary data found with 6 rows
2025-05-16 14:34:33,283 - qa_analytics - INFO - Added 6 rows to summary grid
2025-05-16 14:34:33,288 - qa_analytics - INFO - Results display update completed
2025-05-16 14:35:18,812 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-16 14:35:18,869 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:35:18,871 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-16 14:35:18,872 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-16 14:35:18,873 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-16 14:35:18,874 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-16 14:35:18,875 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-16 14:35:18,877 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-16 14:35:18,878 - qa_analytics - INFO - Loaded config for QA-ID 99
2025-05-16 14:35:18,880 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:35:18,880 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:35:18,882 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-16 14:35:18,894 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-16 14:35:18,895 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-16 14:35:18,898 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-16 14:35:18,900 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-16 14:35:18,902 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-16 14:35:18,908 - qa_analytics - INFO - Loaded template metadata
2025-05-16 14:35:18,908 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-16 14:35:23,870 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-16 14:35:23,883 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-16 14:35:23,884 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-16 14:35:23,886 - qa_analytics - INFO - Starting processing for QA-ID 99
2025-05-16 14:35:23,888 - qa_analytics - INFO - Loading data from registered data source 'audit_workpapers_2025q2'
2025-05-16 14:35:23,895 - qa_analytics - INFO - Loaded data source 'audit_workpapers_2025q2' from C:/Users/luria/PycharmProjects/AuditQAStudio/audit_workpapers_2025Q2.xlsx (30 rows)
2025-05-16 14:35:23,896 - qa_analytics - INFO - Successfully loaded source data with 30 rows
2025-05-16 14:35:23,900 - qa_analytics - INFO - Validation 'custom_formula' completed - 21 of 30 records conform
2025-05-16 14:35:23,902 - qa_analytics - INFO - Validation complete: 21 GC, 9 DNC
2025-05-16 14:35:23,908 - qa_analytics - INFO - Generated summary with 6 groups
2025-05-16 14:35:23,910 - qa_analytics - INFO - Processor results keys: dict_keys(['detail', 'summary', 'warnings'])
2025-05-16 14:35:23,910 - qa_analytics - INFO - Summary data shape: (6, 7)
2025-05-16 14:35:23,910 - qa_analytics - INFO - Summary data columns: ['Audit_Entity', 'GC', 'PC', 'DNC', 'Total', 'DNC_Percentage', 'Exceeds_Threshold']
2025-05-16 14:35:23,911 - qa_analytics - INFO - First row of summary data: {'Audit_Entity': 'Compliance', 'GC': 5, 'PC': 0, 'DNC': 1, 'Total': 6, 'DNC_Percentage': 16.67, 'Exceeds_Threshold': True}
2025-05-16 14:35:23,912 - qa_analytics - INFO - Statistics - Total: 30, GC: 21, DNC: 9, PC: 0
2025-05-16 14:35:23,915 - qa_analytics - INFO - Debug: Inserting 6 rows to text widget
2025-05-16 14:35:23,915 - qa_analytics - INFO - Added 6 rows to text display
2025-05-16 14:35:23,921 - qa_analytics - INFO - Results display update completed
2025-05-16 14:36:41,205 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-16 14:36:41,262 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:36:41,264 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-16 14:36:41,265 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-16 14:36:41,266 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-16 14:36:41,267 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-16 14:36:41,268 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-16 14:36:41,270 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-16 14:36:41,271 - qa_analytics - INFO - Loaded config for QA-ID 99
2025-05-16 14:36:41,273 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:36:41,273 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:36:41,275 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-16 14:36:41,287 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-16 14:36:41,287 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-16 14:36:41,290 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-16 14:36:41,291 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-16 14:36:41,294 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-16 14:36:41,299 - qa_analytics - INFO - Loaded template metadata
2025-05-16 14:36:41,300 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-16 14:36:46,847 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-16 14:36:46,859 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-16 14:36:46,862 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-16 14:36:46,867 - qa_analytics - INFO - Starting processing for QA-ID 99
2025-05-16 14:36:46,871 - qa_analytics - INFO - Loading data from registered data source 'audit_workpapers_2025q2'
2025-05-16 14:36:46,880 - qa_analytics - INFO - Loaded data source 'audit_workpapers_2025q2' from C:/Users/luria/PycharmProjects/AuditQAStudio/audit_workpapers_2025Q2.xlsx (30 rows)
2025-05-16 14:36:46,880 - qa_analytics - INFO - Successfully loaded source data with 30 rows
2025-05-16 14:36:46,890 - qa_analytics - INFO - Validation 'custom_formula' completed - 21 of 30 records conform
2025-05-16 14:36:46,893 - qa_analytics - INFO - Validation complete: 21 GC, 9 DNC
2025-05-16 14:36:46,902 - qa_analytics - INFO - Generated summary with 6 groups
2025-05-16 14:36:46,906 - qa_analytics - INFO - Processor results keys: dict_keys(['detail', 'summary', 'warnings'])
2025-05-16 14:36:46,907 - qa_analytics - INFO - Summary data shape: (6, 7)
2025-05-16 14:36:46,907 - qa_analytics - INFO - Summary data columns: ['Audit_Entity', 'GC', 'PC', 'DNC', 'Total', 'DNC_Percentage', 'Exceeds_Threshold']
2025-05-16 14:36:46,907 - qa_analytics - INFO - First row of summary data: {'Audit_Entity': 'Compliance', 'GC': 5, 'PC': 0, 'DNC': 1, 'Total': 6, 'DNC_Percentage': 16.67, 'Exceeds_Threshold': True}
2025-05-16 14:36:46,909 - qa_analytics - INFO - Statistics - Total: 30, GC: 21, DNC: 9, PC: 0
2025-05-16 14:36:47,009 - qa_analytics - INFO - Added 6 rows to responsive summary display
2025-05-16 14:36:47,016 - qa_analytics - INFO - Results display update completed
2025-05-16 14:38:44,982 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-16 14:38:45,041 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:38:45,043 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-16 14:38:45,044 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-16 14:38:45,045 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-16 14:38:45,046 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-16 14:38:45,047 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-16 14:38:45,048 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-16 14:38:45,050 - qa_analytics - INFO - Loaded config for QA-ID 99
2025-05-16 14:38:45,051 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:38:45,052 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:38:45,053 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-16 14:38:45,065 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-16 14:38:45,066 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-16 14:38:45,069 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-16 14:38:45,070 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-16 14:38:45,073 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-16 14:38:45,078 - qa_analytics - INFO - Loaded template metadata
2025-05-16 14:38:45,079 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-16 14:38:49,646 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-16 14:38:49,659 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-16 14:38:49,660 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-16 14:38:49,662 - qa_analytics - INFO - Starting processing for QA-ID 99
2025-05-16 14:38:49,665 - qa_analytics - INFO - Loading data from registered data source 'audit_workpapers_2025q2'
2025-05-16 14:38:49,672 - qa_analytics - INFO - Loaded data source 'audit_workpapers_2025q2' from C:/Users/luria/PycharmProjects/AuditQAStudio/audit_workpapers_2025Q2.xlsx (30 rows)
2025-05-16 14:38:49,672 - qa_analytics - INFO - Successfully loaded source data with 30 rows
2025-05-16 14:38:49,676 - qa_analytics - INFO - Validation 'custom_formula' completed - 21 of 30 records conform
2025-05-16 14:38:49,678 - qa_analytics - INFO - Validation complete: 21 GC, 9 DNC
2025-05-16 14:38:49,684 - qa_analytics - INFO - Generated summary with 6 groups
2025-05-16 14:38:49,686 - qa_analytics - INFO - Processor results keys: dict_keys(['detail', 'summary', 'warnings'])
2025-05-16 14:38:49,686 - qa_analytics - INFO - Summary data shape: (6, 7)
2025-05-16 14:38:49,686 - qa_analytics - INFO - Summary data columns: ['Audit_Entity', 'GC', 'PC', 'DNC', 'Total', 'DNC_Percentage', 'Exceeds_Threshold']
2025-05-16 14:38:49,687 - qa_analytics - INFO - First row of summary data: {'Audit_Entity': 'Compliance', 'GC': 5, 'PC': 0, 'DNC': 1, 'Total': 6, 'DNC_Percentage': 16.67, 'Exceeds_Threshold': True}
2025-05-16 14:38:49,688 - qa_analytics - INFO - Statistics - Total: 30, GC: 21, DNC: 9, PC: 0
2025-05-16 14:38:49,729 - qa_analytics - INFO - Added 6 rows to fixed table layout
2025-05-16 14:38:49,735 - qa_analytics - INFO - Results display update completed
2025-05-16 14:42:27,647 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-16 14:42:27,700 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:42:27,702 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-16 14:42:27,703 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-16 14:42:27,704 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-16 14:42:27,705 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-16 14:42:27,706 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-16 14:42:27,708 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-16 14:42:27,709 - qa_analytics - INFO - Loaded config for QA-ID 99
2025-05-16 14:42:27,710 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:42:27,711 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:42:27,712 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-16 14:42:27,724 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-16 14:42:27,724 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-16 14:42:27,728 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-16 14:42:27,729 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-16 14:42:27,732 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-16 14:42:27,737 - qa_analytics - INFO - Loaded template metadata
2025-05-16 14:42:27,738 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-16 14:42:41,011 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-16 14:42:41,023 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-16 14:42:41,023 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-16 14:42:41,027 - qa_analytics - INFO - Starting processing for QA-ID 99
2025-05-16 14:42:41,031 - qa_analytics - INFO - Loading data from registered data source 'audit_workpapers_2025q2'
2025-05-16 14:42:41,038 - qa_analytics - INFO - Loaded data source 'audit_workpapers_2025q2' from C:/Users/luria/PycharmProjects/AuditQAStudio/audit_workpapers_2025Q2.xlsx (30 rows)
2025-05-16 14:42:41,038 - qa_analytics - INFO - Successfully loaded source data with 30 rows
2025-05-16 14:42:41,046 - qa_analytics - INFO - Validation 'custom_formula' completed - 21 of 30 records conform
2025-05-16 14:42:41,049 - qa_analytics - INFO - Validation complete: 21 GC, 9 DNC
2025-05-16 14:42:41,057 - qa_analytics - INFO - Generated summary with 6 groups
2025-05-16 14:43:56,129 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-16 14:43:56,144 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-16 14:43:56,144 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-16 14:43:56,147 - qa_analytics - INFO - Starting processing for QA-ID 99
2025-05-16 14:43:56,150 - qa_analytics - INFO - Loading data from registered data source 'audit_workpapers_2025q2'
2025-05-16 14:43:56,156 - qa_analytics - INFO - Loaded data source 'audit_workpapers_2025q2' from C:/Users/luria/PycharmProjects/AuditQAStudio/audit_workpapers_2025Q2.xlsx (30 rows)
2025-05-16 14:43:56,156 - qa_analytics - INFO - Successfully loaded source data with 30 rows
2025-05-16 14:43:56,160 - qa_analytics - INFO - Validation 'custom_formula' completed - 21 of 30 records conform
2025-05-16 14:43:56,161 - qa_analytics - INFO - Validation complete: 21 GC, 9 DNC
2025-05-16 14:43:56,166 - qa_analytics - INFO - Generated summary with 6 groups
2025-05-16 14:48:08,951 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-16 14:48:09,007 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:48:09,009 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-16 14:48:09,010 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-16 14:48:09,011 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-16 14:48:09,012 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-16 14:48:09,014 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-16 14:48:09,015 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-16 14:48:09,016 - qa_analytics - INFO - Loaded config for QA-ID 99
2025-05-16 14:48:09,017 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:48:09,018 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:48:09,019 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-16 14:48:09,031 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-16 14:48:09,031 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-16 14:48:09,036 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-16 14:48:09,037 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-16 14:48:09,040 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-16 14:48:09,045 - qa_analytics - INFO - Loaded template metadata
2025-05-16 14:48:09,045 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-16 14:48:14,369 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-16 14:48:14,381 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-16 14:48:14,382 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-16 14:48:14,386 - qa_analytics - INFO - Starting processing for QA-ID 99
2025-05-16 14:48:14,390 - qa_analytics - INFO - Loading data from registered data source 'audit_workpapers_2025q2'
2025-05-16 14:48:14,396 - qa_analytics - INFO - Loaded data source 'audit_workpapers_2025q2' from C:/Users/luria/PycharmProjects/AuditQAStudio/audit_workpapers_2025Q2.xlsx (30 rows)
2025-05-16 14:48:14,397 - qa_analytics - INFO - Successfully loaded source data with 30 rows
2025-05-16 14:48:14,403 - qa_analytics - INFO - Validation 'custom_formula' completed - 21 of 30 records conform
2025-05-16 14:48:14,406 - qa_analytics - INFO - Validation complete: 21 GC, 9 DNC
2025-05-16 14:48:14,413 - qa_analytics - INFO - Generated summary with 6 groups
2025-05-16 14:50:35,420 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-16 14:50:35,492 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:50:35,494 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-16 14:50:35,495 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-16 14:50:35,496 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-16 14:50:35,497 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-16 14:50:35,498 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-16 14:50:35,499 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-16 14:50:35,500 - qa_analytics - INFO - Loaded config for QA-ID 99
2025-05-16 14:50:35,502 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:50:35,502 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:50:35,503 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-16 14:50:35,515 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-16 14:50:35,515 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-16 14:50:35,519 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-16 14:50:35,520 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-16 14:50:35,523 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-16 14:50:35,528 - qa_analytics - INFO - Loaded template metadata
2025-05-16 14:50:35,529 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
2025-05-16 14:50:40,589 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-16 14:50:40,600 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-16 14:50:40,601 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-16 14:50:40,604 - qa_analytics - INFO - Starting processing for QA-ID 99
2025-05-16 14:50:40,610 - qa_analytics - INFO - Loading data from registered data source 'audit_workpapers_2025q2'
2025-05-16 14:50:40,618 - qa_analytics - INFO - Loaded data source 'audit_workpapers_2025q2' from C:/Users/luria/PycharmProjects/AuditQAStudio/audit_workpapers_2025Q2.xlsx (30 rows)
2025-05-16 14:50:40,618 - qa_analytics - INFO - Successfully loaded source data with 30 rows
2025-05-16 14:50:40,625 - qa_analytics - INFO - Validation 'custom_formula' completed - 21 of 30 records conform
2025-05-16 14:50:40,629 - qa_analytics - INFO - Validation complete: 21 GC, 9 DNC
2025-05-16 14:50:40,638 - qa_analytics - INFO - Generated summary with 6 groups
2025-05-16 14:51:45,810 - qa_analytics - INFO - Starting Enhanced QA Analytics in GUI mode
2025-05-16 14:51:45,875 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:51:45,878 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-16 14:51:45,878 - qa_analytics - INFO - Loaded config for QA-ID 1
2025-05-16 14:51:45,880 - qa_analytics - INFO - Loaded config for QA-ID 100
2025-05-16 14:51:45,881 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-16 14:51:45,882 - qa_analytics - ERROR - Data source config missing required_fields
2025-05-16 14:51:45,883 - qa_analytics - INFO - Loaded config for QA-ID 103
2025-05-16 14:51:45,884 - qa_analytics - INFO - Loaded config for QA-ID 99
2025-05-16 14:51:45,886 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:51:45,887 - qa_analytics - ERROR - Missing required config key: analytic_id
2025-05-16 14:51:45,888 - qa_analytics - INFO - Loaded reference data config from configs/reference_data.yaml
2025-05-16 14:51:45,901 - qa_analytics - INFO - Loaded data source registry from configs/data_sources.yaml
2025-05-16 14:51:45,902 - qa_analytics - INFO - Found 6 data sources and 10 analytic mappings
2025-05-16 14:51:45,905 - qa_analytics - INFO - Loaded template 'approval_workflow' from approval_workflow_template.yaml
2025-05-16 14:51:45,906 - qa_analytics - INFO - Loaded template 'custom_formula' from custom_formula_template.yaml
2025-05-16 14:51:45,909 - qa_analytics - INFO - Loaded template 'risk_assessment' from risk_assessment_template.yaml
2025-05-16 14:51:45,914 - qa_analytics - INFO - Loaded template metadata
2025-05-16 14:51:45,915 - qa_analytics - INFO - Loaded scheduler configuration from configs/scheduler.yaml
